/*www.agilecloud.biz/minZIP?v=3.6*/var targetElemClicked;function WizardComp(a){var e=this;e.options=a||{},e.chartWizard={steps:5,ids:["chartSelData","queryData","hlinkData","appearanceData","roleSelctionData"],stepNames:["Chart Type","Source","Links","Attributes","Authorization"],validateKeys:["chtType","query","hpLink","cmz","rl"]},e.createWizard=function(a){$("#wizarTypeSel").hide(),$("#wizardWrappper").show();for(var t="",i=e[a],s=i.steps,r=i.stepNames,d=i.ids,n=e.options.progress_bar||"",o=0;o<s;o++){var c=RepSpecialCharsInHTML(r[o]),l=d[o];t+=0==o?'<div data-objtype="'.concat(a,'" data-id=').concat(o,' data-target="').concat(l,'" class="step in-progress active ').concat(n,'">'):'<div data-objtype="'.concat(a,'" data-id=').concat(o,' data-target="').concat(l,'" class="step ').concat(n,'">'),t+='<a title="'+c+'" class="stepName" href="javascript:void(0)">'+c+"</a>","flat"!==e.options.progress_bar&&(t+='<div title="'+c+'" class="node"></div>'),t+="</div>"}$("#wizardHeader").html('<div class="wizard-progress">'+t+"</div>"),"vertical"===n?$("#wizardWrappper").addClass("progress_vertical"):"flat"===n&&$("#wizardWrappper").addClass("progress_flat"),e.showActiveData(d[0]),$("#wizardNextbtn").show(),e.assignEvents(),e.onWizardCreate()},e.completeCurrentStep=function(){var a=$("#wizardHeader .step.in-progress"),t=a.next().data("target");a.removeClass("in-progress active").addClass("complete"),a.next().addClass("in-progress active"),e.showActiveData(t)},e.assignEvents=function(){$("#wizardHeader .node,#wizardHeader a.stepName").on("click",function(a){a.preventDefault();var t=$(this);e.checkClick(t)}),e.options.rtl&&$("#wizardHeader .wizard-progress,#wizardBodyContent").addClass("wizardRtl")},e.checkClick=function(a,t){if("prev"==t||"next"==t){var i=(l=$("#wizardHeader .step.active")).data("id"),s=l.data("objtype");if("next"==t)var r=e.validateTheKey(s,i);else if("prev"==t)r=!0;if(!0===r)if("next"==t){var d=l.next();l.hasClass("complete")?(l.removeClass("active"),d.addClass("active")):(l.addClass("complete").removeClass("in-progress active"),d.addClass("in-progress active"));var n=d.data("objtype"),o=e[n].ids[d.data("id")];e.showActiveData(o),e.checkNxtPrevBtns()}else{l.removeClass("active");var c=l.prev();c.addClass("active");n=c.data("objtype"),o=e[n].ids[c.data("id")];e.showActiveData(o),e.checkNxtPrevBtns()}else r!==undefined&&""!=r&&showAlertDialog("warning",r)}else{var l,p=(l=a.parents(".step")).data("id"),v=(s=l.data("objtype"),$("#wizardHeader .step.active").data("id"));if(v===p||!l.hasClass("in-progress")&&!l.hasClass("complete"))return;targetElemClicked=a;var h=!0;if(p>v)for(var w=v;w<p;w++){var z=e.validateTheKey(s,w);if(!0!==z){z!==undefined&&$("#wizardHeader .step[data-id="+w+"] a").click(),h=z;break}}if(!0!==h||l.hasClass("active")||!l.hasClass("complete")&&!l.hasClass("in-progress"))h!==undefined&&""!=h&&showAlertDialog("warning",h);else{targetElemClicked="",$("#wizardHeader .step.active").removeClass("active");var f=l.addClass("active").data("target");e.showActiveData(f),e.checkNxtPrevBtns()}}},e.showActiveData=function(a){$(".wizardContainer").hide(),$("#"+a).show(),e.onPageShow(a),e.focusTheFirstFld(a)},e.onPageShow=function(a){},e.onWizardCreate=function(){},e.focusTheFirstFld=function(a){$("#"+a).find("a,input:visible,button:visible,textarea:visible,select:visible").not(":disabled").first().focus()},e.checkNxtPrevBtns=function(){var a=$("#wizardHeader .step").length,e=$("#wizardHeader .step.active").data("id");0==e?($("#wizardPrevbtn").hide(),$("#wizardNextbtn").show().html("Next &gt;")):e==a-1?($("#wizardPrevbtn").show(),$("#wizardNextbtn").show().html("Finish")):($("#wizardPrevbtn").show(),$("#wizardNextbtn").show().html("Next &gt;"))},e.validateTheKey=function(a,t){var i=e[a].validateKeys[t];return""==i||("chtType"!=i||1==$("#chartSelData").data("isCompleted")||"Please select chart type.")},e.resetTheWizard=function(){$("#wizarTypeSel").show(),$("#wizardWrappper").hide(),$("#wizardHeader").html(""),$(".wizardPrevNxtBtns").hide(),e.onWizardClose()},e.onWizardClose=function(){}}