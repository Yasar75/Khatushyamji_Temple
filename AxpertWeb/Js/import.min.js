/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function validateDataSearchWiz(){var ddl=0,multiselect=0;if("NA"!=$("#ddlImpTbl").val())if(ddl=1,$("#mSelectRight option").val()!=undefined&&$("#mSelectRight option").val().length>0){var mandatoryField=!1;$("#mSelectLeft option").each(function(){$(this).val().indexOf("*")>=0&&(mandatoryField=!0)}),mandatoryField?(showAlertDialog("warning",eval(callParent("lcm[156]"))),$("#mSelectLeft").focus()):multiselect=1}else showAlertDialog("warning",eval(callParent("lcm[108]"))),$("#mSelectLeft").focus();else showAlertDialog("warning",eval(callParent("lcm[106]"))),$("#ddlImpTbl").data("selectpicker").$button.focus();if(1==ddl&&1==multiselect){var tempColNames="",tempColValues="",tempFileName="";$("#mSelectRight option").each(function(){tempColNames+=$(this).text()+", ",tempColValues+=$(this).val()+", "}),tempColNames=tempColNames.substring(0,tempColNames.length-2),tempColValues=tempColValues.substring(0,tempColValues.length-2),selectedValues=$("#mSelectRight option").length,0!=oldSelectedValues&&selectedValues!=oldSelectedValues?($("#noFile").text(eval(callParent("lcm[66]"))),$("#fileToUpload").val("").prop("title",eval(callParent("lcm[66]"))),$("#IsFileUploaded").val(""),$("#divProgress").hide(),oldSelectedValues=0):$("#hdnSelectedColumnCount").val(selectedValues),$("#hdnColNames").val(tempColNames),$("#hdnColValues").val(tempColValues),tempFileName=$("#ddlImpTbl :selected").text(),hdnTemplateName=$("#hdnTemplateName").val(),$("#excel1").click(function(){""==hdnTemplateName&&(hdnTemplateName=$("#ddlImpTbl :selected").text()),$("#hdnTemplateName").val(hdnTemplateName+".xlsx"),$("#btnCreateTemplate").click()}),$("#CSV1").click(function(){""==hdnTemplateName&&(hdnTemplateName=$("#ddlImpTbl :selected").text()),$("#hdnTemplateName").val(hdnTemplateName+".csv"),$("#btnCreateTemplate").click()}),$("#ddlGroupBy").empty(),$("#ddlGroupBy").append("<option value='NA'>-- Select --</option"),colValues=$("#hdnGroupByColVal").val().split(", "),colNames=$("#hdnGroupByColName").val().split(", ");for(var i=0;i<colNames.length;i++)$("#ddlGroupBy").append("<option value='"+colValues[i]+"'>"+colNames[i]+"</option");return $("#ddlGroupBy").change(function(){$("#hdnGroupBy").val($("#ddlGroupBy").val())}),!0}return!1}function FileuplaodValidation(){try{$.ajax({url:"importnew.aspx/FileuplaodValidation",type:"POST",cache:!1,async:!0,dataType:"json",contentType:"application/json",success:function(e){e.d},error:function(e){}})}catch(e){}}function validateDataUploadWiz(){var fileupload=0,uploadMsg=$("#hdnUploadFileWarnings").val();if("1"==$("#IsFileUploaded").val())return ChkAllowUpdate(),!0;if("Empty"==uploadMsg)return showAlertDialog("warning",4036,"client"),!1;if("NotEqualColumns"==uploadMsg)return showAlertDialog("warning",4039,"client"),!1;if("DuplicateColumns"==uploadMsg)return showAlertDialog("warning",eval(callParent("lcm[307]"))),!1;if("InvalidFileFormat"==uploadMsg)return showAlertDialog("warning",eval(callParent("lcm[310]"))),!1;fileupload=1;var errorMesg=$(".fileUploadErrorMessage").text();return errorMesg.indexOf("csv")<0&&showAlertDialog("warning",eval(callParent("lcm[113]"))),$("#fileuploadsts").text(""),!1}function GetSelColData(){var e=[],t=[];$("#gridImpData tr >th select:not([disabled])").each(function(){var a=$(this).find(":selected").val(),l=$(this).find(":selected").text();"None"==a?e.push("None"):(e.push(a),t.push(l))});for(var a=e.slice().sort(),l=[],n=0;n<e.length-1;n++)a[n+1]==a[n]&&l.push(a[n]);if(l.length>0)return showAlertDialog("warning",1030,"client"),focusSelectInGrid(e,l),!1;var o="",i="";return $("#gridImpData tr th").find("select:not([disabled])").each(function(){o+=$(this).find("option[selected]").text()+", ",i+=$(this).val()+", "}),o=o.substring(0,o.length-2),i=i.substring(0,i.length-2),$("#hdnColNames").val(o),$("#hdnColValues").val(i),$("#colheader").val(e.join(",")),$("#colHeaderNames").val(t.join(",")),unselectIgnoredColumns(),!$("#chkForAllowUpdate").prop("checked")||(primaryKeyCol=$("#ddlPrimaryKey").val(),"NA"==primaryKeyCol?(showAlertDialog("warning","Please select Primary Key column"),$("#ddlPrimaryKey").focus(),!1):($("#hdnPrimaryKey").val(primaryKeyCol),!0))}function updateMandatoryFieldsToSelection(){$("#mSelectLeft option").each(function(){$(this).text().indexOf("*")>=0?($("#mSelectRight").append($("<option>",{value:$(this).val().replace("*",""),text:$(this).text().replace("*",""),mandatory:!0})),$(this).remove()):$(this).attr("mandatory",!1)})}function ChkAllowUpdate(){if($("#chkForAllowUpdate").prop("checked")){$("#lblprimarycolmn,#ddlPrimaryKey").parent("div").removeClass("d-none"),$("#ddlPrimaryKey").empty(),$("#ddlPrimaryKey").append("<option value='NA'>-- Select --</option"),colValues=$("#hdnColValues").val().split(", "),colNames=$("#hdnColNames").val().split(", ");for(var e=0;e<colNames.length;e++)$("#ddlPrimaryKey").append("<option value='"+colValues[e]+"'>"+colNames[e]+"</option");disabledIgnoredColumns(ignoredColCount)}else $("#lblprimarycolmn,#ddlPrimaryKey").parent("div").addClass("d-none")}function ColNameInfileChanged(){$("#ColHeaderClick").click()}function focusSelectInGrid(e,t){var a=[];for(i=0;i<t.length;i++)for(j=0;j<e.length;j++)t[i]==e[j]&&a.push(j);for(i=0;i<a.length;i++)1==i&&$("#gridImpData tbody tr th").eq(a[i]).find("select").focus()}function removeConfirmDialog(){$(".jconfirm").length>0&&$(".jconfirm").remove()}function ConfirmLeave(){if($(".jconfirm").length>0)$(".jconfirm").remove();else{var glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var ConfirmSaveCB=$.confirm({theme:"modern",title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))}),$(".jconfirm-buttons .hotbtn").focus()},backgroundDismiss:"false",escapeKey:"buttonB",rtl:isRTL,content:eval(callParent("lcm[115]")),buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary",action:function(){ConfirmSaveCB.close(),parent.closeModalDialog(),parent.checkIfAnyActionPerformed()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})}}function uploadFileChangeEvent(){$("#fileToUpload").change(function(e){var uploadControl=$("#fileToUpload")[0].files[0],regex=/^.*\.(CSV|csv|txt|TXT|XLS|xls|XLSX|xlsx)$/;if(uploadControl!=undefined){var Filename=uploadControl.name;if(""!=Filename){var fileSize=uploadControl.size/1024/1024;regex.test(Filename)?fileSize>1?(showAlertDialog("warning",eval(callParent("lcm[156]"))),$("#noFile").text(eval(callParent("lcm[66]"))),$("#fileToUpload").val(""),$("#IsFileUploaded").val("")):($("#noFile").text(Filename),$("#chkForAllowUpdate").attr("checked",!1),$("#hdnPrimaryKey").val(""),ChkAllowUpdate(),$("#btnFileUpload").click()):(showAlertDialog("warning",eval(callParent("lcm[157]"))),uploadControl.value="",$("#noFile").text(eval(callParent("lcm[66]"))),$("#fileToUpload").val(""),$("#IsFileUploaded").val(""))}}else $("#noFile").text(eval(callParent("lcm[66]"))),$("#IsFileUploaded").val("")})}function uploadFileClickEvent(){$("#btnFileUpload").click(function(){var fileUpload=$("#fileToUpload").get(0),files=fileUpload.files,frm=new FormData;if(0==files.length)showAlertDialog("warning",eval(callParent("lcm[158]")));else{for(var i=0;i<files.length;i++)frm.append(files[i].name,files[i]);$(".progress").show();var url=location.origin+location.pathname.substr(0,location.pathname.indexOf("aspx"));$.ajax({url:url+"FileUploadHandler.ashx",type:"POST",contentType:!1,processData:!1,data:frm,success:function(e){if(0==e.indexOf("File Uploaded successfully")){var t=e.substr(e.indexOf("&&")+2);$("#divProgressBar").removeClass("progress-bar-danger"),setTimeout(function(){$("#divProgressBar").removeClass("progress-bar progress-bar-striped active").addClass("progress-bar-success").text("100%").css("width","100%").attr("aria-valuenow","100")},500),$("#upFileName").val(t),$("#uploadFileName").val(files[0].name),$("#UploadButton").click()}else showAlertDialog("warning",e)},error:function error(err){showAlertDialog("warning",eval(callParent("lcm[159]"))),$("#divProgressBar").removeClass("progress-bar-striped active").addClass("progress-bar-danger").text("0%").css("width","100%").attr("aria-valuenow","100")},xhr:function(){var e=$.ajaxSettings.xhr();return e.upload.onprogress=function(e){var t=0,a=e.loaded||e.position,l=e.total;e.lengthComputable&&(t=Math.ceil(a/l*100)),$("#divProgressBar").addClass("progress-bar-striped").text(t+"%").css("width","100%").attr("aria-valuenow",t)},e}})}})}function fileUploadSuccess(){showAlertDialog("success",4037,"client");var e=$("#uploadFileName").val();$(".dropzone-select").text(e).addClass("col-10"),uploadFileClickEvent(),uploadFileChangeEvent(),addChkbxsToGrdColumns(),disabledIgnoredColumns(ignoredColCount=parseInt($("#hdnIgnoredColCount").val())),unselectIgnoredColumns(),showPopover(),filename=$("#uploadFileName").val(),$("#noFile").text(filename),$("#fileToUpload").attr("title",filename)}Dropzone.autoDiscover=!1;var leftSelectedClickedOnce=!1;function createMultiselectControl(){$(".multiselect").multiselect({beforeMoveToLeft:function(e,t,a){return!1},sort:!0,moveToLeft:function moveToLeft(Multiselect,$options,event,silent,skipStack){targetId=$(event.target).attr("id");var selectionOptionCount=0;if(1==$options.length){if("false"==$options.attr("mandatory"))return $("#mSelectLeft").append($("<option>",{value:$options.val(),text:$options.text(),mandatory:!1})),$options.remove(),!0;showAlertDialog("warning",eval(callParent("lcm[160]")))}else"left_Selected_1"==targetId&&($("#mSelectRight :selected").map(function(e,t){"true"==$(t).attr("mandatory")&&selectionOptionCount++}),selectionOptionCount==$options.length&&showAlertDialog("warning",eval(callParent("lcm[161]"))));var mandatoryCount=0;if($("#mSelectRight option").map(function(e,t){"true"==$(t).attr("mandatory")&&mandatoryCount++}),mandatoryCount>1&&mandatoryCount==$options.length)showAlertDialog("warning",eval(callParent("lcm[161]")));else{var selectOrAll="left_All_1"==$(event.currentTarget).attr("id")?"option":":selected";$("#mSelectRight "+selectOrAll).map(function(e,t){"false"==$(t).attr("mandatory")&&(leftSelectedClickedOnce=!0,$("#mSelectLeft").append($("<option>",{value:$(this).val(),text:$(this).text(),mandatory:!1})),$(this).remove())})}}})}function closeWindow(){checkIfFormChanges()?ConfirmLeave():parent.closeModalDialog()}var isFormDirty=!1;function checkIfFormChanges(){var e=$("#ddlImpTbl").val();return isFormDirty="NA"!=e}function wizardTabFocus(e,t,a){}function setFailedSummaryColumnHeadings(){$("#thSummFileName").text(eval(callParent("lcm[263]"))),$("#thSummRecords").text(eval(callParent("lcm[264]"))),$("#thSummAdded").text(eval(callParent("lcm[357]"))),$("#thSummUpdated").text(eval(callParent("lcm[358]"))),$("#thSummFailed").text(eval(callParent("lcm[266]"))),$("#hdnIgnoredColumns").val(""),ignoredColumns=[]}function addChkbxsToGrdColumns(){$("#gridImpData").data("column-select")==undefined&&($("#gridImpData th").each(function(){$(this).find("select").addClass("form-select"),$(this).find("select").select2(),$(this).find("select").css("width","auto"),selectId=$(this).find("select").attr("id"),$(this).append("<label class='checkbox-inline'><br><input type='checkbox' class='grd-column-select' checked id='chk"+selectId+"'/><span>Select Column</span></label><i tabindex='0' data-trigger='focus' class='icon-arrows-question col-info' data-toggle='popover' data-content='Uncheck to ignore this column' data-placement='right' style='cursor: pointer;'  title=''></i>"),$(this).find("select").change(function(){$("option[value="+this.value+"]",this).attr("selected",!0).siblings().removeAttr("selected"),selectVal=$(this).val(),selectId=$(this).attr("id"),mandatory=$("#mSelectRight option[value='"+selectVal+"']").attr("mandatory"),mandatory=mandatory!=undefined&&JSON.parse(mandatory),colIndex=$(this).closest("th").index(),mandatory?$("#chk"+selectId).attr("disabled","disabled"):$("#chk"+selectId).removeAttr("disabled")}),curselectVal=$(this).find("select").val(),mandatory=$("#mSelectRight option[value='"+curselectVal+"']").attr("mandatory"),mandatory=mandatory!=undefined&&JSON.parse(mandatory),mandatory&&$("#chk"+selectId).attr("disabled","disabled")}),$(".grd-column-select").change(function(){var e=$(this).is(":checked"),t=$(this).closest("th").index()+1;e?($(this).closest("th").find("select").removeAttr("disabled"),$("#gridImpData tr td:nth-child("+t+"), #gridImpData tr th:nth-child("+t+")").removeClass("column-disabled"),updateIgnoredColumns(t,"pop")):($(this).closest("th").find("select").attr("disabled","disabled"),$("#gridImpData tr td:nth-child("+t+"), #gridImpData tr th:nth-child("+t+")").addClass("column-disabled"),updateIgnoredColumns(t,"push"));var a=$(this).closest("th").find("select").is(":disabled"),l=$(this).closest("th").find("select").val();a?$("#ddlPrimaryKey option[value='"+l+"']").attr("disabled","disabled"):$("#ddlPrimaryKey option[value='"+l+"']").removeAttr("disabled")}),$("#gridImpData").attr("data-column-select",!0));try{var e;null===(e=KTApp)||void 0===e||e.initBootstrapTooltips()}catch(t){}}function disabledIgnoredColumns(e){e>0&&(--e,$("#gridImpData tr").each(function(){$(this).find("td:gt("+e+"), th:gt("+e+")").addClass("column-disabled")}),$("#gridImpData tr th:gt("+e+")").find("select").attr("disabled","disabled"),$("#gridImpData tr th").find("select[disabled]").each(function(){var e=$(this).val();$("#ddlPrimaryKey option[value='"+e+"']").attr("disabled","disabled"),updateIgnoredColumns($(this).parent().index()+1,"push")}),$("#gridImpData tr th:gt("+e+")").find(".checkbox-inline, .col-info").remove())}var oldSelectedValues=0;function unselectIgnoredColumns(){$("#gridImpData tr th").find("select[disabled]").each(function(){var e=$(this).val(),t=$(this).find("option[selected]").text();0==$('#mSelectLeft option[value="'+e+'"]').length&&($("#mSelectLeft").append($("<option>",{value:e,text:t,mandatory:!1})),$("#mSelectRight option[value='"+e+"']").remove())}),oldSelectedValues=$("#mSelectRight option").length}function updateIgnoredColumns(e,t){var a=ignoredColumns.indexOf(e);"push"==t?-1===a&&ignoredColumns.push(e):-1!==a&&ignoredColumns.splice(a,1),$("#hdnIgnoredColumns").val(ignoredColumns.sort(function(e,t){return e-t}))}function showPopover(){$('[data-toggle="popover"]').popover({placement:placement})}window.addEventListener("error",function(e){var t=e.error;console.log(t)});var placement,ignoredColCount=0,ignoredColumns=[],impWizardObj=[];function DropzoneInitImport(){var e="#dropzone_AxpFileImport",t=document.querySelector(e),a=t.querySelector(".dropzone-item");a.id="";var l=a.parentNode.innerHTML;a.parentNode.removeChild(a);var n=location.origin+location.pathname.substr(0,location.pathname.indexOf("aspx")),o=new Dropzone(e,{url:n+"FileUploadHandler.ashx",previewTemplate:l,addRemoveLinks:!0,maxFilesize:1,previewsContainer:e+" .dropzone-items",clickable:e+" .dropzone-select"});o.on("addedfile",function(e){t.querySelectorAll(".dropzone-item").forEach(function(e){e.style.display=""})}),o.on("totaluploadprogress",function(e){t.querySelectorAll(".progress-bar").forEach(function(t){t.style.width=e+"%"})}),o.on("removedfile",function(e){}),o.on("complete",function(e){var a=t.querySelectorAll(".dz-complete"),l=(e.xhr.responseText,e.xhr.responseText.substr(e.xhr.responseText.indexOf("&&")+2));$("#upFileName").val(l),$("#uploadFileName").val(e.name),$("#UploadButton").click(),setTimeout(function(){a.forEach(function(e){e.querySelector(".progress-bar").style.opacity="0",e.querySelector(".progress").style.opacity="0"})},300)})}$(document).ready(function(){var element=document.querySelector("#kt_stepper_example_clickable"),stepper=new KTStepper(element);stepper.on("kt.stepper.click",function(e){e.stepped&&e.goTo(e.getClickedStepIndex())}),stepper.on("kt.stepper.next",function(e){return 1==e.getCurrentStepIndex()?(validateDataSearchWiz(),1==validateDataSearchWiz()?void e.goNext():void 0):2==e.getCurrentStepIndex()?(validateDataUploadWiz(),1==validateDataUploadWiz()?void e.goNext():void 0):3==e.getCurrentStepIndex()?GetSelColData()?($(".card-footer").addClass("d-none"),$("#btnImport").click(),ShowDimmer(!0),void e.goNext()):void 0:4==e.getCurrentStepIndex()?"1"==$("#fileUploadComplete").val():void 0}),stepper.on("kt.stepper.previous",function(e){e.goPrevious()}),$("#ddlImpTbl").select2(),1!=$("#ddlGroupBy").prop("disabled")&&$("#ddlGroupBy").select2(),$("#ddlSeparator").select2(),$("#ddlPrimaryKey").select2(),DropzoneInitImport(),$("#ChkColNameInfile").attr("checked",!1),$("#icocl1").attr("data-content",eval(callParent("lcm[179]"))),$("#icocl2").attr("data-content",eval(callParent("lcm[181]"))),$("#icocl3").attr("data-content",eval(callParent("lcm[176]"))),$("#icocl4").attr("data-content",eval(callParent("lcm[177]"))),$("#icocl5").attr("data-content",eval(callParent("lcm[307]"))),$("#icocl6").attr("data-content",eval(callParent("lcm[308]"))),$("#icocl7").attr("data-content",eval(callParent("lcm[309]"))),"ar"===parent.gllangType?($("#wizardWrappper").addClass("rtlLanguage"),placement="left",$("#wizardNextbtn").parent().removeClass("pull-right").addClass("pull-left")):($("#wizardWrappper").removeClass("rtlLanguage"),placement="right"),$("#lblimgroupby,#lblseparator, #icocl6, #icocl7").css("float","ar"===parent.gllangType?"right":"left"),showPopover(),$("#right_All_1").prop("title",eval(callParent("lcm[171]"))).addClass("ar"===parent.gllangType?"fa-angle-double-left":"fa-angle-double-right"),$("#right_Selected_1").prop("title",eval(callParent("lcm[172]"))).addClass("ar"===parent.gllangType?"fa-angle-left":"fa-angle-right"),$("#left_Selected_1").prop("title",eval(callParent("lcm[173]"))).addClass("ar"===parent.gllangType?"fa-angle-right":"fa-angle-left"),$("#left_All_1").prop("title",eval(callParent("lcm[174]"))).addClass("ar"===parent.gllangType?"fa-angle-double-right":"fa-angle-double-left"),$("#wizardPrevbtn").prop("title",eval(callParent("lcm[163]"))).html("<span class='material-icons'>skip_previous</span><span class='wizard-icon'>"+eval(callParent("lcm[163]"))+"</span>"),$("#wizardNextbtn").prop("title",eval(callParent("lcm[162]"))).html("<span class='material-icons'>skip_next</span><span class='wizard-icon'>"+eval(callParent("lcm[162]"))+"</span>"),$("#wizardCompbtn").prop("title",eval(callParent("lcm[165]"))).html("<span class='material-icons'>thumb_up</span><span class='wizard-icon'>"+eval(callParent("lcm[165]"))+"</span>"),$("#wizardCancelbtn").prop("title",eval(callParent("lcm[192]"))).html("<span class='material-icons'>close</span><span class='wizard-icon'>"+eval(callParent("lcm[192]"))+"</span>"),$("#btnFileUpload").attr({value:eval(callParent("lcm[167]")),title:eval(callParent("lcm[167]"))}),callParentNew("closeFrame()","function"),uploadFileChangeEvent(),uploadFileClickEvent(),commonReadyTasks(),$(document).on("keydown","input[type='text'],input[type='radio'],input[type='checkbox']",function(e){13==e.keyCode&&e.preventDefault()}),createMultiselectControl(),$("#left_Selected_1").click(function(){$("#mSelectRight :selected").map(function(e,t){Boolean($(t).attr("mandatory"))||($("#mSelectLeft").append($("<option>",{value:$(this).val(),text:$(this).text()})),$(this).remove())})}),$("#right_All_1").click(function(){$("#mSelectLeft option").map(function(e,t){Boolean($(t).attr("mandatory"))||($("#mSelectRight").append($("<option>",{value:$(this).val(),text:$(this).text()})),$(this).remove())})}),$("#left_All_1").click(function(){$("#mSelectRight option").map(function(e,t){Boolean($(t).attr("mandatory"))||($("#mSelectLeft").append($("<option>",{value:$(this).val(),text:$(this).text()})),$(this).remove())})}),$("body").on("click",function(e){$("[data-toggle=popover]").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")})}),$("body").on("hidden.bs.popover",function(e){$(e.target).data("bs.popover").inState.click=!1}),$("#ddlImpTbl").change(function(){ShowDimmer(!0)}),$("#spnFileSelect").keypress(function(e){13==e.keyCode&&$("#fileToUpload").click()}),$("#fileToUpload").attr("title",eval(callParent("lcm[66]"))),$("#ddlSeparator").change(function(){$("#hdnUploadFileWarnings, #IsFileUploaded").val(""),$("#noFile").text(eval(callParent("lcm[66]"))),$("#fileToUpload").attr("title",eval(callParent("lcm[66]"))),$("#divProgress").hide(),$("[data-target='imWizardEdit']").removeClass("in-progress complete"),$("[data-target='imWizardSummary']").removeClass("in-progress complete"),$("[data-target='imWizardUpload']").addClass("in-progress").removeClass("complete")}),mandatoryColCount=$("#mSelectRight option[mandatory='true']").length,$("#hdnMandatoryColCount").val(mandatoryColCount);var mandatoryFldVal="",mandatoryFldCap="";$("#mSelectRight option[mandatory='true']").each(function(){mandatoryFldVal+=$(this).val()+",",mandatoryFldCap+=$(this).text()+","}),""!=mandatoryFldVal&&""!=mandatoryFldCap&&(mandatoryFldVal=mandatoryFldVal.substr(0,mandatoryFldVal.length-1),mandatoryFldCap=mandatoryFldCap.substr(0,mandatoryFldCap.length-1)),$("#hdnMandatoryFields").val(mandatoryFldVal+"#"+mandatoryFldCap),impWizardObj.assignEvents=function(){$("#wizardHeader .node,#wizardHeader a.stepName").on("click",function(e){e.preventDefault();var t=$(this);impWizardObj.checkClick(t)})},impWizardObj.checkClick=function(e,t){var a=(s=$("#wizardHeader .step.active")).data("id"),l=s.data("objtype");if("next"==t){var n=impWizardObj.validateTheKey(l,a);if(n||s.hasClass("complete")&&n){var o=s.next();s.hasClass("complete")?(s.removeClass("active"),o.addClass("active")):(s.addClass("complete").removeClass("in-progress active"),o.addClass("in-progress active"));var i=o.data("objtype"),r=impWizardObj[i].ids[o.data("id")];impWizardObj.showActiveData(r),impWizardObj.checkNxtPrevBtns(),a+1==impWizardObj.importDataWizard.steps-1&&o.addClass("complete"),3==a&&ShowDimmer(!0)}}else if("prev"==t){s.removeClass("active");var d=s.prev();d.addClass("active");i=d.data("objtype"),r=impWizardObj[i].ids[d.data("id")];impWizardObj.showActiveData(r),impWizardObj.checkNxtPrevBtns()}else{var s;if(!(s=e.parents(".step")).hasClass("active")&&(s.hasClass("complete")||s.hasClass("in-progress"))){$("#wizardHeader .step.active").removeClass("active");var c=s.addClass("active").data("target");impWizardObj.showActiveData(c),impWizardObj.checkNxtPrevBtns()}}},impWizardObj.showActiveData=function(e){$(".wizardContainer").hide(),$("#"+e).show()},impWizardObj.checkNxtPrevBtns=function(){var totalSteps=$("#wizardHeader .step").length,curStep=$("#wizardHeader .step.active").data("id");0==curStep&&wizardTabFocus("ddlImpTbl","wizardNextbtn",!0),1==curStep?wizardTabFocus("lnkExpTemp","wizardNextbtn"):2==curStep&&(wizardTabFocus("chkForIgnoreErr","wizardNextbtn"),addChkbxsToGrdColumns(),disabledIgnoredColumns(ignoredColCount)),0==curStep?($("#wizardPrevbtn, #wizardCompbtn").hide(),$("#wizardNextbtn").show().html(eval(callParent("lcm[162]"))),$("#mSelectLeft option, #mSelectRight option").prop("selected",!1)):curStep==totalSteps-1?($("#wizardPrevbtn").show(),$("#wizardNextbtn").hide(),$("#wizardCompbtn").show().html("<span class='material-icons'>cancel</span><span class='wizard-icon'>"+eval(callParent("lcm[165]"))+"</span>").click(function(){parent.closeModalDialog(),actionsClicked=""})):($("#wizardPrevbtn").show(),$("#wizardNextbtn").show().html("<span class='material-icons'>skip_next</span><span class='wizard-icon'>"+eval(callParent("lcm[162]"))+"</span>"),$("#wizardCompbtn").hide()),3==curStep?$("#wizardNextbtn").text(eval(callParent("lcm[170]"))):$("#wizardNextbtn").html("<span class='material-icons'>skip_next</span><span class='wizard-icon'>"+eval(callParent("lcm[162]"))+"</span>"),$(".gridData select").addClass("form-control")},impWizardObj.validateTheKey=function(e,t){var a=impWizardObj[e].validateKeys[t];return""==a||("data-select"==a?validateDataSearchWiz():"data-upload"==a?validateDataUploadWiz():"data-edit"==a?!!GetSelColData()&&($("#btnImport").click(),ShowDimmer(!0),!0):"data-summary"==a?"1"==$("#fileUploadComplete").val():void 0)},$("#wizardWrappper .stepName").each(function(){$(this).prop("title",$(this).text()),$(this).next().prop("title",$(this).text())})});