/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var globalRndNum="",isPwdAlphaNumeric=!1,alphaNumericRegEx=/^[a-zA-Z0-9_]+$/g,alphaNumericRegExbasedonkey=/^.*(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*\W).*$/g;function ValidatePassword(obj){"undefined"!=typeof PasswordprotectKEY&&1==PasswordprotectKEY&&(alphaNumericRegEx=alphaNumericRegExbasedonkey),globalRndNum="";var validatePwd=document.getElementById("pwdlength"),nPwd=document.getElementById("newPwd"),cPwd=document.getElementById("confirmPwd"),ePw=document.getElementById("existingPwd"),passRegEx=RegExp(alphaNumericRegEx);if(""==ePw.value)return showAlertDialog("warning",1002,"client"),displayAlertMsgOnParent(),ePw.focus(),!1;if(nPwd.value.length<validatePwd.value||cPwd.value.length<validatePwd.value)return showAlertDialog("warning",1003,"client",validatePwd.value),displayAlertMsgOnParent(),nPwd.focus(),cPwd.focus(),!1;if(1==isEmptyOrSpaces(nPwd.value))return showAlertDialog("warning",5005,"client"),displayAlertMsgOnParent(),nPwd.focus(),!1;if(nPwd.value==ePw.value)return showAlertDialog("warning",1004,"client"),displayAlertMsgOnParent(),nPwd.value="",document.getElementById("confirmPwd").value="",nPwd.focus(),!1;if(""!=nPwd.value&&""!=cPwd.value){if(nPwd.value!=cPwd.value)return showAlertDialog("warning",1005,"client"),displayAlertMsgOnParent(),nPwd.value="",cPwd.value="",document.getElementById("newPwd").value="",document.getElementById("confirmPwd").value="",nPwd.focus(),!1;if("undefined"!=typeof PasswordprotectKEY&&1==PasswordprotectKEY&&!passRegEx.test(nPwd.value))return showAlertDialog("error",eval(callParent("lcm[487]"))),displayAlertMsgOnParent(),nPwd.focus(),!1;if(isPwdAlphaNumeric&&!passRegEx.test(nPwd.value))return showAlertDialog("error",eval(callParent("lcm[450]"))),displayAlertMsgOnParent(),nPwd.focus(),!1}else{if(""==nPwd.value)return showAlertDialog("warning",1006,"client"),displayAlertMsgOnParent(),nPwd.focus(),!1;if(""==cPwd.value)return showAlertDialog("warning",1007,"client"),displayAlertMsgOnParent(),cPwd.focus(),!1}return $("#hdncheckMsg").val("true"),document.getElementById("existingPwd").value="",document.getElementById("newPwd").value="",document.getElementById("confirmPwd").value="",$j("#dvMessage",window.parent.document).is(":visible")&&$j("#dvMessage",window.parent.document).hide(),!0}function md5auth(e){var d="";if(""==e);else{d=xor_str(MD5(e),document.getElementById("swee000F0"));d=Base64.encode(d)}return d}function md5authNew(e){var d="";return""==e||(-1!=$("#npwdHidden").length&&$("#npwdHidden").val(e),d=MD5(e),$("#npwdHiddenMd5").val(d)),d}var currField="";function md5auth2(a){var pwdLength=8;try{pwdLength=parseInt(document.getElementById("pwdlength").value,10)}catch(exp){}var hash="";if(""!=a.value&&a.value.length<pwdLength){var cutMsg=eval(callParent("lcm[72]"));return ShowErrorMsg(cutMsg.replace("{0}",pwdLength)),$j(".msgButton").focus(),$j("input.msgButton").click(function(e){e.preventDefault(),"swn"==a.name?(document.f1.sw000F0.value=hash,currField="",document.f1.swn.focus()):"swc"==a.name?(document.f1.swc000F0.value=hash,currField="",document.f1.swc.focus()):$j("#"+a.name).focus()}),a.value="",!1}if(""!=a.value&&isPwdAlphaNumeric){var alphaNum=alphaNumericRegEx;if(!a.value.match(alphaNum)){var cutMsg=eval(callParent("lcm[69]"));return ShowErrorMsg(cutMsg),$j(".msgButton").focus(),$j("input.msgButton").click(function(e){e.preventDefault(),"swn"==a.name?(document.f1.sw000F0.value=hash,currField="",document.f1.swn.focus()):"swc"==a.name?(document.f1.swc000F0.value=hash,currField="",document.f1.swc.focus()):$j("#"+a.name).focus()}),a.value="",!1}}return currField="",!0}function DoMD5(e){var d="";if(""!=e.value){var t=xor_str(d=MD5(e.value),e);t=Base64.encode(t),"swn"==e.name?document.f1.sw000F0.value=t:"swc"==e.name?document.f1.swc000F0.value=t:"txtUsAdsw"==e.name&&(document.getElementById("sw000F0").value=d),currField=""}currField=""}function md5auth1(e){""==currField&&(currField=e.name),currField==e.name&&md5auth2(e)&&DoMD5(e)}function isEmptyOrSpaces(e){return null===e||null!==e.match(/^ *$/)}function xor_str(e,d){for(var t=e,n=0;0==n;)n=Math.floor(10*Math.random());"swc"!=d.name&&"swn"!=d.name||(""==globalRndNum?globalRndNum=n:n=globalRndNum);var r=n,a="";for(i=0;i<t.length;++i)a+=String.fromCharCode(r^t.charCodeAt(i));return a=r+a}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var d,t,n,r,a,s,l,i="",o=0;for(e=Base64._utf8_encode(e);o<e.length;)r=(d=e.charCodeAt(o++))>>2,a=(3&d)<<4|(t=e.charCodeAt(o++))>>4,s=(15&t)<<2|(n=e.charCodeAt(o++))>>6,l=63&n,isNaN(t)?s=l=64:isNaN(n)&&(l=64),i=i+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return i},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var d="",t=0;t<e.length;t++){var n=e.charCodeAt(t);n<128?d+=String.fromCharCode(n):n>127&&n<2048?(d+=String.fromCharCode(n>>6|192),d+=String.fromCharCode(63&n|128)):(d+=String.fromCharCode(n>>12|224),d+=String.fromCharCode(n>>6&63|128),d+=String.fromCharCode(63&n|128))}return d}};function DefaultTheme(){for(var e=document.getElementsByTagName("link"),d=0;d<e.length;d++)"text/css"==e[d].type&&"themecss"==e[d].id&&-1!=e[d].href.indexOf("Themes//StyleSheet")&&(e[d].href="../App_Themes/Blue/Stylesheet.min.css?v=23")}function handleError(){$j("#lnkAddUser").dblclick(function(){document.body.style.cursor="wait"})}function EndRequestHandler(e,d){if(d.get_error()==undefined){var t=$j("#hdnIsSearched").val(),n=$j("#userErr"),r=$j("#userSuccess");"Edit"==t?(displayEditWindow("dvAddEditUser","Add/Edit Users","show","User"),document.body.style.cursor="default"):"Add"==t?(ShowAddUser(""),AxWaitCursor(!1),document.getElementById("hdnIsSearched").value=""):"Delete"==t?(displayEditWindow("","","",""),n.val()!=undefined&&""!=n.val()&&(ShowErrorMsg(n.val()),HideBackgroundFade()),r.val()!=undefined&&""!=r.val()&&(ShowSuccessMsg(r.val()),$j("input.msgButton").click(function(e){e.preventDefault(),hiddenFloatingDiv("dvAddEditUser","close","success")}))):"DeleteUserRole"==t?(AxWaitCursor(!0),displayEditWindow("dvAddEditUser","Add/Edit Users","show","User"),document.body.style.cursor="default",n.val()!=undefined&&""!=n.val()&&(ShowErrorMsg(n.val()),adjustwin(window,700),$j("#dvAddEditUser").is(":visible")||displayEditWindow("dvAddEditUser","Add/Edit Users","show","User")),r.val()!=undefined&&""!=r.val()&&(ShowSuccessMsg(r.val()),$j("input.msgButton").click(function(e){e.preventDefault(),hiddenFloatingDiv("dvAddEditUser","close","success")})),AxWaitCursor(!1)):"AddUser"==t?(AxWaitCursor(!0),displayEditWindow("dvAddEditUser","Add/Edit Users","show","User"),$j("#grdUsRoles_ctl02_ddlUsRole").val(""),$j("#chkShowUsers").prop("checked",!1),$j("#chkShowWorkflow").prop("checked",!1),$j("#chkAvailImport").prop("checked",!1),$j("#chkAvailExport").prop("checked",!1),$j("#chkAvailBuild").prop("checked",!1),$j("#chkAvailAxManager").prop("checked",!1),$j("#chkAvailSync").prop("checked",!1),$j("#chkUsAdAct").prop("checked",!0),document.body.style.cursor="default",n.val()!=undefined&&""!=n.val()&&(ShowErrorMsg(n.val()),adjustwin(window,700),$j("#dvAddEditUser").is(":visible")||displayEditWindow("dvAddEditUser","Add/Edit Users","show","User")),r.val()!=undefined&&""!=r.val()&&(ShowSuccessMsg(r.val()),$j("input.msgButton").click(function(e){e.preventDefault(),hiddenFloatingDiv("dvAddEditUser","close","success")})),AxWaitCursor(!1)):"AddRole"==t?(displayEditWindow("","","",""),n.val()!=undefined&&""!=n.val()&&(ShowErrorMsg(n.val()),adjustwin(window,700),$j("#dvAddEditUser").is(":visible")||displayEditWindow("dvAddEditUser","Add/Edit Users","show","User"))):"SaveUser"==t?(displayEditWindow("","","",""),document.body.style.cursor="default",n.val()!=undefined&&""!=n.val()&&(ShowErrorMsg(n.val()),adjustwin(window,700),$j("#dvAddEditUser").is(":visible")||displayEditWindow("dvAddEditUser","Add/Edit Users","show","User")),r.val()!=undefined&&""!=r.val()&&(ShowSuccessMsg(r.val()),$j("input.msgButton").click(function(e){e.preventDefault(),hiddenFloatingDiv("dvAddEditUser","close","success")}))):"Search"==t&&($j("#dvAddEditUser").is(":visible")||hiddenFloatingDiv("dvAddEditUser","close","success"),n.val()!=undefined&&""!=n.val()&&ShowErrorMsg(n.val()),r.val()!=undefined&&""!=r.val()&&(ShowSuccessMsg(r.val()),$j("input.msgButton").click(function(e){e.preventDefault(),hiddenFloatingDiv("dvAddEditUser","close","success")}))),ShowDimmer(!1),$j("input.msgButton").click(function(e){e.preventDefault(),null!=UserEditfld&&$j(UserEditfld.selector).focus(),$j("#dvAddEditUser").is(":visible")||hiddenFloatingDiv("dvAddEditUser","close","success")}),$j("#userSuccess").val(""),$j("#userErr").val(""),$j("#hdnIsSearched").val(""),document.body.style.cursor="default"}else AxWaitCursor(!1),ShowDimmer(!1),document.body.style.cursor="default",window.location.href=window.location.href}function load(){Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler)}function LoadDate(){if("undefined"!=typeof Parameters){for(var e=0;e<Parameters.length;e++){var d=Parameters[e].split("~");"Culture"==d[0]&&(dtCulture=d[1])}dtFormat=GetDateFormat(dtCulture),dateString=dtFormat}}$j("#calendar table tr:nth-child(2)").click(function(){CapUserChangeEvent()}),$j(document).ready(function(){void 0!==LoadDate&&LoadDate(),"undefined"!=typeof BindEventFirefox&&BindEventFirefox(),"undefined"!=typeof checkSuccessAxpertMsg&&checkSuccessAxpertMsg()});try{var hdnTree=document.getElementById("hdnTreeSelVal").value}catch(ex){}$j(document).keypress(function(e){if(13==e.keyCode&&1==isUserEditMode&&!e.shiftKey)return e.preventDefault(),null==UserEditfld?$j("#btnUsAdSave").click():($j(".msgButton").click(),$j(UserEditfld.selector).focus(),UserEditfld=null),!1});