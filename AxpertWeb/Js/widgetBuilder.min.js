/*http://demo.agile-labs.com/minZIP/*//*version=3.9.1*/var _widgetMessages;function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}dbType=dbType?dbType.toLowerCase().replace(" ",""):"oracle";var widgetsPerPage=8,maxNoOfGroups=5,tstructData={},tstructTables={},tstructTableCols={},groups=[],selectedCols=[],widgetType="",mainSqlCM,tableSqlCm,updateSqlCM,codeMirrorHintObj={},updateObj={},widgetMetaData,deleteCnfrmBx,presentView="widget",dataTableApi,demandArray=[],newWidgetData=!1,widgetTableData={},presBuiildMode="widgetBuild",presWizardData={},theme=eval(callParent("currentThemeColor"));if(theme=theme||"default",$j("#homeBuilderLink").attr("href","../App_Themes/"+theme+"/home_builder.min.css?v=4"),parent.userResp!=undefined)var userRespArr=parent.userResp.split(",");else userRespArr=callParentNew("userResps").split(",");-1===$.inArray("default",userRespArr)&&callParentNew("LoadIframe('page.aspx')","function");var globalConfiguration={chart3D:["bar","pie","donut","column","stacked-group-column","stacked-bar","stacked-column"]},mainDataObj={},exampleQueries={twoColumn:"select first_name as data_label,sum(sales_qty) as value {{link}}<br>from AXP_SALES_DATA <br>group by first_name",threeColumn:"select first_name as data_label,sales_year as x_axis,sum(sales_qty) as value {{link}}<br>from AXP_SALES_DATA <br>group by first_name,sales_year <br>order by sales_year",scatter:"select first_name as data_label,sales_qty as x_axis_data,sales_year as y_axis_data from axp_sales_data",scatter3D:"select first_name as data_label,sales_qty as x_axis_data,sales_year as y_axis_data,sales_amount as z_axis_data from axp_sales_data",fourColumn:"select first_name as data_label,country as group_column,sales_year as x_axis,sum(sales_qty) as value {{link}}<br>from AXP_SALES_DATA <br>group by first_name,sales_year,country <br>order by sales_year",kpi:"select sum(sales_amount) as axphideh_sales from AXP_SALES_DATA where country = 'India'",kpi1:"select * from axp_sales_data where sales_qty=(select max(sales_qty) from axp_sales_data)",table:"select * from AXP_SALES_DATA",iview:"select first_name,country,sales_year,sales_amount from axp_sales_data",links:{chartLink:{oracle:",<br>'h1=isales(name='|| first_name ||'^year='|| sales_year ||')' as link",mysql:",<br>CONCAT('h1=isales(name=', first_name, '^year=', sales_year, ')') as link",mariadb:",<br>CONCAT('h1=isales(name=', first_name, '^year=', sales_year, ')') as link",mssql:",<br>'h1=isales(name='+ first_name +'^year='+ sales_year +')' as link"},pieLink:{oracle:",<br>'h1=isales(name='|| first_name ||')' as link ",mssql:",<br>'h1=isales(name='+ first_name +')' as link ",mysql:",<br>CONCAT('h1=isales(name=', first_name,')') as link",mariadb:",<br>CONCAT('h1=isales(name=', first_name,')') as link"},kpiLink:{oracle:"select first_name,country,sales_year,<br>'h1=isales(name='|| first_name || '^year='||  sales_year ||')~h2=ipurch(qty='|| sales_qty || ')' as link <br>from AXP_SALES_DATA",mssql:"select first_name,country,sales_year,<br>'h1=isales(name='+ first_name + '^year='+  sales_year +')~h2=ipurch(qty='+ sales_qty + ')' as link <br>from AXP_SALES_DATA",mysql:"select first_name,country,sales_year,<br>CONCAT('h1=isales(name=', first_name, '^year=',  sales_year, ')~h2=ipurch(qty=', sales_qty, ')') as link <br>from AXP_SALES_DATA",mariadb:"select first_name,country,sales_year,<br>CONCAT('h1=isales(name=', first_name, '^year=',  sales_year, ')~h2=ipurch(qty=', sales_qty, ')') as link <br>from AXP_SALES_DATA"}}},chartExamples={area:exampleQueries.threeColumn,line:exampleQueries.threeColumn,bar:exampleQueries.threeColumn,column:exampleQueries.threeColumn,"stacked-bar":exampleQueries.threeColumn,"stacked-column":exampleQueries.threeColumn,"stacked-percentage-column":exampleQueries.threeColumn,"scatter-plot":exampleQueries.scatter,"stacked-group-column":exampleQueries.fourColumn,"scatter-plot-3D":exampleQueries.scatter3D,pie:exampleQueries.twoColumn,"semi-donut":exampleQueries.twoColumn,donut:exampleQueries.twoColumn,chartLink:exampleQueries.links.chartLink[dbType],pieLink:exampleQueries.links.pieLink[dbType],kpi:exampleQueries.kpi,kpi1:exampleQueries.kpi1,table:exampleQueries.table,kpiLink:exampleQueries.links.kpiLink[dbType],iview:exampleQueries.iview},widgetMessages=(_widgetMessages={noChart:eval(callParent("lcm[17]")),noTitle:eval(callParent("lcm[146]")),noCaption:"Please enter the caption.",noIviewName:"Please enter the iview name."},_defineProperty(_widgetMessages,"noCaption","Please enter the caption"),_defineProperty(_widgetMessages,"noTypeSelected","Please select the type."),_defineProperty(_widgetMessages,"mandatoryFld",eval(callParent("lcm[147]"))),_defineProperty(_widgetMessages,"validStructureName","Please enter a valid structure name."),_defineProperty(_widgetMessages,"noRoles",eval(callParent("lcm[148]"))),_defineProperty(_widgetMessages,"widgetCreated",eval(callParent("lcm[149]"))),_defineProperty(_widgetMessages,"deleteSuccess",eval(callParent("lcm[150]"))),_defineProperty(_widgetMessages,"widgetUpdated",eval(callParent("lcm[151]"))),_defineProperty(_widgetMessages,"noChanges",eval(callParent("lcm[152]"))),_defineProperty(_widgetMessages,"atleastOneCol",eval(callParent("lcm[153]"))),_defineProperty(_widgetMessages,"noIviewType","Please select the type of ivew."),_defineProperty(_widgetMessages,"validSql","Please enter the valid SQL."),_defineProperty(_widgetMessages,"maxGroups","Reached maximum no.of groups."),_defineProperty(_widgetMessages,"invalidName","Please enter a valid name."),_defineProperty(_widgetMessages,"invalidCaption","Please enter a valid caption."),_defineProperty(_widgetMessages,"noSQl","Please enter a valid SQL."),_defineProperty(_widgetMessages,"invalidIviewParams","Invalid parameters, name cannot be column name or global parameter."),_defineProperty(_widgetMessages,"noResponsibility","No Responsibility"),_defineProperty(_widgetMessages,"paramNameExists","Parameter name already exists"),_defineProperty(_widgetMessages,"hypNameExists","Hyperlink name already exists"),_defineProperty(_widgetMessages,"iviewNameAlreadyExists","Iview name already exists"),_defineProperty(_widgetMessages,"multipleHypParams","Parameter name should not be duplicate."),_defineProperty(_widgetMessages,"invalidIviewName","Please enter a valid iview name"),_defineProperty(_widgetMessages,"unsavedChanges","You have unsaved data. Do you want to proceed?"),_defineProperty(_widgetMessages,"invalidColName","Please enter a valid column name."),_defineProperty(_widgetMessages,"invalidDecimalVal","Please enter a valid decimal value."),_defineProperty(_widgetMessages,"invalidColWidth","Please enter a valid column width."),_defineProperty(_widgetMessages,"paramsInUse","Params used in SQL cannot be deleted."),_widgetMessages),wizardObj=new WizardComp({progress_bar:"".concat("modern"===AxwizardType?"flat":AxwizardType)});inheritsFrom(AjaxCallObj,MainAjaxCalls);var ajaxCallObj=new AjaxCallObj,isValidPage=ajaxCallObj.isPageValid();function changeIvType(e,a){if(presWizardData.isDirty=!0,(e=$(e)).hasClass("active"))return!1;presWizardData.iviews.viewtype=a,"Interactive"===a&&(presWizardData.iviews.gtotal="F");var t=$("#iviewType").data("isComp");$("#iviewType a.active").removeClass("active"),$("#iviewType .selectedIcon").remove(),e.addClass("active"),e.find("span").html('<span class="selectedIcon darkenBackground themeDarkenBackground icon-check"></span>'),"true"!==t&&($("#iviewType").data("isComp","true"),wizardObj.completeCurrentStep(),wizardObj.checkNxtPrevBtns())}function getModalHTML(e){var a=e.type,t=e.details,r=(e.idOfModel,"");if("param"===a){var i=$(t).parents(".ivEchPramWrapper"),l=(i.index(),i.data("tmpIndex"));if(l===undefined)var s=i.find(".pName").val(),o=i.find(".pVal").val(),n=i.find("select.pType").val(),d="",c="0",p="",h="",u="",m="",v="",g="";else{var f=presWizardData.extraData.params[l];f.name=i.find(".pName").val(),f.value=i.find(".pVal").val(),f.datatype=i.find("select.pType").val();s=f.name,o=f.value,d=f.caption,n=f.datatype,c=f.decimals||"0",p=f.expr,h=f.hidden,u=f.moe,m=f.sql,v=f.suggest,g=f.vexpr}r+='<div class="container1">',r+='<div class="row">',r+='<div class="input-field col s12 m6">',r+='<input maxlength="10" '+(i.find(".pName").is(":disabled")?"disabled":"")+' value="'+s+'" class="themeMaterialInp" id="ivPropName" type="text">',r+='<label for="ivPropName">Name</label>',r+="</div>",r+='<div class="input-field col s12 m6">',r+='<input value="'+d+'" class="themeMaterialInp" id="ivPropCaptn" type="text">',r+='<label for="ivPropCaptn">Caption</label>',r+="</div>",r+='<div class="input-field col s12 m4">',r+='<select id="ivPropType" class="materialSelect">',r+="<option "+("Character"===n?"selected":"")+' value="Character">Character</option>',r+="<option "+("Date/Time"===n?"selected":"")+' value="Date/Time">Date/Time</option>',r+="<option "+("Numeric"===n?"selected":"")+' value="Numeric">Numeric</option>',r+="</select>",r+="<label>Data Type</label>",r+="</div>",r+='<div class="input-field col s12 m4">',r+="<input "+("Numeric"===n?"":"disabled")+' value="'+c+'" class="themeMaterialInp" id="ivPropdcml" type="text">',r+='<label for="ivPropdcml">Decimal</label>',r+="</div>",r+='<div class="input-field col s12 m4">',r+='<input value="'+o+'" class="themeMaterialInp" id="ivPropVal" type="text">',r+='<label for="ivPropVal">Value</label>',r+="</div>",r+='<div class="input-field col s12 m6">',r+='<select id="ivParamsMoe" class="materialSelect">',r+="<option "+("Accept"===u?"selected":"")+' value="Accept">Accept</option>',r+="<option "+("Select"===u?"selected":"")+' value="Select">Select</option>',r+="<option "+("Multi Select"===u?"selected":"")+' value="Multi Select">Multi Select</option>',r+="<option "+("Pick List"===u?"selected":"")+' value="Pick List">Pick List</option>',r+="</select>",r+="<label>Mode Of Entry</label>",r+="</div>",r+='<div class="col s12 m6">',r+='<div class="switch" style="position: relative; top: 28px;">',r+="Is Hidden :",r+="<label>",r+="No",r+="<input "+("T"===h?"checked":"")+' id="ivParamIsHidden" type="checkbox">',r+='<span class="lever"></span> Yes',r+="</label>",r+="</div>",r+="</div>",r+="</div>",r+='<div class="row">',r+='<div class="input-field col s6">',r+='<input value="'+p+'" class="themeMaterialInp" id="ivPropExp" type="text">',r+='<label for="ivPropExp">Expression</label>',r+="</div>",r+='<div class="input-field col s6">',r+='<input value="'+g+'" class="themeMaterialInp" id="ivPropVldExp" type="text">',r+='<label for="ivPropVldExp">Validate Expression</label>',r+="</div>",r+='<p class="ivChckBx">',r+="<input "+("T"===v?"checked":"")+' type="checkbox" id="ivPropExpCheck" />',r+='<label for="ivPropExpCheck">Calculate using this expression only if the value is empty.</label>',r+="</p>",r+="</div>",r+='<div class="row">',r+='<div class="input-field col s12">',r+='<textarea id="ivPropSql" class="materialize-textarea">'+m+"</textarea>",r+='<label for="ivPropSql">SQL</label>',r+="</div></div></div>"}else"font"===a&&(r+='<div class="container">',r+='<div class="row">',r+='<div class="col s12 m8">',r+="<label>Font Type</label>",r+='<select id="fontSelect" class="browser-default" style="font-family: Arial, Arial, Helvetica, sans-serif;">',r+='<option value="Arial" style="font-family: Arial, Arial, Helvetica, sans-serif;">Arial</option>',r+='<option value="Arial Black" style="font-family: &quot;Arial Black&quot;, &quot;Arial Black&quot;, Gadget, sans-serif;">Arial Black</option>',r+='<option value="Comic Sans MS" style="font-family: &quot;Comic Sans MS&quot;, &quot;Comic Sans MS&quot;, cursive;">Comic Sans MS</option>',r+='<option value="Courier New" style="font-family: &quot;Courier New&quot;, &quot;Courier New&quot;, Courier, monospace;">Courier New</option>',r+='<option value="Georgia" style="font-family: Georgia, Georgia, serif;">Georgia</option>',r+='<option value="Impact" style="font-family: Impact, Charcoal, sans-serif;">Impact</option>',r+='<option value="Lucida Console" style="font-family: &quot;Lucida Console&quot;, Monaco, monospace;">Lucida Console</option>',r+='<option value="Lucida Sans Unicode" style="font-family: &quot;Lucida Sans Unicode&quot;, &quot;Lucida Grande&quot;, sans-serif;">Lucida Sans Unicode</option>',r+='<option value="Palatino Linotype" style="font-family: &quot;Palatino Linotype&quot;, &quot;Book Antiqua&quot;, Palatino, serif;">Palatino Linotype</option>',r+='<option value="Tahoma" style="font-family: Tahoma, Geneva, sans-serif;">Tahoma</option>',r+='<option value="Times New Roman" style="font-family: &quot;Times New Roman&quot;, Times, serif;">Times New Roman</option>',r+='<option value="Trebuchet MS" style="font-family: &quot;Trebuchet MS&quot;, Helvetica, sans-serif;">Trebuchet MS</option>',r+='<option value="Verdana" style="font-family: Verdana, Geneva, sans-serif;">Verdana</option>',r+='<option value="Gill Sans" style="font-family: &quot;Gill Sans&quot;, Geneva, sans-serif;">Gill Sans</option>',r+="</select>",r+="</div>",r+='<div class="col s12 m2">',r+="<label>Font Size</label>",r+='<select id="fontSize" class="browser-default">',r+='<option value="8" alt="11px" selected="">8pt</option>',r+='<option value="10" alt="13px">10pt</option>',r+='<option value="12" alt="16px">12pt</option>',r+='<option value="14" alt="19px">14pt</option>',r+='<option value="15" selected alt="21px">15pt</option>',r+='<option value="17" alt="23px">17pt</option>',r+='<option value="18" alt="24px">18pt</option>',r+='<option value="23" alt="30.67">23pt</option>',r+='<option value="24" alt="32px">24pt</option>',r+='<option value="30" alt="40px">30pt</option>',r+="</select>",r+="</div>",r+='<div class="col s12 m2">',r+='<label style="display: block;margin-bottom: 4px;">Font Color</label>',r+='<input type="text" id="custom" />',r+="</div>",r+="</div>",r+='<div class="row">',r+='<div class="col s12" id="fontExtraProps">',r+='<p class="ivChckBx">',r+='<input type="checkbox" id="fontBold" />',r+='<label for="fontBold">Bold</label>',r+="</p>",r+='<p class="ivChckBx">',r+='<input type="checkbox" id="fontItalic" />',r+='<label for="fontItalic">Italic</label>',r+="</p>",r+='<p class="ivChckBx">',r+='<input data-type="underline" class="fntTxtDc" type="checkbox" id="fontUdr" />',r+='<label for="fontUdr">Underline </label>',r+="</p>",r+='<p class="ivChckBx">',r+='<input data-type="line-through" class="fntTxtDc" type="checkbox" id="fontStr" />',r+='<label for="fontStr">Strikeout</label>',r+="</p>",r+="</div>",r+="</div>",r+='<div class="row">',r+='<div id="fontExapmle">',r+='<span class="ex">Exapmle</span>',r+='<span class="mainEx">Axpert</span>',r+="</div>",r+="</div>",r+="</div>");return r}function afterModalIsCreated(e){e.idOfModel;"font"===e.type&&($("#custom").spectrum({color:"#000",chooseText:"Apply",clickoutFiresChange:!1,change:function(e){$("#fontExapmle .mainEx").css("color",e.toHexString())},move:function(e){$("#fontExapmle .mainEx").css("color",e.toHexString())},hide:function(e){$("#fontExapmle .mainEx").css("color",e.toHexString())}}),$("#fontSelect").on("change",function(e){var a="";switch($(this).val()){case"Arial":a="Arial, Arial, Helvetica, sans-serif;";break;case"Arial Black":a="&quot;Arial Black&quot;, &quot;Arial Black&quot;, Gadget, sans-serif";break;case"Comic Sans MS":a="&quot;Comic Sans MS&quot;, &quot;Comic Sans MS&quot;, cursive";break;case"Courier New":a="&quot;Courier New&quot;, &quot;Courier New&quot;, Courier, monospace";break;case"Georgia":a="Georgia, Georgia, serif";break;case"Impact":a="Impact, Charcoal, sans-serif";break;case"Lucida Console":a=" &quot;Lucida Console&quot;, Monaco, monospace";break;case"Lucida Sans Unicode":a="&quot;Palatino Linotype&quot;, &quot;Book Antiqua&quot;, Palatino, serif";break;case"Tahoma":a="Tahoma, Geneva, sans-serif";break;case"Times New Roman":a="&quot;Times New Roman&quot;, Times, serif";break;case"Trebuchet MS":a="&quot;Trebuchet MS&quot;, Helvetica, sans-serif";break;case"Verdana":a="Verdana, Geneva, sans-serif";break;case"Gill Sans":a="font-family: &quot;Gill Sans&quot;, Geneva, sans-serif";break;default:a="&quot;Arial Black&quot;, &quot;Arial Black&quot;, Gadget, sans-serif"}a=a.replace(/&quot;/g,'"'),$("#fontExapmle .mainEx").css("font-family",a)}),$("#fontSize").on("change",function(e){$("#fontExapmle .mainEx").css("font-size",$(this).val()+"px")}),$("#fontExtraProps .ivChckBx input").on("change",function(e){var a=$(this);switch(a.attr("id")){case"fontBold":a.is(":checked")?$("#fontExapmle .mainEx").css("font-weight","bold"):$("#fontExapmle .mainEx").css("font-weight","normal");break;case"fontItalic":a.is(":checked")?$("#fontExapmle .mainEx").css("font-style","italic"):$("#fontExapmle .mainEx").css("font-style","normal");break;case"fontUdr":case"fontStr":2===$("#fontExtraProps .fntTxtDc:checked").length?$("#fontExapmle .mainEx").css("text-decoration","underline line-through"):0===$("#fontExtraProps .fntTxtDc:checked").length?$("#fontExapmle .mainEx").css("text-decoration","none"):$("#fontExapmle .mainEx").css("text-decoration",$("#fontExtraProps .fntTxtDc:checked").data("type"))}}))}function applyTheExtraColPropsForIview(e){e.idOfModel;var a=e.index,t=e.type;if(0===t.indexOf("font")){var r=$("#fontSelect").val(),i=$("#fontSize").val(),l=$("#custom").spectrum("get").toHexString(),s=$("#fontBold").is(":checked")?"True":"False",o=$("#fontItalic").is(":checked")?"True":"False",n=$("#fontUdr").is(":checked")?"True":"False",d=$("#fontStr").is(":checked")?"True":"False";"font-cf"===t&&(s=s.substr(0,1).toLowerCase(),o=o.substr(0,1).toLowerCase(),n=n.substr(0,1).toLowerCase(),d=d.substr(0,1).toLowerCase(),$(a).data("value",r+","+s+","+o+","+n+","+l+","+d+","+i))}else if("params"===t){var c={qryname:"Task1"};c.name=$("#ivPropName").val(),c.caption=$("#ivPropCaptn").val(),c.datatype=$("#ivPropType").val(),c.expr=$("#ivPropExp").val(),c.suggest=$("#ivPropExpCheck").is(":checked")?"T":"F",c.vexpr=$("#ivPropVldExp").val(),c.hidden=$("#ivParamIsHidden").is(":checked")?"T":"F",c.sql=$("#ivPropSql").val(),c.decimals=$("#ivPropdcml").val()||0,c.width=200,c.value=$("#ivPropVal").val(),c.moe=$("#ivParamsMoe").val(),c.ordno=1,(p=$("#ivParamMainWrapper .ivEchPramWrapper").eq(a)).find(".pName").val(c.name),p.find(".pVal").val(c.value),p.find("select.pType").material_select("destroy"),p.find("select.pType").val(c.datatype).material_select(),Materialize.updateTextFields();var p,h=(p=$("#ivParamMainWrapper .ivEchPramWrapper:eq("+a+")")).data("tmpIndex"),u=h===undefined,m=createUpdateIvJsonData("tparams",c,h,u);u&&p.data("tmpIndex",m)}}function doTheIviewValidations(e,a){if("cols"===e){var t=$("#ivColPropDcml").val();if(!isValidNumber(t))return $("#ivColPropDcml").focus(),showAlertDialog("warning",widgetMessages.invalidDecimalVal),!1;var r=$("#ivColPropClWdth").val();if(!isValidNumber(r))return $("#ivColPropClWdth").focus(),showAlertDialog("warning",widgetMessages.invalidColWidth),!1;if(""===$("#ivColPropCptn").val())return showAlertDialog("warning",widgetMessages.noCaption),$("#ivColPropCptn").focus(),!1;var i=$("#ivColHypName").val();if(""!==i||$("a[href='#ivColLink']").hasClass("active")){if(""===i||!testRegex("validNameWithoutSpace",i))return showAlertDialog("warning",widgetMessages.invalidName),$("#ivColHypName").focus(),!1;a=a||"";var l=$(".ciColWrapper[data-original="+a+"]").text();if(presWizardData.extraData.hyperlinks){(a=presWizardData.extraData.hyperlinks[l])!==undefined&&(a=parseInt(a));for(var s=presWizardData.iviews.hyperlinks,o=0;o<s.length;o++){if(o!==a)if(s[o].hname.toLowerCase()===i.toLowerCase())return showAlertDialog("warning",widgetMessages.hypNameExists),$("#ivColHypName").focus(),!1}}var n=[],d=!1;if($("#ivColHypPramWrapper .cloneParent [id^='ivColHyPName']").each(function(e,a){var t=$(this),r=t.data("key");if(r){if(-1!==$.inArray(r,n))return d=widgetMessages.multipleHypParams,t.focus(),!1;n.push(r)}}),!1!==d)return showAlertDialog("warning",d),!1;if(""===$("#ivColPropTypeSel").val()||null===$("#ivColPropTypeSel").val())return showAlertDialog("warning",widgetMessages.noTypeSelected),$("#ivColPropTypeSel").parent().find("input").click(),!1;if(!$("#ivColHypStName").data("key")||""===$("#ivColHypStName").val())return showAlertDialog("warning",widgetMessages.validStructureName),$("#ivColHypStName").focus(),!1}}else if("params"===e){t=$("#ivPropdcml").val();if(!isValidNumber(t))return $("#ivPropdcml").focus(),showAlertDialog("warning",widgetMessages.invalidDecimalVal),!1;var c=$("#ivPropName").val(),p=$("#ivParamMainWrapper .ivEchPramWrapper").eq(a).find(".pName"),h=!0;if($("#ivParamMainWrapper .ivEchPramWrapper .pName").not(p).each(function(e,a){if(c===$(this).val())return showAlertDialog("warning",widgetMessages.paramNameExists),$("#ivPropName").focus(),h=!1,!1}),!h)return h;if(""===c||!testRegex("validNameWithoutSpace",$("#ivPropName").val()))return showAlertDialog("warning",widgetMessages.invalidName),$("#ivPropName").focus(),!1;if(""===$("#ivPropCaptn").val())return showAlertDialog("warning",widgetMessages.noCaption),$("#ivPropCaptn").focus(),!1;if("Accept"!==$("#ivParamsMoe").val()&&""===$("#ivPropSql").val())return showAlertDialog("warning",widgetMessages.noSQl),$("#ivParamsMoe").focus(),!1}return!0}function getExampleData(e,a){var t="";if("kpi"===e)t+="<h3>Example 1</h3>",t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+chartExamples.kpi+"</p></a>",t+="<h3>Example 2</h3>",t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+chartExamples.kpi1+"</p></a>",t+="<h3>Example 3</h3>",t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+chartExamples.table+"</p></a>",t+="<h3>Example 4</h3>",t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+chartExamples.kpiLink+"</p></a>";else if("chart"===e){var r=chartExamples[a],i="pie"===a||"semi-donut"===a||"donut"===a?chartExamples.pieLink:chartExamples.chartLink;t+="<h3>Example 1</h3>",t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+r.replace("{{link}}","")+"</p></a>",t+="<h3>Example 2</h3>",t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+r.replace("{{link}}",i)+"</p></a>"}else"iview"===e&&(t+="<a class='chrtKpiEXAnchr hoverFocusThemeColor' href='javascript:void(0)'><p class='chrtKpiEX'>"+chartExamples.iview+"</p></a>");return t}function closeProprtySht(e,a){if($("#propertySheet").hasClass("scale-out"))return!0;if("delete"!=e&&!validateProprtySht(e,a))return!1;clearPropertySheet();$("#propertySheet").data("target");return $("#propertySheet").data("target","").removeClass("scale-in").addClass("scale-out"),setTimeout(function(){$("#propertySheet").addClass("hide")},50),$(document).off("blur.prpShtTargetErrorValidate"),!0}function validateProprtySht(task,elem){var isAutoSave=$("#prpShtAutoSave").is(":checked"),validpropmsg=eval(callParent("lcm[121]"));if(jQuery.isEmptyObject(updateObj))"onPageClick"===task&&$(elem).addClass("manualClick").click();else{if(!isAutoSave&&"manualSave"!=task)return confirmBox=$.confirm({theme:"modern",title:eval(callParent("lcm[191]")),content:validpropmsg,columnClass:"col s6 offset-s3",escapeKey:"buttonB",onContentReady:function(){disableBackDrop("bind")},buttons:{buttonA:{text:eval(callParent("lcm[191]")),btnClass:"btn btn-primary",action:function(){revertThePropSheet(),updateObj={},"onWdgtClick"===task||"onPageClick"===task?elem.click():closeProprtySht()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy"),confirmBox=""}}}}),!1;if(!validateBeforeUpdatePrpSht())return;var wId=$("#propertySheet").data("target").substr(8);updateTmpObjBeforeSave("wid","widget_id",wId),ajaxCallObj.addDetails(updateObj,"update")}return!0}function validateBeforeUpdatePrpSht(){return""!==$("#prpShtTitle").val()||(showAlertDialog("warning",widgetMessages.noTitle),!1)}function openProprtySht(e,a,t){$("#"+a).addClass("selectedForPropSht"),$(".commonCloseOnOpen").addClass("notSearchable").hide();var r,i,l=$("#"+a).offset(),s=parseInt(.7*$(window).height()),o=parseInt($("#"+a).css("width")),n=(parseInt($("#"+a).css("width")),"inherit");$("#widgetPanelWrapper").scrollTop();r=l.left+o+280>$(window).width()?l.left-280:l.left+o,l.top+s>$(window).height()?(i="inherit",n="0px"):i=l.top+"px",$("#propertySheet").css({top:i,left:r+"px",bottom:n}).data("target",a).removeClass("hide"),setTimeout(function(){$("#propertySheet").removeClass("scale-out").addClass("scale-in")},50)}function ChangePropertySheet(e){"kpiWidgetAdded"!=e&&"kpiWidgetClicked"!=e||("kpiWidgetAdded"==e&&$("#prpShtTargetRgn").prop("checked",!1).change(),$("#bdBgClrTr,#bdTxtClrTr").addClass("notSearchable").hide(),$("#gradientPickerWrapper,#prpShtTitlePickerTr").removeClass("notSearchable").addClass("kpiWidgetIcon").show())}function clearPropertySheet(){updateObj={},$("#propertySearchFld").val("").keyup(),$(".customFldError").removeClass("customFldError"),$("#prpShtUpdateInfo").show(),$(".chartColorPalletWrapper").hide(),$("#chartColorPicker button").data("colorcode","pallet1"),$("#ifCustomColorCodes").val(""),$("#prpShtComponent,#prpShtModifiedBy,#prpShtModifiedOn").text(""),$("#prpShtTarget,#prpShtTxtBx,#prpShtRoles,#prpShtImgWrapper .file-path").val(""),$("#widgetPanelWrapper .widgetWrapper.selectedForPropSht").removeClass("selectedForPropSht"),$("#propertySheet .notSearchable").removeClass("notSearchable").show(),$("#propertySheet .prpShtAuthRelated,.prpSteNonIvRelated").removeClass("notSearchable").show(),$("#propertySheet .ivDisabledFld").prop("disabled",!1),$("#propertySheet .prpSteIvRelated").addClass("notSearchable").hide(),$("#gradientPicker").attr("class","colorMe blue center-align"),$("#gradientPicker a").data("color","blue").text("Blue"),$(".gradientPalletWrapper").hide(),$(".gradientSelected").remove()}function createCustomTxtBx(e){var a=(e=$(e)).offset(),t=widgetTableData["w"+e.data("id")].sql;$("#customTxtAreaWrapper").css({top:a.top+"px",left:a.left+"px"}),$("#customTxtAreaWrapperBg").show(),setTimeout(function(){$("#customTxtAreaFooter button.save").attr("onclick",'closeCustomTxtBx("'+e.attr("id")+'","save")'),$("#customTxtAreaFooter button.cancel").attr("onclick",'closeCustomTxtBx("'+e.attr("id")+'","cancel")'),updateSqlCM?t&&updateSqlCM.getDoc().setValue(t):((updateSqlCM=CodeMirror.fromTextArea($("#customTxtAreaWrapper textarea")[0],{mode:"text/x-sql",smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,extraKeys:{"Ctrl-Space":"autocomplete",Tab:!1,"Shift-Tab":!1},value:document.documentElement.innerHTML,hintOptions:{tables:codeMirrorHintObj}})).on("change",function(e,a){$("#customTxtAreaWrapper textarea").addClass("valChanged")}),t&&updateSqlCM.getDoc().setValue(t)),$("#customTxtAreaWrapper textarea").removeClass("valChanged"),$("#customTxtAreaWrapper").addClass("centerMe"),$("#customTxtAreaFooter").slideDown()},50),$(document).on("keyup.closeCustomTxtBx",function(e){27==e.keyCode&&(e.preventDefault(),confirmBox&&confirmBox.isOpen()?(confirmBox.close(),confirmBox=""):closeCustomTxtBx("prpShtTxtBx","cancel"))})}function closeCustomTxtBx(elem,task){if("cancel"==task){if($("#customTxtAreaWrapper textarea").hasClass("valChanged"))return void(confirmBox=$.confirm({theme:"modern",title:eval(callParent("lcm[191]")),escapeKey:"buttonB",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[121]")),columnClass:"col s6 offset-s3",buttons:{buttonA:{text:eval(callParent("lcm[191]")),btnClass:"btn btn-primary",action:function(){$("#customTxtAreaWrapper textarea").removeClass("valChanged"),closeCustomTxtBx(elem,"PermnantCancel")}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy"),confirmBox=""}}}}));task="PermnantCancel"}elem=$("#"+elem);var keyWord=elem.data("key"),txtFldval=updateSqlCM.getDoc().getValue();if("save"!=task||"sqlDt"!=keyWord){$(document).off("keyup.closeCustomTxtBx"),$("#customTxtAreaWrapperBg").hide(),$("#customTxtAreaWrapper").removeClass("centerMe").removeAttr("style");var targetParId=elem.parents("#propertySheet").data("target");if("PermnantCancel"!=task){confirmBox="";var keyWord=elem.data("key");elem.val(txtFldval),updateSqlCM.getDoc().setValue(" "),$("#customTxtAreaFooter").hide()}}else""===txtFldval?showAlertDialog("warning",widgetMessages.noSQl):ajaxCallObj.isValidQuery(txtFldval,"update")}function gradientClick(e,a){var t='<div class="gradientSelected"><span class="icon-check"></span></div>';if("colorClick"!=e){if("colorPick"==e){$(".gradientSelected").remove();var r=$("#propertySheet").data("target");$(".gradientPalletWrapper .pallet ."+a).append(t),$("#gradientPicker").attr("class","colorMe "+a+" center-align"),$("#gradientPicker a").data("color",a).text(a),updateTmpObjBeforeSave("attr","kpiColor",a),$("#"+r).find(".kpiCard").attr("class","kpiCard card colorMe "+a),$("#"+r).find(".colorMe").data("kpicolor",a)}}else{$(".gradientPalletWrapper").toggle("medium");var i=$("#gradientPicker a").data("color");$(".gradientPalletWrapper .pallet ."+i).append(t)}}function chartColorChanger(e,a,t,r){if("colorPick"===e){var i=(a=$(a)).val();customChartColors[i];if("custom"===i){if($("#colorSelector .palletSelectFld").removeClass("nonCustom"),$("#colorSelector .palletMinatureWrapper").hide(),0===$("#chartCustomColors input").length){var l="",s=$("#ifCustomColorCodes").val();if(""===s)var o=customChartColors.pallet1;else o=s.split(",");for(var n=o.length,d=0;d<chartColorCount;d++){var c=o[d];c||(c=o[d-Math.floor(d/n)*n]),l+="<input type='color' class='customSColorPic' value='"+c+"' />"}$("#chartCustomColors").html(l),$(".customSColorPic").spectrum({preferredFormat:"hex",showInput:!0,change:function(e){var a="";$("#chartCustomColors input").each(function(e,t){a+=$(this).val()+","}),a=a.slice(0,-1),$("#ifCustomColorCodes").val(a),chnageKpiChartView("changeColors","","chart",{isCustom:!0}),updateTmpObjBeforeSave("attr","cccv",a)}})}$("#chartCustomColors").show(),$("#chartColorChangerSlctBx").data("isManualChange")||chnageKpiChartView("changeColors","","chart",{isCustom:!0}),$("#chartColorChangerSlctBx").data("isManualChange",!1)}else{$("#colorSelector .palletSelectFld").addClass("nonCustom"),$("#chartCustomColors").hide();customChartColors[i];$("#colorSelector .palletMinatureWrapper").attr("class",i+"mini palletMinatureWrapper").show(),$("#chartColorChangerSlctBx").data("isManualChange")||chnageKpiChartView("changeColors","","chart",{keyCode:i}),$("#chartColorChangerSlctBx").data("isManualChange",!1)}}else"colorSet"===e&&("custom"===a&&($("#ifCustomColorCodes").val(t),$("#chartCustomColors").html("")),r=r===undefined,$("#chartColorChangerSlctBx").val(a).data("isManualChange",r).change(),$("#chartColorChangerSlctBx").material_select("destroy"),$("#chartColorChangerSlctBx").material_select())}function createCustomColorPicker(){}function createConfirmBox(task,msg,widgetId){if(deleteCnfrmBx&&deleteCnfrmBx.isOpen())return!1;var title="Delete";"onWizardClose"===task&&(title="Confirm"),deleteCnfrmBx=$.confirm({theme:"modern",title:title,onContentReady:function(){disableBackDrop("bind")},backgroundDismiss:"false",escapeKey:"buttonB",content:msg,columnClass:"col s6 offset-s3",buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary",action:function(){if("onWizardClose"!==task){closeProprtySht("delete");var e=widgetTableData["w"+widgetId];if("iview"===e.type){e&&(e=JSON.parse(e.attr));var a={};a.iviews={actmode:"delete",ivname:e.ivName},ajaxCallObj.crudIview(a,widgetId)}else ajaxCallObj.deleteWidget(widgetId);deleteCnfrmBx=""}else $("#wizardModal .modal-footer .cancelButton").click()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy"),tabFocusEventHandler({task:"bind",parentId:"wizardModal",loopInsideParent:!0}),deleteCnfrmBx=""}}}})}function AjaxCallObj(){var e=this;this.getTstructs=function(e){var a=primaryApiSettings();a.url=apiBase+"getTstructs",a.data.dname="dc1",$.ajax(a).done(function(e){if(1==e.status){var a=e.data;if(a){for(var t=a.length,r=0;r<t;r++){var i=a[r];tstructData[i[1]]=i[0]}$("input#widgetTstructName").autocomplete({isKeyImage:!1,data:tstructData,limit:20,onAutocomplete:function(e){var a=$("input#widgetTstructName").data("key");if(a){var t=tstructTables[a];t?($("input#widgetTstrctColumn").autocomplete("destroy"),$("input#widgetTstrctColumn").autocomplete({isKeyImage:!1,data:t,limit:20,onAutocomplete:function(e){var a=$("input#widgetTstructName").data("key"),t=$("input#widgetTstrctColumn").data("key"),r=t.split("__~__")[0];t&&(tstructTableCols[a+r]?showTheTableRemainigData(a+r):ajaxCallObj.getTableCols(a,t))},minLength:0}).prop("disabled",!1).focus()):ajaxCallObj.getTstructTables(a)}else showAlertDialog("warning",1027,"client")},minLength:0})}}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})},this.getTstructTables=function(e){var a=primaryApiSettings();a.url=apiBase+"getTtable",a.data.tstruct=e,$.ajax(a).done(function(a){if(1==a.status){var t=a.data;if(t){for(var r=t.length,i={},l=0;l<r;l++){var s=t[l];i[s[1]]=s[2]+"__~__"+s[0]}tstructTables[e]=i,$("input#widgetTstrctColumn").autocomplete({isKeyImage:!1,data:i,limit:20,onAutocomplete:function(e){var a=$("input#widgetTstrctColumn").data("key"),t=a.split("__~__")[0];if(a){var r=$("input#widgetTstructName").data("key");tstructTableCols[r+t]?showTheTableRemainigData(r+t):ajaxCallObj.getTableCols(r,a)}},minLength:0}).prop("disabled",!1).focus()}}else filterErrorMessageAndShow(a)}).fail(function(e,a,t){onAjaxFailure()})},this.getTableCols=function(e,a){a=a.split("__~__")[0];var t=primaryApiSettings();t.url=apiBase+"getTableCols",t.data.tstruct=e,t.data.tablename=a,$.ajax(t).done(function(t){if(1==t.status){var r=t.data,i={},l={};if(r){for(var s=r.length,o=0;o<s;o++){var n=r[o],d=n[1],c=n[0],p=n[2];i[d]=c+"__~__"+p,"n"===p&&(l[d]=c+"__~__"+p)}tstructTableCols[e+a]={all:i},tstructTableCols[e+a].num=l,showTheTableRemainigData(e+a)}}else filterErrorMessageAndShow(t)}).fail(function(e,a,t){onAjaxFailure()})},this.validateIvName=function(e){if(""===e)return!1;if(!testRegex("noSpecialCharactersAndNotStartingWithNumber",e))return $("#iviewName").focus(),showAlertDialog("warning",widgetMessages.invalidIviewName),!1;callParentNew("loadFrame()","function");var a=primaryApiSettings();a.url=apiBase+"iviewexists",a.data.iviewname=e,$.ajax(a).done(function(a){callParentNew("closeFrame()","function"),1==a.status?(a.data&&($("#iviewName").focus(),showAlertDialog("warning",widgetMessages.iviewNameAlreadyExists)),presWizardData.iviews.ivname=e):($("#iviewName").removeClass("notValidated"),presWizardData.iviews.ivname=e,filterErrorMessageAndShow(a))}).fail(function(e,a,t){onAjaxFailure()})},this.getAllGroups=function(){var e=primaryApiSettings();e.url=apiBase+"getWidgetGroup",$.ajax(e).done(function(e){if(1==e.status){var a=e.data,t={};groups=[];for(var r=0;r<a.length;r++){var i=a[r][0];i&&(t[i]=i,groups.push(i))}$("#widgetGroupsInp").autocomplete({isKeyImage:!1,data:t,limit:20,onAutocomplete:function(e){},minLength:0})}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})},this.getAllResponsibilities=function(){var e=primaryApiSettings();e.url=apiBase+"getallresponsibilities",$.ajax(e).done(function(e){if(1==e.status){var a=e.data;if(a){for(var t=widgetTableData.allRoles=[],r="",i=a.length,l=0;l<i;l++){var s=a[l];r+="<option value='"+s+"'>"+s+"</option>",t.push(s)}$("#multiselect").html(r),$("#multiselect").multiselect()}}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})},this.isValidQuery=function(e,a){var t="iview"===widgetType;e=validateTheSql(e);var r=primaryApiSettings();r.url=apiBase+"getQuery",r.data.q=e,r.data.calledFrom="validate",r.data.isMetadata=t,$.ajax(r).done(function(t){if(1==t.status)if("update"===a){$("#propertySheet").data("target").substr(8);var r=updateSqlCM.getDoc().getValue();updateTmpObjBeforeSave("sql","sql",r),$("#prpShtTxtBx").val(r),$("#customTxtAreaWrapperBg").hide(),$("#customTxtAreaWrapper").removeClass("centerMe").removeAttr("style")}else{if($("#wizardNextbtn").hasClass("iAmClicked")){if($("#wizardNextbtn").removeClass("iAmClicked").html("Next &gt;"),"iview"===widgetType){var i=t;i._sql=e;var l=validateSqlDataForParams(i);if(!1===createIvColHtml(t.metaData,a))return;if(presWizardData.iviews.tasks[0].txt[0].v=e,!l)return targetElemClicked="",$("#wizardHeader .step[data-target='queryData']").hasClass("active")||$("#wizardHeader .step[data-target='queryData'] a").click(),showAlertDialog("warning",widgetMessages.invalidIviewParams),!1;presWizardData.extraData.metaData=t.metaData,addIvParamsDynamically(l)}$("#wizardNextbtn").addClass("validated"),targetElemClicked||$("#wizardNextbtn").click()}targetElemClicked&&""!==targetElemClicked&&(targetElemClicked.click(),targetElemClicked="")}else"update"!==a&&$("#wizardNextbtn").hasClass("iAmClicked")&&$("#wizardNextbtn").removeClass("iAmClicked").html("Next &gt;"),targetElemClicked="",$("#wizardHeader .step[data-target='queryData']").hasClass("active")||$("#wizardHeader .step[data-target='queryData'] a").click(),filterErrorMessageAndShow(t)}).fail(function(e,a,t){$("#wizardNextbtn").removeClass("iAmClicked").html("Next &gt;"),onAjaxFailure()})},this.getHintsForCodeMirror=function(){var e=primaryApiSettings();e.url=apiBase+"getTstructs",$.ajax(e).done(function(e){if(1==e.status){var a=e.data;a&&$.each(a,function(e,a){codeMirrorHintObj[a[0]]?codeMirrorHintObj[a[0]].push(a[1]):codeMirrorHintObj[a[0]]=[a[1]],callParentNew("mainSQLhintObj=",codeMirrorHintObj)})}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})},this.addDetails=function(a,t){if(e.isPageValid()){var r=primaryApiSettings();if(r.url=apiBase+"addWidget",r.data.type=t,a&&a.attrs){var i=a.attrs.exposeAPI;!0===i?r.data.isAPI="Y":!1===i&&(r.data.isAPI="N")}if("insert"===t&&(r.data.isAPI="N"),r.data.json=JSON.stringify(a),"update"===t&&a.sql){var l=[],s=getTheCacheKey({widgetId:a.widget_id,sql:""});l.push(s.replace("~wb~","~hbp~"),s.replace("~wb~","~hbs~")),ajaxCallObj.clearRedisData(l)}$.ajax(r).done(function(e){if(callParentNew("closeFrame()","function"),1==e.status){ajaxCallObj.checkDashboard();var a=e.data,r=a[0],i=a[1],l=a[2];if("insert"==t?(-1===$.inArray($("#widgetGroupsInp").val(),groups)&&ajaxCallObj.getAllGroups(),$("#widgetPanelWrapper").prepend(getPanelHtml(l,i,r)),"all"!==$("#matcolumnSrchBtn").text()&&$("#matcolumnSearch li:first").click(),$("#widgetPanelWrapper .widgetWrapper").length<=widgetsPerPage?$(".pagination-wrapper").hide():$(".pagination-wrapper").show(),$(".pagination-wrapper").data("AXPAGINATION")?$(".pagination-wrapper").createAxPagination("rearrange"):createPagination(),wizardObj.resetTheWizard(),$("#wizardModal").modal("close"),showAlertDialog("success",widgetMessages.widgetCreated)):showAlertDialog("success",widgetMessages.widgetUpdated),widgetTableData.data||(widgetTableData.data=[],widgetTableData.indexes={}),r=parseInt(r),"insert"==t)widgetTableData.data.push({id:r,title:i,widget_type:l}),widgetTableData.indexes[r]=widgetTableData.data.length-1,dataTableApi&&dataTableApi.row.add(_defineProperty({id:r,title:i,widget_type:l},"id",r)).draw();else{var s=widgetTableData.indexes[r],o=widgetTableData.data[s];if(r=r||o.id,i=i||o.title,l=l||o.widget_type,widgetTableData.data[s]={id:r,title:i,widget_type:l},dataTableApi){var n=dataTableApi.rows().eq(0).filter(function(e){return dataTableApi.cell(e,0).data()===r});dataTableApi.row(n[0]).data({id:r,title:i,widget_type:l}).draw()}}ajaxCallObj.getAxpertWidgetDetails({tId:"new",widgetId:a[0]})}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})}else redirectPage(!0)},this.getDetails=function(e,a){var t=primaryApiSettings();t.url=apiBase+"getWidgets",$.ajax(t).done(function(e){if(1==e.status){var a=e.data;if(a){for(var t=a.length,r=widgetTableData.data=[],i=widgetTableData.indexes={},l=0;l<t;l++){var s=a[l],o=s[1],n=s[0],d=s[2],c=widgetTableData["w"+o];c||(c=widgetTableData["w"+o]={}),$("#widgetPanelWrapper").append(getPanelHtml(d,n,o)),c.title=n,c.type=d,r.push({id:o,title:n,widget_type:d}),i[o]=l,l<widgetsPerPage&&ajaxCallObj.getAxpertWidgetDetails({tId:l,widgetId:o})}createPagination(),callParentNew("closeFrame()","function")}}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})},this.checkDashboard=function(){var e=primaryApiSettings();e.url=apiBase+"checkDashboard",e.data.rty=parent.userResp,$.ajax(e).done(function(e){if(1==e.status){var a=e.data||0;parseInt(a)>0?$("#dashBoardIcon",parent.document).show():$("#dashBoardIcon",parent.document).hide()}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})},this.deleteWidget=function(a){if(e.isPageValid()){callParentNew("loadFrame()","function");var t=primaryApiSettings();t.url=apiBase+"deleteWidget",t.data.widget_id=a,$.ajax(t).done(function(e){callParentNew("closeFrame()","function");var t="axWidget"+a;if(1==e.status){newWidgetData=!0,$("#dashBoardIcon",parent.document).is(":visible")&&ajaxCallObj.checkDashboard(),$("#"+t).remove(),showAlertDialog("success",widgetMessages.deleteSuccess),dataTableApi&&dataTableApi.row($("#wdgtDataTable .editDelBtn[data-id="+a+"]").parents("tr")).remove().draw();var r=widgetTableData.indexes[a];r!==undefined&&widgetTableData.data.splice(r,1),"widget"===presentView?($("#widgetPanelWrapper .widgetWrapper").length<=widgetsPerPage?$(".pagination-wrapper").hide():$(".pagination-wrapper").show(),$(".pagination-wrapper").data("AXPAGINATION")?$(".pagination-wrapper").createAxPagination("rearrange"):createPagination()):$("#gridWdgtToggleBtn").addClass("changesAvailable"),ajaxCallObj.getAllGroups()}else filterErrorMessageAndShow(e)}).fail(function(e,a,t){onAjaxFailure()})}else redirectPage(!0)},this.getWidgetRoles=function(e,a){var t=primaryApiSettings();t.url=apiBase+"getWidgetResponsibility",t.data.widget_id=e,$.ajax(t).done(function(t){if(1==t.status){var r=[];t.data&&$.each(t.data,function(e,a){r.push(a[1])}),widgetTableData["w"+e].roles=r,$("#prpShtRoles").html(a),$("#prpShtRoles").val(r),$("#prpShtRoles").material_select()}else filterErrorMessageAndShow(t)}).fail(function(e,a,t){onAjaxFailure()})},this.crudIview=function(a,t){if(e.isPageValid()){callParentNew("loadFrame()","function"),a.iviews.axpapp=mainProjName,a.iviews.s=sId,a.iviews.appsessionkey=appsessionKeyWOL,a.iviews.trace=tracePath,a.iviews.username=currentUserName,a.iviews.globalvars=parent.axUtlGlobalVars,a.iviews.uservars=parent.axUtlUserVars,a.iviews.axapps=parent.axUtlApps;var r=primaryApiSettings();r.url=apiBase+"saveiview",r.data.sPath=mainRestDllPath,r.data.data=JSON.stringify(a),$.ajax(r).done(function(e){if(!1===e.status)return callParentNew("closeFrame()","function"),parent.closeFrame(),void showAlertDialog("error",e.errMsg);var r=e.data.result[0];"success"===r.status?"new"===a.iviews.actmode?(addIviewInMenu(a.iviews.ivname,a.iviews.ivcaption),ajaxCallObj.addDetails(t,"insert")):"delete"===a.iviews.actmode&&ajaxCallObj.deleteWidget(t):r.error?(callParentNew("closeFrame()","function"),showAlertDialog("error",r.error.msg)):(callParentNew("closeFrame()","function"),showAlertDialog("error",r.msg))}).fail(function(){onAjaxFailure()})}else redirectPage(!0)}}function createMainObj(e,a,t){if(!widgetMetaData){widgetMetaData={};for(var r=e.datametaData,i=r.length,l=0;l<i;l++)widgetMetaData[r[l].name]=l}var s=a.substr(8),o=widgetTableData["w"+s];o||(o=widgetTableData["w"+s]={});var n=e.data,d=e.queryData,c=e.querymetaData;if(o.sql=n[widgetMetaData.SQLTEXT],o.attr=n[widgetMetaData.ATTRIBUTES],o.roles=n[widgetMetaData.ROLES],o.cType=n[widgetMetaData.CHARTTYPE],o.grpName=n[widgetMetaData.SUB_TYPE],o.qrData=d,o.qrMData=c,"new"==t&&(o.type=n[widgetMetaData.WIDGET_TYPE],o.title=n[widgetMetaData.TITLE]),"error"!=t&&(t<=widgetsPerPage||"new"===t||-1!=$.inArray(parseInt(s),demandArray))){a="axWidget"+s;createAxpertWidget(o,a),$("#"+a).addClass("widgetCreated")}}function addIviewInMenu(e,a){try{parent.menuJson.root.parent;var t={target:"iview.aspx?ivname="+e,img:"",intview:"",level:"0",name:a,oname:"PageIv"+e,url:""};parent.menuJson.root.parent.push(t);var r={HLTYPE:"iview",PARAMS:"",SEARCHTEXT:a,STRUCTNAME:e};parent.tblSearchData.Table.push(r)}catch(i){console.log(i)}}function validateSqlDataForParams(e){for(var a=e.metaData,t=a.length,r=createGlobalVars({onlyKeys:!0}),i=parseSqlForParams({sql:e._sql}),l=0;l<t;l++){var s=a[l].name.toLowerCase();-1===$.inArray(s,r)&&r.push(s)}for(l=0;l<i.length;l++){var o=i[l].toLowerCase();if(!testRegex("validNameWithoutSpace",o)||-1!==$.inArray(o,r))return!1}return i}function addIvParamsDynamically(e){if(e&&e.length)var a=e.length;else a=0;var t="";if(t+='<div class="row ivEchPramWrapper">',t+='<div class="col m2 right-align">',(!a||a>1)&&(t+='<button title="Move Up" onclick="moveIvParamUpDwn(this,\'up\')" class="waves-effect  customSmallBtn waves-light btn-flat"><span class="icon-chevron-up"></span></button>',t+='<button title="Move Down" onclick="moveIvParamUpDwn(this,\'down\')" class="waves-effect customSmallBtn waves-light btn-flat"><span class="icon-chevron-down"></span></button>'),t+='<button title="Edit" onclick="createExtraModel({type:\'param\',details:this})" class="waves-effect customSmallBtn waves-light btn-flat"><span class="icon-pencil"></span></button>',t+="</div>",t+='<div class="col m8">',t+='<div class="input-field col s4">',t+='<input {{disabled}} value="{{value}}" type="text" class="themeMaterialInp pName">',t+="<label>Name</label>",t+="</div>",t+='<div class="input-field col s4 slctFld">',t+='<select class="materialSelect pType">',t+='<option value="Character" selected>Character</option>',t+='<option value="Date/Time">Date/Time</option>',t+='<option value="Numeric">Numeric</option>',t+="</select>",t+="</div>",t+='<div class="input-field col s4">',t+='<input type="text" class="themeMaterialInp pVal">',t+="<label>Value</label>",t+="</div>",t+="</div>",t+='<div class="col m2">',t+='<button title="Add" onclick="addDeleteIvParamRow(this,\'add\')" class="{{hide}} waves-effect waves-light customSmallBtn btn-flat"><span class="icon-plus"></span></button>',t+='<button title="Remove" onclick="addDeleteIvParamRow(this,\'delete\')" class="{{hide}} waves-effect waves-light customSmallBtn btn-flat"><span class="icon-cross2"></span></button>',t+="</div>",t+="</div>",e&&e.length){a=e.length;t=t.replace(/{{disabled}}/g,"disabled").replace(/{{hide}}/g,"");for(var r="",i=0;i<a;i++){var l=e[i];r+=t.replace(/{{value}}/g,l)}$("#ivParamMainWrapper").html(r)}else t=t.replace(/{{disabled}}/g,"").replace(/{{hide}}/g,"").replace(/{{value}}/g,""),$("#ivParamMainWrapper").html(t);$("#ivParamMainWrapper select.materialSelect").material_select(),Materialize.updateTextFields()}function addEventsAfterWidgetCreated(e){$("#"+e+" .smallKpiTableWrapper").first().mCustomScrollbar({axis:"yx",theme:"minimal-dark",scrollInertia:500,autoExpandScrollbar:!1,updateOnContentResize:!0})}function showTheTableRemainigData(e){if("chart"===widgetType){var a='<div class="input-field col s12 m4 autoComInpFld"> <input data-index="{i}" data-type="{type}" type="text" id="extraParamFld{i}" class="themeInp themeMaterialInp autocompleteMe"><label for="extraParamFld{i}">{fldName}<sup>*</sup></label></div>',t='<div class="input-field col s12 m4">';t+="<select onchange='createSqlForTableData()' class='exParamslct materialSelect' id='exParamslct{i}'>",t+="<option value='' selected>Select A Function</option>",t+="<option value='sum'>Sum</option>",t+="<option value='count'>Count</option>",t+="<select>",t+="</div>";var r="",i=$("#chartSelData a.selected").data("cc"),l=$("#widgetTableRemData").data("cc");if(""==$("#wtrFldsData").html()||i!==l){$("#widgetTableRemData").data("cc",i);for(var s=chartConfiguration[i],o=s.fieldsCount,n=s.fields,d=s.type,c=0;c<o;c++){var p=n[c],h=d[c];if(p.split("~").length>1){r+="<div class='row marg0 bringMeNewRow'>";var u=p.split("~")[0];r+=a.replace(/{i}/g,c).replace(/{fldName}/g,u).replace(/{type}/g,h),r+=t.replace(/{i}/g,c),r+="</div>"}else r+=a.replace(/{fldName}/g,p).replace(/{i}/g,c).replace(/{type}/g,h)}$("#wtrFldsData").html(r),$("#wtrFldsData select").material_select(),$("#widgetTableRemData").show(),$("#whrCls").hasClass("cdmrEdiSetted")?tableSqlCm.refresh():($("#whrCls").addClass("cdmrEdiSetted"),(tableSqlCm=CodeMirror.fromTextArea(document.getElementById("whrCls"),{mode:"text/x-sql",smartIndent:!0,lineNumbers:!0,matchBrackets:!0,extraKeys:{"Ctrl-Space":"autocomplete",Tab:!1,"Shift-Tab":!1},value:document.documentElement.innerHTML,hintOptions:{tables:{}}})).on("change",function(e,a){$("#wizardNextbtn").removeClass("validated")}))}else $("#wtrFldsData .autocompleteMe").data("key",undefined).removeData("key").removeClass("valSelected").val("").off("keyup.autoCompKeyUp").off("focus.autoCompFocus").autocomplete("destroy"),selectedCols=[],Materialize.updateTextFields(),$("#widgetTableRemData").show();$("#wtrFldsData .autocompleteMe").off("keyup.autoCompKeyUp"),$("#wtrFldsData .autocompleteMe").on("keyup.autoCompKeyUp",function(e){var a=$(this);e.which<=111&&e.which>=48||8==e.which||46==e.which||e.which>=186&&e.which<=192||e.which>=219&&e.which<=222?a.focus():9!==e.which&&e.preventDefault()}),$("#wtrFldsData .autocompleteMe").off("keydown.autoCompKeyDown"),$("#wtrFldsData .autocompleteMe").on("keydown.autoCompKeyDown",function(e){$(this).data("key")&&(e.which<=111&&e.which>=48||8==e.which||46==e.which||e.which>=186&&e.which<=192||e.which>=219&&e.which<=222?($(this).removeData("key"),$(this).data("key",undefined).removeClass("valSelected"),selectedCols[$.inArray($(this).val(),selectedCols)]=null):9!==e.which&&e.preventDefault())}),$("#wtrFldsData .autocompleteMe").off("focus.autoCompFocus"),$("#wtrFldsData .autocompleteMe").on("focus.autoCompFocus",function(a){var t=$(this);if(t.data("key"))t.select();else{var r=t.data("type"),i={};if(t.hasClass("firstFocus"))t.removeClass("firstFocus");else{"*"===r?$.extend(i,tstructTableCols[e].all):"n"===r&&$.extend(i,tstructTableCols[e].num);for(var l=0;l<selectedCols.length;l++){var s=selectedCols[l];s&&delete i[s]}t.autocomplete("destroy"),t.addClass("firstFocus").autocomplete({isKeyImage:!1,data:i,limit:20,onAutocomplete:function(e){selectedCols[t.data("index")]=e,createSqlForTableData()},minLength:0}).focus()}}}),createSqlForTableData()}else if("kpi"===widgetType||"iview"===widgetType){var m="",v=tstructTableCols[e].all;for(var g in v)if(v.hasOwnProperty(g)){var f=g;m+="<option value='"+v[g].split("__~__")[0]+"'>"+f+"</option>"}var w="";w='<div class="row con">',w+='<div class="col multiSelWrap">',w+='<label class="widgetRespLabel">Columns<sup>*</sup></label>',w+='<select name="from[]" id="extraColMSFrom" data-right="#extraColMSTo" data-right-all="#right_All_1" data-right-selected="#right_Selected_1" data-left-all="#left_All_1" data-left-selected="#left_Selected_1" class="form-control1 browser-default rlmultiSlectFld" size="8" multiple="multiple">',w+=m,w+="</select>",w+="</div>",w+='<div class="col multiSelWrapOpt" style="padding-left: 20px;">',w+='<button title="Select All" type="button" id="right_All_1" class="waves-effect btn-flat smallBtn">',w+='<i class="icon-chevron-right frstIcn"></i>',w+='<i class="icon-chevron-right scndIcn"></i>',w+="</button>",w+='<button title="Select" type="button" id="right_Selected_1" class="waves-effect btn-flat smallBtn">',w+='<i class="icon-chevron-right"></i>',w+="</button>",w+='<button title="Remove" type="button" id="left_Selected_1" class="waves-effect btn-flat smallBtn">',w+='<i class="icon-chevron-left"></i>',w+="</button>",w+='<button title="Remove All" type="button" id="left_All_1" class="waves-effect btn-flat smallBtn">',w+='<i class="icon-chevron-left frstIcn"></i>',w+='<i class="icon-chevron-left scndIcn"></i>',w+="</button>",w+="</div>",w+='<div class="col multiSelWrap">',w+='<select name="to[]" id="extraColMSTo" class="form-control1 browser-default rlmultiSlectFld" size="8" multiple="multiple"></select>',w+="</div>",w+="</div>",$("#wtrFldsData").html(w),$("#widgetTableRemData").show(),$("#extraColMSFrom").multiselect({afterMoveToRight:function(){createSqlForTableData("kpi")},afterMoveToLeft:function(){createSqlForTableData("kpi")}}),$("#right_All_1").click(),$("#whrCls").hasClass("cdmrEdiSetted")?tableSqlCm.refresh():($("#whrCls").addClass("cdmrEdiSetted"),(tableSqlCm=CodeMirror.fromTextArea(document.getElementById("whrCls"),{mode:"text/x-sql",smartIndent:!0,lineNumbers:!0,matchBrackets:!0,extraKeys:{"Ctrl-Space":"autocomplete",Tab:!1,"Shift-Tab":!1},value:document.documentElement.innerHTML,hintOptions:{tables:{}}})).on("change",function(e,a){$("#wizardNextbtn").removeClass("validated")})),createSqlForTableData("kpi")}}function createIvColHtml(e,a){var t=e.length,r="";r+='<div class="row">',r+='<div class="col m8 offset-m2 s12">',r+="<div>",r+='<div class="input-field">',r+='<input id="ivColSechr" class="themeMaterialInp" type="text">',r+='<label for="ivColSechr">Column</label>',r+="</div>",r+="</div>",r+='<div class="collection" id="ivColCollctnWrppr">',t>4&&(r+='<a title="Scroll Up" href="#!" onclick="moveColsUpDwn(38)" class="collection-item center-align upDwnArrw upArw"><span class="icon-chevron-up"></span></span></a>');var i=presWizardData.extraData.cols={};presWizardData.iviews.cols=[];for(var l=0;l<t;l++){var s=e[l].name.toLowerCase(),o=e[l].type.toLowerCase();switch(o){case"c":o="Character";break;case"i":o="Numeric";break;case"d":o="Date/Time";break;default:o="Character"}if(!testRegex("validNameWithoutSpace",s))return showAlertDialog("warning",widgetMessages.invalidColName),!1;i[s]=l,createUpdateIvJsonData("cols",{name:s,index:l+1,dtype:o},l,!0),r+=l>=4?'<div style="display: none;" class="collection-item srchSlcted colItm">':0===l?'<div class="collection-item srchSlcted highlighted colItm">':'<div class="collection-item srchSlcted colItm">',r+="<div id=ivColsUQ"+s+' data-original="'+l+'" onclick="createExtraModel({type:\'col\',details:this})" class="ciColWrapper">'+s,r+='<a class=\'blackText ivColPropsAnchr hoverFocusThemeColor\' href=\'javascript:void(0)\'><span title="Edit" class="edit"><span class="icon-pencil5"></span></span></a>',r+="</div>",r+='<div class="upDwnWrapper">',r+="<a class='blackText hoverFocusThemeColor' href='javascript:void(0)'><span title=\"Move Up\" class=\"icon-chevron-up\"></span></a>",r+="<a class='blackText hoverFocusThemeColor' href='javascript:void(0)'><span title=\"Move Down\" class=\"icon-chevron-down\"></span></a>",r+="</div>",r+='<div class="clear"></div>',r+="</div>"}t>4&&(r+='<a title="Scroll Down" href="#!" onclick="moveColsUpDwn(40)" class="collection-item center-align upDwnArrw dwnArw"><span class="icon-chevron-down"></span></span></a>'),r+="</div></div></div>",$("#ivColData").html(r),$(document).on("keyup","#ivColSechr",function(e){e.preventDefault(),$("#ivColCollctnWrppr .collection-item.highlighted").removeClass("highlighted");var a=$(this).val();$("#ivColCollctnWrppr .colItm").removeClass("srchSlcted").hide(),""===a?$("#ivColCollctnWrppr .colItm").addClass("srchSlcted"):$("#ivColCollctnWrppr .colItm").each(function(e,t){var r=$(this);-1!==r.text().toLowerCase().indexOf(a.toLowerCase())&&r.addClass("srchSlcted").show()}),$("#ivColCollctnWrppr .collection-item.srchSlcted:visible").first().addClass("highlighted"),$("#ivColCollctnWrppr .colItm.srchSlcted:lt(4)").show(),$("#ivColCollctnWrppr .colItm.srchSlcted:gt(3)").hide()}),$(document).off("keydown.ivColKdEvnt"),$(document).on("keydown.ivColKdEvnt",function(e){moveColsUpDwn(e.keyCode)}),$(document).off("mouseenter.mseEnter","#ivColCollctnWrppr .colItm"),$(document).on("mouseenter.mseEnter","#ivColCollctnWrppr .colItm",function(){$("#ivColCollctnWrppr .collection-item.highlighted").removeClass("highlighted"),$(this).addClass("highlighted")}),$(document).off("click.upDwnClick","#ivColCollctnWrppr .upDwnWrapper a"),$(document).on("click.upDwnClick","#ivColCollctnWrppr .upDwnWrapper a",function(e){e.preventDefault();var a=$(this);if(!(a=a.find("span")).hasClass("disabled")){var t=a.attr("class"),r=a.parents(".colItm");if(-1!==t.indexOf("up")){var i=r.prevAll(".srchSlcted").first();if(!i.hasClass("colItm"))return void a.addClass("disabled");i.is(":visible")||(i.show(),$("#ivColCollctnWrppr .collection-item.srchSlcted:visible").last().hide(),l.prevAll(".srchSlcted").first().hasClass("colItm")||a.addClass("disabled")),r.insertBefore(i),a.next().removeClass("disabled")}else if(-1!==t.indexOf("down")){var l=r.nextAll(".srchSlcted").first();if(!l.hasClass("colItm"))return void a.addClass("disabled");l.is(":visible")||(l.show(),$("#ivColCollctnWrppr .collection-item.srchSlcted:visible").first().hide(),l.nextAll(".srchSlcted").first().hasClass("colItm")||a.addClass("disabled")),r.insertAfter(l),a.prev().removeClass("disabled")}}}),$("#ivColSechr").focus()}function createUpdateIvJsonData(e,a,t,r){if("cols"===e){var i=presWizardData.iviews.cols,l={};if(r)l={name:a.name,caption:a.name,qryname:"Task1",dtype:a.dtype||"Character",ordno:a.index.toString(),width:"80",decimal:"0",align:"Left",rtotal:"F",disptotal:"F",applycomma:"F",norepeat:"F",zerooff:"F",hidden:"F",font:"",color:"",defcolor:"T",dblclick:"",cf:[{expr:"",style:""}]};else if(l={name:a.name,caption:a.caption,qryname:"Task1",dtype:a.dtype,ordno:a.index.toString(),width:a.width,decimal:a.decimal,align:a.align,rtotal:a.rtotal,disptotal:a.disptotal,applycomma:a.applycomma,norepeat:a.norepeat,zerooff:a.zerooff,hidden:a.hidden,font:"",color:"",defcolor:"T",dblclick:"",cf:[{expr:"",style:""}]},a.hyperLink){var s=presWizardData.extraData.hyperlinks;if(s||(s=presWizardData.extraData.hyperlinks={}),!(o=presWizardData.iviews.hyperlinks))var o=presWizardData.iviews.hyperlinks=[];var n=s[a.name];n===undefined?o.push(a.hyperLink):o[n]=a.hyperLink,s[a.name]=o.length-1}i[t]=l}else{if("tparams"===e){if(!(d=presWizardData.extraData.params))var d=presWizardData.extraData.params=[];return r?(d.push(a),d.length-1):(d[t]=a,t)}if("params"===e){if(!(c=presWizardData.iviews.params))var c=presWizardData.iviews.params=[];c.push(a)}}}function moveColsUpDwn(e){var a=$("#ivColCollctnWrppr .collection-item.highlighted");if(0!==a.length)if(38===e){var t=a.prevAll(".srchSlcted").first();0!==t.length&&(t.is(":visible")||$("#ivColCollctnWrppr .collection-item.srchSlcted:visible").last().hide(),a.removeClass("highlighted"),t.show().addClass("highlighted"))}else if(40===e){var r=a.nextAll(".srchSlcted").first();0!==r.length&&(r.is(":visible")||$("#ivColCollctnWrppr .collection-item.srchSlcted:visible").first().hide(),a.removeClass("highlighted"),r.show().addClass("highlighted"))}else 13===e&&$("#ivColCollctnWrppr .collection-item.highlighted.srchSlcted").click()}function createSqlForTableData(e,a){var t="",r="",i=$("#widgetTstrctColumn").data("key").split("__~__"),l=i[1],s=$("#widgetTstructName").data("key"),o=selectedCols.length;if("kpi"===e)"*"!==a&&$("#extraColMSTo option").each(function(e,a){var i=$(this).val();t+=i+",",r+=i+","});else if(o>0)for(var n=$("#widgetTableRemData").data("cc"),d=chartConfiguration[n].fields,c=0;c<o;c++){var p=selectedCols[c];if(p)if(d[c].split("~").length>1){var h=$("#exParamslct"+c).val(),u=tstructTableCols[s+i[0]].all[p].split("__~__")[0];t+=h&&""!==h?h+"("+u+"),":u+",",r+=u+","}else{var m=tstructTableCols[s+i[0]].all[p].split("__~__")[0]+",";t+=m,r+=m}}if("*"===a)var v="SELECT  * FROM "+l;else if(""!==t&&(t=t.slice(0,-1),r=r.slice(0,-1)),"kpi"===e)v="SELECT "+t+" FROM "+l;else v="SELECT "+t+" FROM "+l+" group by "+r;tableSqlCm?(tableSqlCm.refresh(),tableSqlCm.getDoc().setValue(v)):$("#whrCls").val(v).text(v)}function createJsonToSend(){if("iview"==widgetType||0!==$("#multiselect_to option").length){if(!0===validateBeforeSave()){if("iview"===widgetType){var e=presWizardData.extraData.params,a=0;presWizardData.iviews.dispparam="T";var t=!0,r=[];if($("#ivParamMainWrapper .ivEchPramWrapper").each(function(i,l){var s=$(this),o=s.find(".pName").val();if(""!==o){if(-1!==$.inArray(o,r))return s.find(".pName").focus(),t=!1,!1;r.push(o);var n=$(this).data("tmpIndex");if(n!==undefined){a++;var d=e[n];d.ordno=a.toString(),createUpdateIvJsonData("params",d)}else{var c=s.find(".pName").val();if(""!==c){a++;var p={qryname:"Task1"};p.name=c,p.caption=c,p.datatype=s.find("select.pType").val(),p.expr="",p.suggest="F",p.vexpr="",p.hidden="F",p.sql="",p.decimals="0",p.width="200",p.value=s.find(".pVal").val()||"",p.moe="Accept",p.ordno=a.toString(),createUpdateIvJsonData("params",p)}}}}),"Interactive"!==presWizardData.iviews.viewtype){var i=presWizardData.iviews.cols;for(a=0;a<i.length;a++){if("T"===i[a].disptotal){presWizardData.iviews.gtotal="T";break}}}if(!t)return showAlertDialog("warning",widgetMessages.paramNameExists),!1;$("#ivColCollctnWrppr .collection-item.srchSlcted").each(function(e,a){var t=$(this).find(".ciColWrapper").data("original");presWizardData.iviews.cols[t].ordno=(e+1).toString()})}callParentNew("loadFrame()","function");var l={};l.wdgtType=widgetType;var s=$("#widgetTitle").val();s=htmlEntity("encode",s),l.wdgtTtl=s;var o=$("input[name='widgetSqlSource']:checked").data("val");if(l.srcType=o,"sql"===o)l.sql=mainSqlCM.getDoc().getValue();else if("tbl"===o){l.sql=tableSqlCm.getDoc().getValue();var n=l.tableData={};if(n.transId=$("#widgetTstructName").data("key"),n.tName=$("#widgetTstructName").val(),n.tblCptn=$("#widgetTstrctColumn").val(),n.dcTableName=$("#widgetTstrctColumn").data("key"),"chart"===widgetType){var d=n.exCols={},c=$("#chartSelData a.selected").data("cc");d.cck=c,d.data={};var p=chartConfiguration[c],h=p.fields;for(a=0;a<p.fieldsCount;a++){var u=h[a];u=u.split("~");var m=$("#extraParamFld0").val(),v=$("#extraParamFld0").data("key");if(u.length>1){var g="";"fun"===u[1]&&(g=$("#exParamslct"+a).val()||""),d.data[u[0]]=m+"__~__"+v+"__~__"+g}else d.data[u[0]]=m+"__~__"+v}}}if("chart"===widgetType){var f=$("#chartSelData a.selected").data("type");l.chrtType=f,l.attrs={ori:$("chartOrientation").val(),xAxisL:$("#chartXaxisLabel").val(),yAxisL:$("#chartYaxisLabel").val(),shwLgnd:$("#shwLgnd").is(":checked"),gradClrChart:$("#gradienChartInp").is(":checked")}}if("iview"===widgetType)l.attrs={ivName:presWizardData.iviews.ivname};else{l.group=$("#widgetGroupsInp").val();var w="";$("#multiselect_to option").each(function(e,a){w+=$(this).val()+","}),l.rty=w.slice(0,-1)}if("iview"===widgetType){var C={};C.iviews=presWizardData.iviews,ajaxCallObj.crudIview(C,l)}else ajaxCallObj.addDetails(l,"insert")}}else showAlertDialog("warning",widgetMessages.noRoles)}function validateBeforeSave(){if("chart"===widgetType||"kpi"===widgetType||"iview"===widgetType){if("chart"===widgetType)var e=wizardObj.chartWizard.validateKeys;else if("kpi"===widgetType)e=wizardObj.kpiWizard.validateKeys;else if("iview"===widgetType)e=wizardObj.iviewWizard.validateKeys;if(e&&e.length)for(var a=0;a<e.length;a++){var t=doTheValidations(e[a]);if(!0!==t)return showAlertDialog("warning",t),!1}}return!0}function doTheValidations(e){if(""!=e){if("chtType"===e){if(1!=$("#chartSelData").data("isCompleted"))return widgetMessages.noChart}else if("ivrt"===e){if("true"!=$("#iviewType").data("isComp"))return widgetMessages.noIviewType}else if("query"===e){if("iview"===widgetType){if(!testRegex("noSpecialCharactersAndNotStartingWithNumber",$("#iviewName").val()))return $("#iviewName").focus(),widgetMessages.invalidIviewName;if($("#iviewName").hasClass("notValidated"))return $("#iviewName").focus(),widgetMessages.iviewNameAlreadyExists;if(""===$("#iviewName").val())return $("#iviewName").focus(),widgetMessages.noIviewName}var a=$("#widgetTitle").val();if(""===a)return $("#widgetTitle").focus(),"iview"===widgetType?widgetMessages.noCaption:widgetMessages.noTitle;if("iview"===widgetType&&!testRegex("validName",a))return $("#widgetTitle").focus(),widgetMessages.invalidCaption;var t=$("input[name='widgetSqlSource']:checked").data("val");if("sql"===t){if($("#wizardNextbtn").hasClass("iAmClicked"))return;if($("#wizardNextbtn").hasClass("validated"))return!0;if(!(i=mainSqlCM.getDoc().getValue()))return widgetMessages.validSql;var r='<div class="btnLoader preloader-wrapper small active">';r+='<div class="spinner-layer spinner-white-only">',r+='<div class="circle-clipper left">',r+='<div class="circle"></div>',r+='</div><div class="gap-patch">',r+='<div class="circle"></div>',r+='</div><div class="circle-clipper right">',r+='<div class="circle"></div>',r+="</div></div></div>",$("#wizardNextbtn").html(r).addClass("iAmClicked");var i=mainSqlCM.getDoc().getValue();return void ajaxCallObj.isValidQuery(i,"query")}if("tbl"===t){var l=!0;if($("#queryData .autocompleteMe").each(function(e,a){var t=$(this);if(t.data("key")===undefined)return t.focus(),void(l=widgetMessages.mandatoryFld)}),1!=l)return l;if(("kpi"===widgetType||"iview"===widgetType)&&0===$("#extraColMSTo option").length)return widgetMessages.atleastOneCol;if($("#wizardNextbtn").hasClass("iAmClicked"))return;if($("#wizardNextbtn").hasClass("validated"))return!0;if(!(i=tableSqlCm.getDoc().getValue()))return widgetMessages.validSql;r='<div class="btnLoader preloader-wrapper small active">';return r+='<div class="spinner-layer spinner-white-only">',r+='<div class="circle-clipper left">',r+='<div class="circle"></div>',r+='</div><div class="gap-patch">',r+='<div class="circle"></div>',r+='</div><div class="circle-clipper right">',r+='<div class="circle"></div>',r+="</div></div></div>",$("#wizardNextbtn").html(r).addClass("iAmClicked"),void ajaxCallObj.isValidQuery(i,"query")}}else{if("attrs"==e){var s=!0,o=$("#widgetGroupsInp").val();if(""!==o)var n=-1===$.inArray(o,groups);return testRegex("specialCharsOnly",o)?n&&groups.length>=maxNoOfGroups?widgetMessages.maxGroups:($("#appearanceData .mandatoryFld").each(function(e,a){var t=$(this);if(""===t.val())return t.focus(),void(s=widgetMessages.mandatoryFld)}),s):widgetMessages.invalidName}if("rl"==e)return 0!==$("#multiselect_to option").length||widgetMessages.noRoles}return!0}return!0}function getPanelHtml(e,a,t){var r="icon-paper-plane";switch(e){case"tstruct":r="icon-register";break;case"iview":r="icon-clipboard-user";break;case"widget":r="icon-cube";break;case"Custom__html":r="icon-pencil5";break;case"Custom__sql":r="icon-cloud-database";break;case"Custom__rss":r="icon-wifi";break;case"Custom__txt":r="icon-feather3";break;case"Custom__img":r="icon-picture2";break;case"Custom__mytsk":r="icon-envelope-open";break;default:r="icon-paper-plane"}var i="";return i+='<div id="axWidget'+t+'" data-id='+t+' data-type="'+e+'" class="col s12 m4 l3 widgetWrapper">',i+='<div class="card hoverable ">',"table"!==e&&"kpi"!==e&&(i+='<div class="cardTitleWrapper">',i+='<i class="'+r+'"></i>',i+="<span class='cardTitle'>".concat(a,"</span>"),i+='<div class="clear"></div>',i+="</div>"),i+='<div class="cardContentMainWrapper">',i+='<button type="button" title="Delete Widget" class="cardTitleClear titleLessCardTitleClear  red waves-effect btn-floating right"><i class="icon-cross2"></i></button>',"chart"!=e&&"table"!=e&&"kpi"!=e&&"iview"!=e||(i+='<div class="card-content '+e+'">',i+='<div class="cardContentData">',i+="</div>",i+='<div class="cardContentLoader valign-wrapper">',i+='<div class="preloader-wrapper small active">',i+='<div class="spinner-layer themeBorderColor spinner-green-only">',i+='<div class="circle-clipper left">',i+='<div class="circle"></div>',i+="</div>",i+='<div class="gap-patch">',i+='<div class="circle"></div>',i+="</div>",i+='<div class="circle-clipper right">',i+='<div class="circle"></div>',i+="</div>",i+="</div>",i+="</div>",i+="</div>",i+="</div>"),i+="</div>",i+="</div>",i+="</div>"}function chartResize(e){$("#"+e+" .setChartHeight:visible").each(function(e,a){var t=$(this);t.removeClass("setChartHeight"),(e=t.data("highchartsChart"))&&Highcharts.charts[e].setSize(null,200)})}function createDatatable(e){if("widget"!=presentView||closeProprtySht())if($("#gridWdgtToggleBtn span").toggleClass("icon-list icon-grid"),"new"==e)presentView="table",$("#widgetDataTableWrapper").show(),$("#widgetPanelWrapper").hide(),dataTableApi?dataTableApi.columns.adjust().draw():createGridDatatble(),$("#gridWdgtToggleBtn").attr({onclick:'createDatatable("showWidget")',title:"Widget View"}),$(".AXpaginationWrapper").hide();else if("showWidget"==e){presentView="widget",$(".AXpaginationWrapper").show(),$("#widgetDataTableWrapper").hide(),$("#widgetPanelWrapper").show();var a=$("#mainSearchFld").val();if($("#mainSearchFld").val(a).keyup(),$("#matcolumnSearch").hasClass("clicked")){$("#matcolumnSearch").removeClass("clicked");var t=$("#matcolumnSrchBtn").text().toLowerCase();$("#matcolumnSrchBtn").text("").attr("title",""),$("#matcolumnSearch li[data-id='"+t+"']").click()}$("#gridWdgtToggleBtn").attr({onclick:'createDatatable("showTable")',title:"List View"})}else"showTable"==e&&(presentView="table",$("#widgetDataTableWrapper").show(),$(".AXpaginationWrapper").hide(),$("#widgetPanelWrapper").hide(),newWidgetData?(newWidgetData=!1,dataTableApi.destroy(),createGridDatatble(),dataTableApi.search($("#mainSearchFld").val()).draw()):dataTableApi&&dataTableApi.columns.adjust().draw(),$("#gridWdgtToggleBtn").attr({onclick:'createDatatable("showWidget")',title:"Widget View"}))}function createGridDatatble(){$(".AXpaginationWrapper").hide();var cutMsg=eval(callParent("lcm[0]"));dataTableApi=$("#widgetDataTableWrapper #wdgtDataTable").DataTable({aaData:widgetTableData.data,order:[],scrollY:"300px",scrollCollapse:!0,language:{emptyTable:cutMsg},fnDrawCallback:function(){$("#wdgtDataTable_paginate span a.paginate_button").length<=0?$("#wdgtDataTable_paginate,#wdgtDataTable_info").hide():$("#wdgtDataTable_paginate,#wdgtDataTable_info").show()},aoColumns:[{mDataProp:"id"},{mDataProp:"title"},{mDataProp:"widget_type"},{mDataProp:"id"}],columnDefs:[{targets:0,orderable:!1},{render:function(e,a,t){return"<button data-id="+e+' title="Delete" type="button" onclick="editDeleteTheRow(\''+e+"','delete')\" class=\"text-red editDelBtn waves-effect btn-flat icon-cross2\"></button>"},targets:0},{render:function(e,a,t){var r=widgetTableData["w"+e];return r&&r.sql||""},targets:3},{width:"30%",targets:2},{width:"30%",targets:1},{width:"40%",targets:3},{width:70,targets:0}]})}function editDeleteTheRow(id,task,elem){if("delete"===task)createConfirmBox("deleteWidget",eval(callParent("lcm[9]")),id);else if("edit"===task){var wId=id,presentObj=widgetTableData["w"+wId],type=presentObj.type;if("chart"===type){var cType=presentObj.cType,ex=chartExamples[cType]||"";$("#sqlEdtExData").html(ex),$("#sqlEdtExData,#sqlEdtExmpleBtn").hide()}else"kpi"===type&&$("#sqlEdtExData,#sqlEdtExmpleBtn").hide();var title=presentObj.title,SQL=presentObj.sql,SelectedRoles=presentObj.roles||"";clearPropertySheet();var cTypeToShw="table"===type.toLowerCase()?"kpi":type;$("#prpShtComponent").text(cTypeToShw),$("#prpShtTitle").val(htmlEntity("decode",title)),$("#prpShtTxtBx").data("id",wId).val(SQL);for(var rolesData=widgetTableData.allRoles,rolesDataLngth=rolesData.length,optionHtml="",i=0;i<rolesDataLngth;i++)optionHtml+='<option selected title="'+rolesData[i]+'" value="'+rolesData[i]+'">'+rolesData[i]+"</option>";0===rolesDataLngth&&(optionHtml+="<option disabled >No Roles assigned</option>"),$("#prpShtRoles").material_select("destroy"),ajaxCallObj.getWidgetRoles(wId,optionHtml),$("#prpShtApprRelated").addClass("notSearchable").hide(),openProprtySht("type","editWidg"+id,"calledFrom"),$("#gridWdgtToggleBtn").addClass("changesAvailable")}}function updateDiscardPropSheet(e){if(jQuery.isEmptyObject(updateObj))showAlertDialog("warning",widgetMessages.noChanges);else{if("revert"===e)return void revertThePropSheet();if(!validateBeforeUpdatePrpSht())return;closeProprtySht("manualSave")}}function changeTheValue(e,a){var t=(e=$(e)).val(),r=e.parents("#propertySheet").data("target");t=htmlEntity("encode",t),"title"===a&&$("#"+r+" .cardTitle").html(t),updateTmpObjBeforeSave("ttl","wdgtTtl",t)}function createPagination(){$("#widgetPanelWrapper .widgetWrapper").length<=widgetsPerPage?$(".pagination-wrapper").hide():$(".pagination-wrapper").show(),$(".pagination-wrapper").createAxPagination({target:"#widgetPanelWrapper",itemClass:"widgetWrapper",itemsPerPage:widgetsPerPage,nextIcnClass:"hoverFocusThemeColor icon-chevron-right",prevIcnClass:"hoverFocusThemeColor icon-chevron-left",afterPageShow:function(e){demandArray=[],$("#AXpage"+e+" .widgetWrapper").each(function(e,a){var t=$(this);if(!t.hasClass("errorOccured")){var r=t.data("id");if(!t.hasClass("widgetCreated")){demandArray.push(r);var i=widgetTableData.apiCalledFor;-1!==$.inArray(r,i)||ajaxCallObj.getAxpertWidgetDetails({tId:"new",widgetId:r})}var l=widgetTableData["w"+r];if(l&&l.sql)createAxpertWidget(l,"axWidget"+r)}})},onPageClick:function(e,a){if($(a).hasClass("active"))return!0;if($(a).hasClass("manualClick"))$(a).removeClass("manualClick");else if(!closeProprtySht("onPageClick",a))return!1;return $("#AXpage"+e+" .widgetWrapper").each(function(e,a){var t=$(this);if(t.removeClass("widgetSetted"),(e=t.find(".cardContentData").data("highcharts-chart"))!==undefined){var r=Highcharts.charts[e];r&&r.destroy()}}),!0}})}function addDeleteIvParamRow(e,a){e=$(e);var t=$("#ivParamMainWrapper").data("index")||1;if("add"===a){var r=e.parents(".ivEchPramWrapper"),i=$("<div class='ivEchPramWrapper row'>"+r.html()+"</div>").insertAfter(r);$(i).find(".slctFld").html("<select>"+r.find(".slctFld select").html()+"</select>"),$(i).find(".pName").prop("disabled",!1),$(i).find(".pName,select.pType,.pVal").val(""),$(i).find(".slctFld select").material_select(),$("#ivParamMainWrapper").data("index",t+1)}else if("delete"===a){var l=(r=e.parents(".ivEchPramWrapper")).data("tmpIndex");if(l!==undefined&&(presWizardData.extraData.params[l]=null),r.find(".pName").is(":disabled"))return void showAlertDialog("warning",widgetMessages.paramsInUse);if(1===$("#ivParamMainWrapper .ivEchPramWrapper ").length&&0===e.parents(".ivEchPramWrapper").index())return void r.find(".pName,select.pType,.pVal").val("");e.parents(".ivEchPramWrapper").remove(),$("#ivParamMainWrapper").data("index",t-1)}}function moveIvParamUpDwn(e,a){var t=(e=$(e)).parents(".ivEchPramWrapper");"up"===a?0!==t.index()&&t.insertBefore(t.prev()):"down"===a&&t.index()!==$("#ivParamMainWrapper .ivEchPramWrapper ").last().index()&&t.insertAfter(t.next())}function updateTheWizObj(e,a){if(""!==$(e).val()&&(presWizardData.isDirty=!0),"iview"===widgetType)if("cptn"===a)presWizardData.iviews.ivcaption=$(e).val();else if("ivname"===a){var t=(e=$(e)).val();presWizardData.iviews&&(presWizardData.iviews.ivname=t),e.addClass("notValidated"),ajaxCallObj.validateIvName(t)}}function revertThePropSheet(){var e=updateObj.wdgtTtl,a=updateObj.attrs,t=$("#propertySheet").data("target"),r=t.substr(8),i=widgetTableData["w"+r];if(e!==undefined){var l=i.title;$("#"+t+" .cardTitle").text(l),$("#prpShtTitle").val(htmlEntity("decode",l))}if(a){var s=i.attr,o="blue",n="remove",d=!0,c=!1,p=!1,h=!1,u=!1,m="pallet1",v=!1;if(s){var g=JSON.parse(s);o=(o=g.kpiColor)===undefined?"blue":o,n=(n=g.threeD)===undefined?"remove":n,d=(d=g.shwLgnd)===undefined||d,c=(c=g.shwKpiTtl)!==undefined&&c,p=(p=g.shwVal)!==undefined&&p,h=(h=g.gradClrChart)!==undefined&&h,m=(m=g.cck)===undefined?"pallet1":m,u=(u=g.shwChartVal)!==undefined&&u,v=!!g.exposeAPI}if(a.kpiColor!==undefined&&gradientClick("colorPick",o),a.exposeAPI!==undefined&&($("#prpShtAPIswitch").prop("checked",v),chnageKpiChartView("exposeAPI",v,"exposeAPI")),a.threeD!==undefined){var f="create"===n;$("#prpSht3DChrt").prop("checked",f),chnageKpiChartView("3d",n,"chart")}if(a.shwLgnd!==undefined&&($("#prpShtShwLgnd").prop("checked",d),chnageKpiChartView("shwLgnd",d,"chart")),a.shwKpiTtl!==undefined&&($("#prpShtshwKpiTtl").prop("checked",c),chnageKpiChartView("kpttl",c,"kpi")),a.shwVal!==undefined&&$("#prpShtShwValForPie").prop("checked",p),a.gradClrChart!==undefined&&("boolean"!=typeof h&&(h="true"===h),$("#prpShtGradientChrt").prop("checked",h).change()),a.cck!==undefined){var w="";if("custom"===m)w=g.cccv;chartColorChanger("colorSet",m,w,!1)}a.shwChartVal!==undefined&&($("#prpShtShwChrtVal").prop("checked",u),chnageKpiChartView("shwChartVal",u,"chart"))}updateObj.rty&&($("#prpShtRoles").val(i.roles),$("#prpShtRoles").material_select()),updateObj.group&&($("#prpShtGrpWrapper select").val(i.grpName),$("#prpShtGrpWrapper select").material_select()),updateObj={}}function updateTmpObjBeforeSave(e,a,t){if("attr"===e){var r=$("#propertySheet").data("target").substr(8);if(!updateObj.attrs){var i=widgetTableData["w"+r].attr;i=i?JSON.parse(i):{},updateObj.attrs=i}updateObj.attrs[a]=t}else"wdgtTtl"===a&&(""===t?$("#prpShtTitle").addClass("customFldError"):testRegex("validName",t)?$("#prpShtTitle").removeClass("customFldError"):$("#prpShtTitle").addClass("customFldError")),"group"===e&&(a="group",t=$("#prpShtGrpWrapper select").val()),updateObj[a]=t}function chnageKpiChartView(e,a,t,r){var i=$("#propertySheet").data("target");if("chart"===t){var l=$("#"+i).find(".cardContentData").attr("data-highcharts-chart");if("3d"===e){if("object"!==_typeof(a))var s=a;else s=$(a).is(":checked")?"create":"remove";updateTmpObjBeforeSave("attr","threeD",s),agileChartsObj.makeChartThreeD(s,l)}else if("pieShwVal"===e)updateTmpObjBeforeSave("attr","shwVal",$("#prpShtShwValForPie").is(":checked"));else if("shwLgnd"===e){if("object"!==_typeof(a))var o=a;else o=$("#prpShtShwLgnd").is(":checked");agileChartsObj.toggleLgnds(o,l),updateTmpObjBeforeSave("attr","shwLgnd",o)}else if("changeColors"===e){var n=$("#prpShtGradientChrt").is(":checked");if(r.isCustom){updateTmpObjBeforeSave("attr","cck","custom");var d="";$("#chartCustomColors input").each(function(e,a){d+=$(this).val()+","}),d=d.slice(0,-1),$("#ifCustomColorCodes").val(d),updateTmpObjBeforeSave("attr","cccv",(c=d.split(",")).toString())}else{updateTmpObjBeforeSave("attr","cck",r.keyCode),updateTmpObjBeforeSave("attr","cccv","");var c=customChartColors[r.keyCode]}agileChartsObj.updateColors(l,c,n)}else if("gradient"===e){if("object"!==_typeof(a))var p=a;else updateTmpObjBeforeSave("attr","gradClrChart",p=$(a).is(":checked"));var h=$("#chartColorChangerSlctBx").val()||"pallet1",u="";u="custom"===h?$("#ifCustomColorCodes").val().split(","):customChartColors[h],agileChartsObj.updateColors(l,u,p)}else if("shwChartVal"===e){if("object"!==_typeof(a))var m=a;else updateTmpObjBeforeSave("attr","shwChartVal",m=$(a).is(":checked"));agileChartsObj.toggleShowValues(m,l)}}else if("kpi"===t){if("object"!==_typeof(a))var v=a;else v=$(a).is(":checked");"kpttl"===e&&(v?$("#"+i).find(".kpiHeader").show():$("#"+i).find(".kpiHeader").hide(),updateTmpObjBeforeSave("attr","shwKpiTtl",v))}else if("exposeAPI"===e){if("object"!==_typeof(a))var v=a;else updateTmpObjBeforeSave("attr","exposeAPI",v=$(a).is(":checked"));if(v){$("#prpShtAPIuri").show();var g=apiBase;g+="public/"+i.substr(8),g+="?utl="+utls;var f=generateParamsStr("w"+i.substr(8));f&&(g+="&#38;params="+f),$("#prpApiURI").html(g),$("#prpShtAPIuriTr").show().removeClass("notSearchable")}else $("#prpApiURI").html(""),$("#prpShtAPIuriTr").hide().addClass("notSearchable")}}function generateParamsStr(e){if(console.log(widgetTableData[e]),widgetTableData[e]&&widgetTableData[e].sql){var a=widgetTableData[e].sql.match(/:\w+/g);console.log(a);var t="";if(a){a=a.filter(function(e,a,t){return a==t.indexOf(e)});for(var r=0;r<a.length;r++)t+=a[r].substring(1,a[r].length)+":",r+1!=a.length&&(t+="|");return t}return null}return null}function checkDataFound(e){if(0===e.length&&0===$("#widgetPanelWrapper .widgetWrapper:visible").length)return 0==$("#widgetPanelWrapper .noData").length?$("#widgetPanelWrapper").append('<p class="noData" style="text-align: center;">No data found</p>'):$("#widgetPanelWrapper .noData").show(),!1;$("#widgetPanelWrapper .noData").hide()}isValidPage?ajaxCallObj.getNLSparameter():redirectPage(!0),wizardObj.chartWizard={steps:4,ids:["chartSelData","queryData","appearanceData","roleSelctionData"],stepNames:["Chart Type","Source","Attributes","Authorization"],validateKeys:["chtType","query","attrs","rl"]},wizardObj.kpiWizard={steps:3,ids:["queryData","appearanceData","roleSelctionData"],stepNames:["Source","Attributes","Authorization"],validateKeys:["query","attrs","rl"]},wizardObj.iviewWizard={steps:4,ids:["iviewType","queryData","ivColData","ivParams"],stepNames:["Report Type","Source","Columns","Parameters"],validateKeys:["ivrt","query","ivcl","ivp"]},wizardObj.checkNxtPrevBtns=function(){var e=$("#wizardHeader .step").length,a=$("#wizardHeader .step.active").data("id");0==a?($("#wizardPrevbtn").attr("onclick","wizardObj.resetTheWizard()"),$("#wizardNextbtn").attr({onclick:"wizardObj.checkClick(this,'next')",title:"Next"}).show().html("Next &gt;")):a==e-1?($("#wizardPrevbtn").attr("onclick","wizardObj.checkClick(this,'prev')").show(),$("#wizardNextbtn").show().attr({onclick:"createJsonToSend()",title:"Create"}).html("Create")):($("#wizardPrevbtn").attr("onclick","wizardObj.checkClick(this,'prev')").show(),$("#wizardNextbtn").attr({onclick:"wizardObj.checkClick(this,'next')",title:"Next"}).show().html("Next &gt;"))},wizardObj.validateTheKey=function(e,a){return doTheValidations(wizardObj[e].validateKeys[a])},wizardObj.onWizardCreate=function(){if("iview"===widgetType){presWizardData.iviews={},presWizardData.extraData={};var e=presWizardData.iviews;e.s=sId,e.axpapp=mainProjName,e.gtotal="F",e.actmode="new",e.tasks=[{name:"Task1",txt:[{v:""}],type:"sql",rfld:""}],e.cols=[],e.hyperlinks=[],e.params=[],$("#widgetTTlWrpper").addClass("m6"),$("#widgetTTlWrpper label").html("Caption<sup>*</sup>"),$("#widgeIvNameWrpper").show()}},wizardObj.onWizardClose=function(){presWizardData={},$("#chartSelData").removeData("isCompleted"),$("#chartSelData").data("isCompleted",undefined),$("#widgetTitle,#chartYaxisLabel,#chartXaxisLabel,#iviewName").val(""),$("#shwLgnd").prop("checked",!0).attr("checked","checked"),$("#gradienChartInp").prop("checked",!1).removeAttr("checked"),$("#wizardNextbtn").attr({onclick:"wizardObj.checkClick(this,'next')",title:"Next"}).html("Next &gt;"),$("#chartSelData a.selected").data("cc",""),$("#chartSelData a.selected").removeData("cc"),$("#wtrFldsData").html(""),$("#sqlQry").click(),mainSqlCM&&mainSqlCM.getDoc().setValue(""),tableSqlCm&&tableSqlCm.getDoc().setValue(""),$("#chartSelData a.selected").removeClass("selected"),$("#widgetTstructName").data("key")&&($("#widgetTstructName").data("key",undefined).val("").removeClass("valSelected").removeData("key"),$("#widgetTstrctColumn").data("key",undefined).val("").removeData("key").removeClass("valSelected").prop("disabled",!0),$("#widgetTableRemData").hide(),selectedCols=[]),$("#widgetGroupsInp").data("key",undefined).val("").removeClass("valSelected").removeData("key"),$("#isValidSQl").removeClass("tableSqlFocussed"),$("button#multiselect_leftAll").trigger("click"),$("#iviewType").data("isComp","false"),$("#iviewType a.active").removeClass("active"),$("#widgetTTlWrpper").removeClass("m6"),$("#widgetTTlWrpper label").html("Title<sup>*</sup>"),$("#widgeIvNameWrpper").hide(),$(".ivEchPramWrapper").data("tmpIndex",undefined),$(document).off("keydown.ivColKdEvnt"),$("#iviewType .selectedIcon").remove(),Materialize.updateTextFields()},jQuery(document).ready(function($){$("#multiselect option:disabled").html(widgetMessages.noResponsibility),mainRestDllPath||$(".ivCreationRelated").hide(),$(callParentNew("developerbreadcrumbTitle","class")).text("Widget Builder"),$("#lblWidgetBuilder").text(callParentNew("lcm")[257]);var finalChartHtml="";for(var key in customChartColors){var presKeyArr=key.split("~"),keyCode=presKeyArr[0],keyName=presKeyArr[1]||keyCode;finalChartHtml+='<option value="'+keyCode+'">'+keyName+"</option>"}finalChartHtml+='<option value="custom">Custom</option>',$("#chartColorPicker #colorSelector .palletSelectFld").html('<select id="chartColorChangerSlctBx" onchange="chartColorChanger(\'colorPick\', this)" class="materialSelect">'+finalChartHtml+"</select>"),$("#wizardModal").modal({dismissible:!1,ready:function(e,a){materialModalEventsHandler("bind"),tabFocusEventHandler({task:"bind",parentId:"wizardModal",loopInsideParent:!0})},complete:function(){materialModalEventsHandler("unbind"),tabFocusEventHandler({task:"unbind",parentId:"wizardModal"}),wizardObj.resetTheWizard()}}),$("#sqlExData").on("click",function(e){var a=$(e.target);if(a.hasClass("chrtKpiEXAnchr")&&(a=a.find("p.chrtKpiEX")),a.hasClass("chrtKpiEX")){var t=a.html();t=t.replace(/<br>/g,"\n"),mainSqlCM.getDoc().setValue(t),mainSqlCM.focus()}}),$(".materialCollapsible").collapsible(),$("#chartSelData a").on("click",function(e){if(e.preventDefault(),presWizardData.isDirty=!0,!$(this).hasClass("selected")){var a=$("#chartSelData").data("isCompleted");$("#chartSelData a.selected").removeClass("selected"),$(this).addClass("selected"),1!=a?($("#chartSelData").data("isCompleted",!0),wizardObj.completeCurrentStep(),wizardObj.checkNxtPrevBtns()):$("#widgetTstructName").data("key")&&($("#widgetTstructName").data("key",undefined).val("").removeClass("valSelected").removeData("key"),$("#widgetTstrctColumn").data("key",undefined).val("").removeClass("valSelected").removeData("key").prop("disabled",!0),$("#widgetTableRemData").hide(),tableSqlCm&&tableSqlCm.getDoc().setValue(""),selectedCols=[])}}),$(".materialSelect").material_select(),$("#sqlExmpleBtn,#sqlEdtExmpleBtn").on("click",function(e){var a=$(this);a.next().slideToggle(),a.find(".arrwCls").toggleClass("icon-chevron-down icon-chevron-up")}),$("#prpShtAutoSave").on("change",function(){$(this).is(":checked")?$("#updateWidget,#refreshWidget").hide():$("#updateWidget,#refreshWidget").show()}),$("input[name='widgetSqlSource']").on("change",function(e){$("#wizardNextbtn").removeClass("validated"),"sql"==$(this).data("val")?($("#widgetSqlData").show(),$("#widgetTableData").hide(),mainSqlCM.focus()):($("#widgetSqlData").hide(),$("#widgetTableData").show(),$("#widgetTableData input:first").focus())}),wizardObj.onPageShow=function(e){if(tabFocusEventHandler({task:"bind",parentId:"wizardModal",loopInsideParent:!0}),"queryData"===e){if("chart"===widgetType){var a=getExampleData("chart",$("#chartSelData a.selected").data("type"));$("#sqlExData").html("<p class='chartExmplP'>"+a+"</p>")}else"kpi"===widgetType?$("#sqlExData").html(getExampleData("kpi")):"iview"===widgetType&&$("#sqlExData").html(getExampleData("iview"));$("#codeMirrorSql").hasClass("cdmrEdiSetted")?mainSqlCM.refresh():($("#codeMirrorSql").addClass("cdmrEdiSetted"),(mainSqlCM=CodeMirror.fromTextArea(document.getElementById("codeMirrorSql"),{mode:"text/x-sql",smartIndent:!0,lineNumbers:!0,matchBrackets:!0,extraKeys:{"Ctrl-Space":"autocomplete",Tab:!1,"Shift-Tab":!1},value:document.documentElement.innerHTML,hintOptions:{tables:codeMirrorHintObj}})).on("change",function(e,a){$("#wizardNextbtn").removeClass("validated")}),mainSqlCM.on("keyup",function(e,a){(!a.ctrlKey&&a.keyCode>=65&&a.keyCode<=90||a.keyCode>=97&&a.keyCode<=122||a.keyCode>=46&&a.keyCode<=57)&&CodeMirror.commands.autocomplete(e)}))}else if("appearanceData"===e)if("kpi"===widgetType)$("#appearanceData .apprData").hide(),$("#appearanceData div[data-showfor*='kpi']").show();else if("chart"===widgetType){$("#appearanceData .apprData").hide(),notOf="";var t=$("#chartSelData a.selected").data("type");"pie"!==t&&"semi-donut"!==t&&"donut"!==t||(notOf="#chartYaxisLabelWrapper,#chartXaxisLabelWrapper"),$("#appearanceData div[data-showfor*='chart']").not(notOf).show()}},$("#propertySearchFld").on("keyup",function(e){var elem=$(this),enteredVal=elem.val().toLowerCase(),cutMsg=eval(callParent("lcm[0]")),nodata='<tr class="noDatFoundTr"><td colspan="2" class="center">'+cutMsg+"</td></tr>";$("#propTableContent table tbody .noDatFoundTr").remove(),$("#propTableContent table tr:not('.notSearchable')").each(function(e,a){var t=$(this),r=t.find("td:first");""!=enteredVal&&r.hasClass("subHeading")?t.hide():-1===r.text().toLowerCase().indexOf(enteredVal)?t.hide():t.show()}),""!=elem.val()&&0==$("#propTableContent table tr:visible").length&&$("#propTableContent table tbody").append(nodata)}),$("#propertySheet").draggable({revert:!1,scroll:!1,appendTo:"body",containment:"window",handle:".hpbHeaderTitle",cursor:"move",start:function(e,a){$("#propertySheet").css("bottom","")}}),$("#propTableContent .propShtDataToggleIcon").on("click",function(e){var a=$(this),t=a.data("target");$("#propTableContent table tr[data-group='"+t+"']:not('.notSearchable')").toggle(),a.toggleClass("icon-chevron-up icon-chevron-down")}),$(document).on("click","#widgetPanelWrapper .widgetWrapper",function(e){var a=$(this);if(!validateProprtySht("onWdgtClick",a))return!1;if(a.hasClass("selectedForPropSht"))closeProprtySht();else{var t=a.data("id"),r=!1;$("#widgetPanelWrapper .widgetWrapper.selectedForPropSht").removeClass("selectedForPropSht"),a.addClass("selectedForPropSht");var i=widgetTableData["w"+t];if("chart"===(o=i.type)){var l=i.cType,s=chartExamples[l]||"";$("#sqlEdtExData").html(s),$("#sqlEdtExData,#sqlEdtExmpleBtn").hide()}else"kpi"===o&&$("#sqlEdtExData,#sqlEdtExmpleBtn").hide();var o=a.data("type"),n=a.attr("id"),d=i.title,c=i.sql,p=(i.roles,"kpi"==o&&a.find(".colorMe").data("kpicolor")),h=i.attr;h&&(h=JSON.parse(h)),clearPropertySheet();var u="table"===o.toLowerCase()?"kpi":o;if($("#prpShtComponent").text(u),$("#prpShtTitle").val(htmlEntity("decode",d)),$("#prpShtTxtBx").data("id",t).val(c),"iview"===o){$("#prpShtApprRelated").addClass("notSearchable").hide();var m=h.ivName||"";$("#prpShtIvName").val(m),$("#prpShtUpdateInfo").hide(),$("#propertySheet .prpSteIvRelated").removeClass("notSearchable").show(),$("#propertySheet .ivDisabledFld").prop("disabled",!0),$("#propertySheet .prpShtAuthRelated,.prpSteNonIvRelated,#chartColorPickerWrapper").addClass("notSearchable").hide()}else{for(var v=widgetTableData.allRoles,g=v.length,f="",w=0;w<g;w++)f+='<option selected title="'+v[w]+'" value="'+v[w]+'">'+v[w]+"</option>";0===g&&(f+="<option disabled >No Roles assigned</option>");var C=groups.length,b=i.grpName,y="";for(w=0;w<C;w++){var S=groups[w];if(S)y+="<option "+(S===b?"selected":"")+' title="'+S+'" value="'+S+'">'+S+"</option>"}$("#prpShtGrpWrapper select").html(y),$("#prpShtGrpWrapper select").material_select("destroy"),$("#prpShtGrpWrapper select").material_select(),$("#prpShtRoles").material_select("destroy"),i.roles?($("#prpShtRoles").val(i.roles),$("#prpShtRoles").material_select()):ajaxCallObj.getWidgetRoles(t,f);var x=i.cType;if(r=-1!==$.inArray(x,globalConfiguration.chart3D),"chart"===o){if($("#prpShtShwLgndWrapper,#chartColorPickerWrapper,#prpShtGradientChrtWrapper,#prpShtShwChrtValWrapper").removeClass("notSearchable").show(),h){h.shwLgnd?$("#prpShtShwLgnd").prop("checked",!0):$("#prpShtShwLgnd").prop("checked",!1),h.shwChartVal?$("#prpShtShwChrtVal").prop("checked",!0):$("#prpShtShwChrtVal").prop("checked",!1);var T=h.cck,k=h.cccv;T||(T="pallet1"),!h.gradClrChart||!0!==h.gradClrChart&&"true"!==h.gradClrChart?$("#prpShtGradientChrt").prop("checked",!1):$("#prpShtGradientChrt").prop("checked",!0)}else T="pallet1",k="";chartColorChanger("colorSet",T,k)}else $("#prpShtShwLgndWrapper,#chartColorPickerWrapper,#prpShtGradientChrtWrapper,#prpShtShwChrtValWrapper").addClass("notSearchable").hide();"chart"!==o||"semi-donut"!==x&&"pie"!==x&&"donut"!==x?$("#prpShtShwValFrPWrapper").addClass("notSearchable").hide():($("#prpShtShwValFrPWrapper").removeClass("notSearchable").show(),h&&h.shwVal?$("#prpShtShwValForPie").prop("checked",!0):$("#prpShtShwValForPie").prop("checked",!1)),r?($("#prpSht3DChrtWrapper").removeClass("notSearchable").show(),h&&"create"===h.threeD?$("#prpSht3DChrt").prop("checked",!0):$("#prpSht3DChrt").prop("checked",!1)):$("#prpSht3DChrtWrapper").addClass("notSearchable").hide()}openProprtySht(o,n),"kpi"===o?($("#prpShtkpiTtlWrapper").removeClass("notSearchable").show(),p&&(ChangePropertySheet("kpiWidgetClicked"),$("#gradientPicker").attr("class","colorMe "+p+" center-align"),$("#gradientPicker a").data("color",p).text(p)),h&&h.shwKpiTtl?$("#prpShtshwKpiTtl").prop("checked",!0):$("#prpShtshwKpiTtl").prop("checked",!1)):$("#prpShtkpiTtlWrapper").addClass("notSearchable").hide(),"kpi"!==o&&"chart"!==o||(h&&h.exposeAPI?($("#prpShtAPIswitch").prop("checked",!0),chnageKpiChartView("exposeAPI",!0,"exposeAPI")):($("#prpShtAPIswitch").prop("checked",!1),chnageKpiChartView("exposeAPI",!1,"exposeAPI")))}}),$("#mainSearchFld").keydown(function(e){closeProprtySht()||e.preventDefault()}),$("#mainSearchFld").keyup(function(e){if(9!==e.keyCode){dataTableApi||createGridDatatble();var a=$(this).val();dataTableApi.search(a).draw(),$(".widgetWrapper").hide();var t=dataTableApi.row().context[0].aiDisplay;if("widget"===presentView){for($(".pagination-wrapper").createAxPagination("destroy"),$(".widgetWrapper").hide(),i=0;i<t.length;i++)$("#axWidget"+dataTableApi.row(t[i]).data().id).show();createPagination()}else $("#gridWdgtToggleBtn").addClass("changesAvailable");checkDataFound(t)}}),$("#matcolumnSearch li").click(function(e){dataTableApi||createGridDatatble(),$("#mainSearchFld").val("");var a=$(this).data("id"),t=$("#matcolumnSrchBtn").text();if(a.toLowerCase()===t.toLowerCase())return!1;$("#matcolumnSrchBtn").removeClass("active").text(a).attr("title","Search "+a),a=a.toLowerCase(),dataTableApi.column(2).search("all"!=a?"^"+a+"$":"",!0,!1).draw(),"widget"===presentView?($(".pagination-wrapper").createAxPagination("destroy"),$(".widgetWrapper").hide(),"all"===a.toLowerCase()?($(".widgetWrapper").show(),createPagination()):("table"===a?$(".widgetWrapper[data-type='kpi'],.widgetWrapper[data-type='table']").show():$(".widgetWrapper[data-type='"+a.toLowerCase()+"']").show(),createPagination())):($("#gridWdgtToggleBtn").addClass("changesAvailable"),$("#matcolumnSearch").addClass("clicked")),checkDataFound(dataTableApi.row().context[0].aiDisplay)})}),$(document).on("click",".cardTitleClear",function(e){e.stopPropagation(),createConfirmBox("deleteWidget","Are you sure you want to delete?",$(this).parents(".widgetWrapper").data("id"))}),$("input#widgetTstrctColumn,#widgetTstructName").on("keyup",function(e){if(e.which<=111&&e.which>=48||8==e.which||46==e.which||e.which>=186&&e.which<=192||e.which>=219&&e.which<=222){var a=$(this);a.removeData("key"),a.data("key",undefined),"widgetTstructName"===a.attr("id")?($("#widgetTableRemData").hide(),$("#widgetTstrctColumn").data("key",undefined).val("").removeClass("valSelected").removeData("key").prop("disabled",!0)):(tableSqlCm&&tableSqlCm.getDoc().setValue(" "),$("#widgetTableRemData").hide(),selectedCols=[])}}),$("#prpShtRoles").change(function(){var e=$("#prpShtRoles").val();""==(e=e.toString())&&showAlertDialog("warning","select atleast one!"),updateTmpObjBeforeSave("rty","rty",e)});