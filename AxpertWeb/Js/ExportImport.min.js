/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function AddNewCondition(){var dv=document.getElementById("tblFilter"),curntRow=$j("#tblFilter tr").length+1,rowCount="0",rowCnt=document.getElementById("FilterRowCount");rowCnt&&(rowCount=rowCnt.value);var index=(parseInt(rowCount)+1).toString(),newRow=dv.appendChild(document.createElement("tr")),ocell=newRow.insertCell();ocell.className="radio d-flex px-2 pt-4";var el=document.createElement("input");el.type="radio",el.name="grpAndOr"+index,el.id="radAnd"+index,el.className="form-check-input",el.value="And";var el1=document.createElement("input");el1.type="radio",el1.name="grpAndOr"+index,el1.id="radOr"+index,el1.className="form-check-input",el1.value="Or",ocell.appendChild(el);var spn=document.createElement("span");spn.className="d-flex align-content-center flex-wrap px-2",spn.innerText="And",ocell.appendChild(spn),ocell.appendChild(el1),spn=document.createElement("span"),spn.className="d-flex align-content-center flex-wrap px-2",spn.innerText="Or",ocell.appendChild(spn),ocell.style.align="right";var rad=document.getElementById("radOr"+index);rad&&(rad.checked=!0),index=(parseInt(index)+1).toString();var cell=newRow.insertCell();cell.className="px-2";var ddlClm=document.createElement("select");ddlClm.id="ddlFilter"+index,ddlClm.className="lblTxt form-select",ddlClm.style.maxWidth="250px",ddlClm.style.minWidth="150px",cell.appendChild(ddlClm),$("#ddlFilter"+index).select2();var ddlFilter=document.getElementById("ddlFilter"+index);if(ddlFilter.length=0,ddlFilter){var parDll=document.getElementById("ddlFilter");if(parDll.length>0)for(var i=0;i<parDll.length;i++){var opt=document.createElement("option");opt.text=parDll.options[i].text,opt.value=parDll.options[i].value,$(parDll.options[i]).attr("date-field")!=undefined&&opt.setAttribute("date-field",!0),ddlFilter.options.add(opt)}}cell=newRow.insertCell(),cell.className="px-2";var ddlOpr=document.createElement("select");ddlOpr.id="ddlOpr"+index,ddlOpr.className="lblTxt form-select",ddlOpr.setAttribute("onchange","CheckFilterCond("+index+")"),cell.appendChild(ddlOpr),$("#ddlOpr"+index).select2();var ddlOperator=document.getElementById("ddlOpr"+index);if(ddlOperator.length=0,ddlOperator){var parOpr=document.getElementById("ddlFilcond");if(parOpr.length>0)for(var i=0;i<parOpr.length;i++){var opt=document.createElement("option");opt.text=parOpr.options[i].text,opt.value=parOpr.options[i].value,ddlOperator.options.add(opt)}}$("#ddlOpr"+index+",#ddlFilter"+index).change(function(){condition=$("#ddlOpr"+index).val(),filterIds="between"==condition?"#txtFilter"+index+", #txtFillVal"+index:"#txtFilter"+index,filter=$("#ddlFilter"+index+" :selected").attr("date-field"),filter!=undefined?$(filterIds).datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0}).attr("placeholder","dd/mm/yyyy").on("change",function(e){filter!=undefined&&null==validateDate($(this).val())&&$(this).focus()}):$(filterIds).datepicker("destroy").attr("placeholder","").val("")}),cell=newRow.insertCell(),cell.className="px-2";var inpVal1=document.createElement("input");inpVal1.type="text",inpVal1.id="txtFilter"+index,inpVal1.className="lblTxt form-control",inpVal1.style.width="100px",inpVal1.maxLength="1024",cell.appendChild(inpVal1),cell=newRow.insertCell(),cell.className="px-2";var inpVal1=document.createElement("input");inpVal1.type="text",inpVal1.id="txtFillVal"+index,inpVal1.className="lblTxt form-control",inpVal1.style.width="100px",inpVal1.maxLength="1024",inpVal1.disabled="disabled",cell.appendChild(inpVal1),cell=newRow.insertCell(),cell.className="px-2";var anc=document.createElement("a");anc.id="delAnc"+index,anc.href="javascript:DeleteCondition('"+index+"');",anc.className="ancLink";var delImg=document.createElement("span");delImg.setAttribute("class","curHand icon-arrows-circle-minus"),delImg.id="delCond"+index,delImg.title=eval(callParent("lcm[187]")),delImg.innerText="Remove",anc.appendChild(delImg),cell.appendChild(anc),rowCnt.value=index}function ConvertToExprStr(e,t,l,a){return"between"==t.toLowerCase()?"$$"+e+"$$"+CheckSpecialCharsInXml(t)+"$$"+CheckSpecialCharsInXml(l)+"$$"+CheckSpecialCharsInXml(a):"$$"+e+"$$"+CheckSpecialCharsInXml(t)+"$$"+CheckSpecialCharsInXml(l)+"$$"}function ConvertToExprDispStr(e,t,l,a){e=e.substring(e.indexOf("(")+1,e.indexOf(")"));return"between"==t.toLowerCase()?"("+e+")"+t+"("+l+","+a+")":"("+e+")"+t+"("+l+")"}function SaveCondition(){var e="";$("#mSelectRight option").each(function(){e+=$(this).val()+", "}),e=e.substring(0,e.length-2),$("#hdnColValues").val(e),$j("#hdnCondString").val("");var t=document.getElementById("tblFilter");rowCount=t.rows.length;for(var l="",a="",n="",d=0,i=0;i<=2*rowCount;i++){if(0==i)var r=document.getElementById("ddlFilter"),o=document.getElementById("ddlFilcond"),c=document.getElementById("txtFilter"),s=document.getElementById("filVal2");else{if(i%2==0)r=document.getElementById("ddlFilter"+i),c=document.getElementById("txtFilter"+i),s=document.getElementById("txtFillVal"+i),o=document.getElementById("ddlOpr"+i);if(i>0){var p="grpAndOr"+i;if(a=document.getElementsByName(p))for(var u=0;u<a.length;u++)a[u].checked&&(n=a[u].value)}}var m=$("#"+$(r).attr("id")+" :selected").attr("date-field");if(0==i){if(0==r.selectedIndex||0==o.selectedIndex||""==c.value||m!=undefined){if(0==rowCount&&0==r.selectedIndex&&0==o.selectedIndex&&""==c.value)return!0;if(0==r.selectedIndex)return r.focus(),showAlertDialog("warning",1024,"client"),!1;if(0==o.selectedIndex)return o.focus(),showAlertDialog("warning",1024,"client"),!1;if(""==c.value)return c.focus(),showAlertDialog("warning",1024,"client"),!1;if(m!=undefined&&null==validateDate(c.value))return c.focus(),!1}if(0!=r.selectedIndex&&0!=o.selectedIndex&&""!=c.value&&"between"==o[o.selectedIndex].value){if(""==s.value)return s.focus(),showAlertDialog("warning",1024,"client"),!1;if(m!=undefined){if(null==validateDate(c.value))return c.focus(),!1;if(null==validateDate(s.value))return s.focus(),!1;if(!validateDateRange(c.value,s.value))return showAlertDialog("warning","Please select a valid date range"),c.focus(),!1}}}var v=r.value,h=(r[r.selectedIndex].text,o.value,c.value),x=s.value,f=o[o.selectedIndex].value;if("between"==f&&0!=r.selectedIndex&&0!=o.selectedIndex&&""!=c.value){if(""==s.value)return s.focus(),showAlertDialog("warning",1024,"client"),!1;if(m!=undefined){if(null==validateDate(c.value))return c.focus(),!1;if(null==validateDate(s.value))return s.focus(),!1;if(!validateDateRange(c.value,s.value))return showAlertDialog("warning","Please select a valid date range"),c.focus(),!1}}if(0==r.selectedIndex||0==o.selectedIndex||""==c.value){if(0==r.selectedIndex)return r.focus(),showAlertDialog("warning",1024,"client"),!1;if(0==o.selectedIndex)return o.focus(),showAlertDialog("warning",1024,"client"),!1;if(""==c.value)return c.focus(),showAlertDialog("warning",1024,"client"),!1}else if(m!=undefined){if(null==validateDate(c.value))return c.focus(),!1;if("between"==f&&""!=c.value&&""==s.value)return s.focus(),showAlertDialog("warning",1024,"client"),!1}0!=i&&i%2!=0||(""==l?(l+="<l"+ ++d+">",l+=ConvertToExprStr(v,f,h,x)):(l+="</l"+(++d-1)+">",l+="<l"+d+">","Or"==n?l+="or":"And"==n&&(l+="and"),l+=ConvertToExprStr(v,f,h,x)))}var b="<cond>"+(l+="</l"+d+">")+"</cond>";return $j("#hdnCondString").val(b),!0}function CheckSpecialCharsInXml(e){return e=(e=(e=(e=(e=(e=e).replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")}function DeleteCondition(e){e%2!=0&&(e=parseInt(e)+1);for(var t=$j("#tblFilter tr").length,l=e;l<2*t;l++){var a=parseInt(l)+2,n=parseInt(a)-1,d=parseInt(l)-1;$j("#ddlFilter"+l).val($j("#ddlFilter"+a).val()),0==$j("#ddlOpr"+l).length?$j("#ddlFilcond"+l).val($j("#ddlFilcond"+a).val()):$j("#ddlOpr"+l).val($j("#ddlOpr"+a).val()),$j("#txtFilter"+l).val($j("#txtFilter"+a).val()),$j("#txtFillVal"+l).val($j("#txtFillVal"+a).val()),$j("#radAnd"+n).is(":checked")?$j("#radAnd"+d).prop("checked",!0):$j("#radOr"+d).prop("checked",!0)}var i=document.getElementById("FilterRowCount");i&&(i.value-=2),document.getElementById("tblFilter").deleteRow(t-1)}function CheckFilterCond(e){if(-1==e){var t=document.getElementById("ddlFilcond"),l=document.getElementById("filVal2");"between"==t.value?l.disabled=!1:(l.disabled=!0,l.value="",l.setAttribute("placeholder",""))}else{var a=$j("#"+("ddlOpr"+e)).val(),n="txtFillVal"+e,d=document.getElementById(n);"between"==a?d.disabled=!1:(d.value="",d.disabled=!0,d.setAttribute("placeholder",""))}}function EnableSeparator(){var e=$j("#ddlExFileType").find("option:selected").text();("Text"==e?($j("#ddlExSeparator").removeAttr("disabled"),$j("#ddlExSeparator").prop("selectedIndex",3),$("#ddlExSeparator").trigger("change")):($j("#ddlExSeparator").attr("disabled","disabled"),$j("#ddlExSeparator").prop("selectedIndex",0)),"Excel"!=e&&"CSV"!=e?($j("#chkExWithQuotes").prop("checked",!1),$j("#chkExWithQuotes").removeAttr("disabled"),$j("#chkExWithQuotes").parent().removeAttr("disabled")):("CSV"==e&&($j("#ddlExSeparator").prop("selectedIndex",1),$("#ddlExSeparator").trigger("change")),$j("#chkExWithQuotes").prop("checked",!1),$j("#chkExWithQuotes").attr("disabled","disabled")),""!=e)?($j("#txtExpFileName").removeAttr("disabled"),SetFileType($j("#txtExpFileName").val(),e)):$j("#txtExpFileName").attr("disabled","disabled")}function ShowCondition(){"+"==$j("#btnShowCond").val()?($j("#dvCondition").show(),$j("#trCondition").show(),$j("#btnShowCond").val("-"),FillCondFields()):($j("#dvCondition").hide(),$j("#trCondition").hide(),$j("#btnShowCond").val("+"))}function FillCondFields(){if($j("#ddlFilter > option").length<1){for(var e=$j("#txtExFields").val().split(","),t=new Array,l=0;l<e.length;l++){var a=e[l],n=$j.inArray(a,arrFlds);if(-1!=n){var d=arrFldDcNo[n];-1==$j.inArray(d,t)&&t.push(d)}}new Array;var i=$j("#ddlFilter"),r="<option></option>";i.append(r);for(var o=0;o<arrFlds.length;o++)if(-1!=$j.inArray(arrFldDcNo[o],t)&&"F"==arrIsDc[o]){r="<option>"+arrFlds[o]+"</option>";i.append(r)}}}function GetIndex(e,t){var l=-1;return $j.each(t,function(e,a){if(null==l&&a.toLowerCase().trim().equals(t[e].toLowerCase().trim()))return l=e,!1}),l}function DisChks(){var e=$j("#txtExpFileName").val(),t=$j("#ddlExFileType").find("option:selected").text();""!=e?($j("#chkWithHeader").removeAttr("disabled"),$j("#chkWithHeader").parent().removeAttr("disabled"),"Excel"!=t&&"CSV"!=t&&($j("#chkExWithQuotes").removeAttr("disabled"),$j("#chkExWithQuotes").parent().removeAttr("disabled")),$j("#btnExport").removeAttr("disabled"),SetFileType(e,t),""!=$j("#lblExError").text()&&$j("#btnExport").attr("disabled","disabled")):($j("#chkWithHeader").attr("disabled","disabled"),$j("#chkExWithQuotes").prop("checked",!1),$j("#chkExWithQuotes").attr("disabled","disabled"),$j("#btnExport").attr("disabled","disabled"))}function SetFileType(e,t){-1!=e.indexOf(".")&&(e=e.substring(0,e.lastIndexOf("."))),""!=e&&-1==e.indexOf(".")&&("Text"==t?e+=".txt":"Excel"==t?e+=".xlsx":"CSV"==t&&(e+=".csv"),$j("#txtExpFileName").val(e))}function ValidateSep(){""==$j("#ddlImSeparator").val()?$j("#btnImport").attr("disabled","disabled"):$j("#btnImport").removeAttr("disabled")}function EnableMapFlds(){if(""!=$j("#upImpFile").val()){var e=$j("#upImpFile").val(),t=e.substring(e.lastIndexOf(".")+1);"txt"==t?($j("#ddlImSeparator").removeAttr("disabled"),$j("#btnImport").attr("disabled","disabled")):($j("#ddlImSeparator").attr("disabled","disabled"),$j("#btnImport").removeAttr("disabled")),"xlsx"==t||"xls"==t?($j("#chkImWithQuotes").attr("disabled","disabled"),$j("#chkImWithQuotes").parent().attr("disabled","disabled")):($j("#chkImWithQuotes").removeAttr("disabled"),$j("#chkImWithQuotes").parent().removeAttr("disabled")),$j("#txtImFields").removeAttr("disabled"),$j("#chkInFile").removeAttr("disabled"),$j("#chkInFile").parent().removeAttr("disabled")}else $j("#txtImFields").attr("disabled","disabled"),$j("#chkInFile").attr("disabled","disabled"),$j("#chkImWithQuotes").attr("disabled","disabled")}function DisMapFlds(){1==$j("#chkInFile").prop("checked")?($j("#hdnMapFields").val($j("#txtImFields").val()),$j("#txtImFields").val(""),$j("#txtImFields").attr("disabled","disabled")):($j("#txtImFields").removeAttr("disabled"),$j("#txtImFields").val($j("#hdnMapFields").val()),""==$j("#txtImFields").val()?$j("#btnImport").attr("disabled","disabled"):$j("#btnImport").removeAttr("disabled"))}function ShowDates(){var e=$j("#rbtnType").val();"Date"==e?$j("#dvDate").show():(e="Date Range")?$j("#dvRange").show():($j("#dvDate").hide(),$j("#dvRange").hide())}function SetExType(){1==$j("#chkExWithQuotes").prop("checked")?($j("#ddlExSeparator").val(","),$j("#ddlExSeparator").attr("disabled","disabled")):($j("#ddlExSeparator").val(""),$j("#ddlExSeparator").removeAttr("disabled"))}function ValSelectCondition(){var ddl=0,multiselect=0;if("NA"==$("#ddlExTstruct").val())return showAlertDialog("warning",eval(callParent("lcm[106]"))),!0;if(ddl=1,null==$("#mSelectLeft").val())return showAlertDialog("warning",eval(callParent("lcm[108]"))),$("#mSelectLeft").focus(),!0;if(!($("#mSelectRight option").val()!=undefined&&$("#mSelectRight option").val().length>0))return $("#hdnColValues").val(""),showAlertDialog("warning",eval(callParent("lcm[108]"))),$("#mSelectLeft").focus(),!0;multiselect=1;var temp="";$("#mSelectRight option").each(function(){temp+=$(this).val()+", "}),temp=temp.substring(0,temp.length-2),$("#hdnColValues").val(temp)}function ClickExportBtn(){var FileType=0,FileName=0;return""!=$("#ddlExFileType").val()?FileType=1:showAlertDialog("warning",eval(callParent("lcm[107]"))),""!=$("#txtExpFileName").val()?FileName=1:showAlertDialog("warning",eval(callParent("lcm[110]"))),1==FileType&&1==FileName||(0==FileType&&$("#ddlExFileType").focus(),0==FileName&&$("#txtExpFileName").focus(),!1)}function SetDefaultFileName(){var e=$("#ddlExTstruct :selected").text(),t=$("#ddlExFileType").val();e.substring(0,e.indexOf("(")).replace(/[^a-z0-9]+/gi,"");$("#txtExpFileName").val(e),$("#ddlExFileType").focus(),SetFileType(e,t)}function checkForValuesChanged(e){var t=!1;$(e).parents(".wizardValidation").find(".forValidation").each(function(){""==$(this).val()&&(t=!0)}),t?($("#Expli2").attr("class","disabled").prop("disabled",!0),$("#Expli2 a span").addClass("class","disabled").prop("disabled",!0),$("#Expli3").attr("class","disabled").prop("disabled",!0),$("#Expli3 a span").addClass("class","disabled").prop("disabled",!0),$("#li4").attr("class","disabled").prop("disabled",!0),$("#li4  a span").addClass("class","disabled").prop("disabled",!0)):($("#Expli2").removeClass("disabled").prop("disabled",!1),$("#Expli2 a span").removeClass("disabled").prop("disabled",!1),$("#Expli3").removeClass("disabled").prop("disabled",!1),$("#Expli3 a span").removeClass("disabled").prop("disabled",!1)),"-- Select --"!=$("#ddlExTstruct").val()&&SetDefaultFileName()}function ClearFirstRow(){$("#txtFilter, #ddlFilcond, #filVal2").val("").attr("placeholder",""),$("#ddlFilter").val("NA"),$("#filVal2").attr("disabled",!0),$("#tblFilter tr").remove()}function ForIconClickComplete(){return!!ClickExportBtn()&&(ShowDimmer(!0),$("#btnExport").click(),!0)}function ShowDimmer(e){DimmerCalled=!0;var t=$j("#waitDiv");if(t.length>0&&t!=undefined)if(1==e){var l=$j("#middle1",parent.document);l&&t.width(l.width()),t.show(),document.onkeydown=function(){return!1}}else t.hide(),document.onkeydown=function(){if(1==DimmerCalled)return!0};else window.opener!=undefined&&(t=$j("#waitDiv",window.opener.document)).length>0&&(1==e?t.show():t.hide());DimmerCalled=!1}function closeWindow(){checkIfFormChanges()?ConfirmLeave():parent.closeModalDialog()}$(document).ready(function(){var e=document.querySelector("#kt_stepper_example_clickable"),t=new KTStepper(e);t.on("kt.stepper.click",function(e){e.stepped&&e.goTo(e.getClickedStepIndex())}),t.on("kt.stepper.next",function(e){if(1==e.getCurrentStepIndex())return ValSelectCondition()?void 0:void e.goNext();if(2==e.getCurrentStepIndex()&&SaveCondition())return void e.goNext();3==e.getCurrentStepIndex()&&(ClickExportBtn()&&(e.goNext(),$(".card-footer").addClass("d-none"),$("#btnExport").click(),ShowDimmer(!0)))}),t.on("kt.stepper.previous",function(e){e.goPrevious()}),t.on("kt.stepper.changed",function(){}),ShowDimmer(!1),$("#ddlExTstruct").select2(),$("#ddlExFileType").select2(),$("#ddlExSeparator").select2()}),$(document).on("keydown",".checkForSpecialCharacters",function(){if(16!=event.keyCode){$.inArray(event.key,["!","@","#","%","$","^","*","+","=","{","}",":",";",'"',"<",">","?","/","|","\\","[","]","_","`","~","&","."])>-1&&event.preventDefault()}});var isFormDirty=!1;function checkIfFormChanges(){var e=$("#ddlExTstruct").val();return isFormDirty="NA"!=e}function wizardTabFocus(firstFocusId,lastFocusId,bootstrapSelect){modalButton=eval(callParent("btnModalClose","id")+".getElementById('btnModalClose')"),-1==modalButton.className.indexOf("firstFocusable")&&(modalButton.className+=" firstFocusable"),$("#"+lastFocusId).addClass("lastFocusable"),$(".lastFocusable").on("keydown.tabRot",function(e){9!==e.which||e.shiftKey||(e.preventDefault(),modalButton.focus())}),modalButton.addEventListener("keydown",function(e){9===e.which&&e.shiftKey&&(e.preventDefault(),$(".lastFocusable").focus())}),setTimeout(function(){bootstrapSelect==undefined?$("#"+firstFocusId).focus():"NA"==$("#ddlExTstruct").val()?$("#ddlExTstruct").data("selectpicker").$button.focus():$("#mSelectLeft").focus()},500)}function ConfirmLeave(){if($(".jconfirm").length>0)$(".jconfirm").remove();else{var glType=eval(callParent("gllangType")),isRTL=!1;isRTL="ar"==glType;var ConfirmSaveCB=$.confirm({theme:"modern",title:eval(callParent("lcm[155]")),onContentReady:function(){disableBackDrop("bind"),$(".jconfirm-buttons button").each(function(){var e=$(this).text();$(this).prop("title",e.charAt(0).toUpperCase()+e.slice(1))})},rtl:isRTL,backgroundDismiss:"false",escapeKey:"buttonB",content:eval(callParent("lcm[111]")),buttons:{buttonA:{text:eval(callParent("lcm[164]")),btnClass:"btn btn-primary",action:function(){ConfirmSaveCB.close(),parent.closeModalDialog(),parent.checkIfAnyActionPerformed()}},buttonB:{text:eval(callParent("lcm[192]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy"),parent.actionsClicked=""}}}})}}function validateDateRange(e,t){var l=/(\d{2})\/(\d{2})\/(\d{4})/;return new Date(e.replace(l,"$3-$2-$1"))<=new Date(t.replace(l,"$3-$2-$1"))}function validateDate(e){try{return new Date(e.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1"))}catch(t){return showAlertDialog("warning",2044,"client"),null}}var expWizardObj=[];$(document).ready(function(){var placement;$("#icocl1").attr("data-content",eval(callParent("lcm[180]"))),$("#icocl2").attr("data-content",eval(callParent("lcm[175]"))),$("#icocl3").attr("data-content",eval(callParent("lcm[182]"))),$("#icocl4").attr("data-content",eval(callParent("lcm[183]"))),$("#icocl5").attr("data-content",eval(callParent("lcm[184]"))),$("#icocl6").attr("data-content",eval(callParent("lcm[185]"))),$("#icocl7").attr("data-content",eval(callParent("lcm[186]"))),"ar"===parent.gllangType?($("#wizardWrappper").addClass("rtlLanguage"),placement="left"):($("#wizardWrappper").removeClass("rtlLanguage"),placement="right"),$('[data-toggle="popover"]').popover({placement:placement}),$("#right_All_1").prop("title",eval(callParent("lcm[171]"))).addClass("ar"===parent.gllangType?"fa-angle-double-left":"fa-angle-double-right"),$("#right_Selected_1").prop("title",eval(callParent("lcm[172]"))).addClass("ar"===parent.gllangType?"fa-angle-left":"fa-angle-right"),$("#left_Selected_1").prop("title",eval(callParent("lcm[173]"))).addClass("ar"===parent.gllangType?"fa-angle-right":"fa-angle-left"),$("#left_All_1").prop("title",eval(callParent("lcm[174]"))).addClass("ar"===parent.gllangType?"fa-angle-double-right":"fa-angle-double-left"),$("#wizardPrevbtn").prop("title",eval(callParent("lcm[163]"))).html("<span class='material-icons'>skip_previous</span><span class='wizard-icon'>"+eval(callParent("lcm[163]"))+"</span>"),$("#wizardNextbtn").prop("title",eval(callParent("lcm[162]"))).html("<span class='material-icons'>skip_next</span><span class='wizard-icon'>"+eval(callParent("lcm[162]"))+"</span>"),$("#wizardCompbtn").prop("title",eval(callParent("lcm[165]"))).html("<span class='material-icons'>thumb_up</span><span class='wizard-icon'>"+eval(callParent("lcm[165]"))+"</span>"),$("#wizardCancelbtn").prop("title",eval(callParent("lcm[192]"))).html("<span class='material-icons'>close</span><span class='wizard-icon'>"+eval(callParent("lcm[192]"))+"</span>"),"ar"==parent.gllangType&&$(".checkbox-inline input[type='checkbox']").siblings().addClass("rtl-label-checkbox"),$("#btnAddNew").attr("title",eval(callParent("lcm[188]"))),$("#clearCond").attr("title",eval(callParent("lcm[187]"))),$(".multiselect").multiselect({sort:!0}),$(".checkForEnter").keypress(function(e){13==e.keyCode&&e.preventDefault()}),$(document).on("keydown","input[type='text'],input[type='radio'],input[type='checkbox']",function(e){13==e.keyCode&&e.preventDefault()}),$("#ddlExFileType").val("CSV"),$("#ddlExSeparator").val(","),ClearFirstRow(),checkSuccessAxpertMsg(),$("#btnnext").attr("disabled",!0),$("body").on("click",function(e){$("[data-toggle=popover]").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")})}),$("body").on("hidden.bs.popover",function(e){$(e.target).data("bs.popover").inState.click=!1}),$("#ddlExTstruct").change(function(){ShowDimmer(!0)}),$("#ddlFilcond, #ddlFilter").change(function(){condition=$("#ddlFilcond").val(),filterIds="between"==condition?"#txtFilter, #filVal2":"#txtFilter",filter=$("#ddlFilter :selected").attr("date-field");try{filter!=undefined?$(filterIds).datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0}).attr("placeholder","dd/mm/yyyy").on("change",function(e){filter!=undefined&&null==validateDate($(this).val())&&$(this).focus()}):$(filterIds).datepicker("destroy").attr("placeholder","").val("")}catch(e){}});var dateFields=$("#hdnDateFields").val().split(",");if(dateFields.length>0){var captured=[];$("#ddlFilter option").each(function(){for(var e=0;e<dateFields.length;e++){$(this).val()==dateFields[e]&&$(this).attr("date-field",!0)}})}expWizardObj.assignEvents=function(){$("#wizardHeader .node,#wizardHeader a.stepName").on("click",function(e){e.preventDefault();var t=$(this);expWizardObj.checkClick(t)})},expWizardObj.checkClick=function(e,t){var l=(c=$("#wizardHeader .step.active")).data("id"),a=c.data("objtype");if("next"==t){var n=expWizardObj.validateTheKey(a,l);if((n||c.hasClass("complete")&&n)&&"next"==t){var d=c.next();c.hasClass("complete")?(c.removeClass("active"),d.addClass("active")):(c.addClass("complete").removeClass("in-progress active"),d.addClass("in-progress active"));var i=d.data("objtype"),r=expWizardObj[i].ids[d.data("id")];expWizardObj.showActiveData(r),expWizardObj.checkNxtPrevBtns(),l+1==expWizardObj.exportDataWizard.steps-1&&d.addClass("complete")}}else if("prev"==t){c.removeClass("active");var o=c.prev();o.addClass("active");i=o.data("objtype"),r=expWizardObj[i].ids[o.data("id")];expWizardObj.showActiveData(r),expWizardObj.checkNxtPrevBtns()}else{var c;if(!(c=e.parents(".step")).hasClass("active")&&(c.hasClass("complete")||c.hasClass("in-progress"))){$("#wizardHeader .step.active").removeClass("active");var s=c.addClass("active").data("target");expWizardObj.showActiveData(s),expWizardObj.checkNxtPrevBtns()}}},expWizardObj.showActiveData=function(e){$(".wizardContainer").hide(),$("#"+e).show()},expWizardObj.checkNxtPrevBtns=function(){var e=$("#wizardHeader .step").length,t=$("#wizardHeader .step.active").data("id");0==t&&wizardTabFocus("ddlExTstruct","wizardNextbtn",!0),1==t?wizardTabFocus("ddlFilter","wizardNextbtn"):2==t&&wizardTabFocus("ddlExFileType","wizardNextbtn"),0==t?($("#wizardPrevbtn, #wizardCompbtn").hide(),$("#wizardNextbtn").show(),$("#mSelectLeft option, #mSelectRight option").prop("selected",!1)):t==e-1?($("#wizardPrevbtn").show(),$("#wizardNextbtn").hide(),$("#wizardCompbtn").show().click(function(){parent.closeModalDialog()})):($("#wizardPrevbtn, #wizardNextbtn").show(),$("#wizardCompbtn").hide())},expWizardObj.validateTheKey=function(objct,key){var presentObj=expWizardObj[objct],validateKeys=presentObj.validateKeys,validateKeyName=validateKeys[key];if(""==validateKeyName)return!0;if("data-select"==validateKeyName)return ValSelectCondition();if("data-filter"==validateKeyName){var resultForNxtClick=SaveCondition();return!!resultForNxtClick&&($("#ddlExFileType").focus(),!0)}if("data-export"==validateKeyName){var result=ClickExportBtn();return!!result&&($("#nextbtn").click(),$("#btnExport").click(),ShowDimmer(!0),$("#lblSuccess").text(eval(callParent("lcm[234]"))),$("#lnkExpFile").text(""),$("#anchComplete").attr("class","fromExportComplete"),!0)}},$("#wizardWrappper .stepName").each(function(){$(this).prop("title",$(this).text()),$(this).next().prop("title",$(this).text())})});