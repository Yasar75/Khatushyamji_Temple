/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var spObject;document.onreadystatechange=function(){if("interactive"===document.readyState){var e=findGetParameter("pageid");try{$.ajax({url:"standardPage.aspx/GetStandardPages",type:"POST",cache:!1,async:!0,data:JSON.stringify({name:e}),dataType:"json",contentType:"application/json",success:function(e){var t,o,n,i,r=e.d;"success"==(null===(t=r)||void 0===t?void 0:t.status)?(r=JSON.parse(null===(o=r)||void 0===o?void 0:o.result),(spObject=new initObject(JSON.parse((null===(n=r.result.row)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:i.spsavejson)||"{}"))).setPageCaption(),spObject.setPanelVisibility(),spObject.getSetData(),spObject.injectCode()):showAlertDialog("error",r.result)},error:function(e){}})}catch(t){}}};var initObject=function(){function e(t){var o,n,i,r,l,a,d,s,c,u,v,h,f,b,m,y;_classCallCheck(this,e),this.properties=(null===(o=this.getSelector(t,"properties"))||void 0===o?void 0:o[0])||{},this.files=(null===(n=this.getSelector(t,"files"))||void 0===n?void 0:n[0])||{},this.caption={div:document.getElementById("sp-caption"),content:this.getSelector(this.properties,"caption")||""},this.params=(null===(i=this.getSelector(t,"params"))||void 0===i?void 0:i[0])||"",this.sections=(null===(r=this.getSelector(t,"sections"))||void 0===r?void 0:r[0])||{},this.headerPanelObj={div:document.getElementById("sp-header"),obj:(null===(l=this.getSelector(this.sections,"header"))||void 0===l?void 0:l[0])||{}},this.footerPanelObj={div:document.getElementById("sp-footer"),obj:(null===(a=this.getSelector(this.sections,"footer"))||void 0===a?void 0:a[0])||{}},this.bodyPanelObj={div:document.getElementById("sp-body"),obj:(null===(d=this.getSelector(this.sections,"body"))||void 0===d?void 0:d[0])||{}},this.leftPanelObj={div:document.getElementById("sp-left"),obj:(null===(s=this.getSelector(this.bodyPanelObj.obj,"panel.left"))||void 0===s?void 0:s[0])||{}},this.leftHeaderPanelObj={div:document.getElementById("sp-leftHeader"),obj:(null===(c=this.getSelector(this.leftPanelObj.obj,"header"))||void 0===c?void 0:c[0])||{}},this.leftBodyPanelObj={div:document.getElementById("sp-leftBody"),obj:(null===(u=this.getSelector(this.leftPanelObj.obj,"body"))||void 0===u?void 0:u[0])||{}},this.leftFooterPanelObj={div:document.getElementById("sp-leftFooter"),obj:(null===(v=this.getSelector(this.leftPanelObj.obj,"footer"))||void 0===v?void 0:v[0])||{}},this.rightPanelObj={div:document.getElementById("sp-right"),obj:(null===(h=this.getSelector(this.bodyPanelObj.obj,"panel.right"))||void 0===h?void 0:h[0])||{}},this.rightHeaderPanelObj={div:document.getElementById("sp-rightHeader"),obj:(null===(f=this.getSelector(this.rightPanelObj.obj,"header"))||void 0===f?void 0:f[0])||{}},this.rightBodyPanelObj={div:document.getElementById("sp-rightBody"),obj:(null===(b=this.getSelector(this.rightPanelObj.obj,"body"))||void 0===b?void 0:b[0])||{}},this.rightFooterPanelObj={div:document.getElementById("sp-rightFooter"),obj:(null===(m=this.getSelector(this.rightPanelObj.obj,"footer"))||void 0===m?void 0:m[0])||{}},this.iFramePanelObj={div:document.getElementById("sp-iFrame"),obj:(null===(y=this.getSelector(this.bodyPanelObj.obj,"panel.middle"))||void 0===y?void 0:y[0])||{}}}return _createClass(e,[{key:"getSelector",value:function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return[].concat(o).map(function(t){return t.replace(/\[([^\[\]]*)\]/g,".$1.").split(".").filter(function(e){return""!==e}).reduce(function(e,t){return e&&e[t]},e)})}},{key:"setPageCaption",value:function(){this.caption.content&&(this.caption.div.innerHTML=this.caption.content)}},{key:"setPanelVisibility",value:function(){var e=this;Object.keys(this).filter(function(t){var o,n;return void 0!==(null==e?void 0:null===(o=e[t])||void 0===o?void 0:null===(n=o.obj)||void 0===n?void 0:n.visible)}).map(function(t){return e[t]}).forEach(function(e){!e.obj.visible&&e.div.classList.add("d-none")})}},{key:"getSetData",value:function(){var e=this,t=this;ShowDimmer(!0);var o=Object.keys(this).filter(function(t){var o,n;return void 0!==(null==e?void 0:null===(o=e[t])||void 0===o?void 0:null===(n=o.obj)||void 0===n?void 0:n.visible)}).map(function(t){return e[t]});o.filter(function(e){var t;return void 0!==(null==e?void 0:null===(t=e.obj)||void 0===t?void 0:t.dataSource)&&!e.obj.dataSource&&"sp-iFrame"!=e.div.id}).forEach(function(e){e.div.classList.add("d-none")});var n=o.filter(function(e){return e.obj.dataSource});AxAsyncGetSqlData(n.map(function(e){return e.obj.dataSource}).join(),"",function(e){var o=JSON.parse(e);if(o.error){var i,r,l,a=null==o?void 0:null===(i=o.error)||void 0===i?void 0:null===(r=i.error)||void 0===r?void 0:null===(l=r[0])||void 0===l?void 0:l.msg;a&&showAlertDialog("error",a)}n.forEach(function(e){var t,n,i,r=o[e.obj.dataSource],l=e.div;l.hasAttribute("contentholder")||(l=null===(i=l.querySelectorAll("[contentholder]"))||void 0===i?void 0:i[0]);if(l&&r){if(((null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.length)||0)>0)switch(null==e?void 0:null===(n=e.div)||void 0===n?void 0:n.id){case"sp-header":case"sp-footer":case"sp-leftHeader":case"sp-leftFooter":case"sp-rightHeader":case"sp-rightFooter":case"sp-leftBody":case"sp-rightBody":var a=r.sqlmetaData.reduce(function(e,t){var o=t.name;return[].concat(_toConsumableArray(e),[o.toLowerCase()])},[]),d=r.data.reduce(function(e,t){return e.push(a.reduce(function(e,o,n){return e[o]=t[n],e},{})),e},[]);if(d.length>0)try{d.forEach(function(t){var o,n=Handlebars.compile((null===(o=e.obj)||void 0===o?void 0:o.template)||"{{content}}")(t);n?l.innerHTML+=n:e.div.classList.add("d-none")})}catch(s){showAlertDialog("error",s.message)}else e.div.classList.add("d-none");break;default:e.div.classList.add("d-none")}}else e.div.classList.add("d-none")}),t.doExtras(),ShowDimmer(!1)},function(t){e.doExtras(),ShowDimmer(!1)})}},{key:"doExtras",value:function(){0==_toConsumableArray(this.leftPanelObj.div.querySelectorAll("[contentholder]")).filter(function(e){return null!==e.offsetParent}).length&&this.leftPanelObj.div.classList.add("d-none"),0==_toConsumableArray(this.rightPanelObj.div.querySelectorAll("[contentholder]")).filter(function(e){return null!==e.offsetParent}).length&&this.rightPanelObj.div.classList.add("d-none"),setTimeout(function(){var e,t,o;null===(e=_toConsumableArray(document.querySelectorAll("a,button")))||void 0===e||null===(t=e.filter(function(e){return!e.classList.contains("dropdown-item")}))||void 0===t||null===(o=t[0])||void 0===o||o.click()},0)}},{key:"injectCode",value:function(){this.loadStyles(),this.loadScripts()}},{key:"loadStyles",value:function(){var e;((null===(e=this.files)||void 0===e?void 0:e.css)||[]).forEach(function(e){if(e){var t=document.createElement("style"),o=document.head||document.querySelectorAll("head")[0]||document.documentElement;t.innerText=e,o.insertBefore(t,o.firstChild)}})}},{key:"loadScripts",value:function(){var e;((null===(e=this.files)||void 0===e?void 0:e.js)||[]).forEach(function(e){if(e){var t=document.createElement("script");t.async=!0;var o=document.head||document.querySelectorAll("head")[0]||document.documentElement;t.innerText=e,o.insertBefore(t,o.firstChild)}})}}]),e}();function ShowDimmer(e){DimmerCalled=!0;var t=$("#waitDiv");t.length>0&&t!=undefined?1==e?(closeParentFrame(),$("body").addClass("page-loading"),document.onkeydown=function(){return!1}):($("body").removeClass("page-loading"),document.onkeydown=function(){if(1==DimmerCalled)return!0}):window.opener!=undefined&&(t=$("#waitDiv",window.opener.document)).length>0&&(1==e?$("body",window.opener.document).addClass("page-loading"):$("body",window.opener.document).removeClass("page-loading")),DimmerCalled=!1}function closeParentFrame(){try{eval(callParent("closeFrame()","function"))}catch(ex){console.log("Error in CloseParentFrame -"+ex.message)}}