/*http://demo.agile-labs.com/minZIP/*//*version=3.9.0*/var xlresult,xlGridfieldNames,xlDcNo;$(function(){$("#excelimport").click(function(){for(var e="",l=[],r=[],a=[],t="",i="",n=1;n<xlresult.length;n++){e+="i"+n+",",r.push({n:xlGridfieldNames[0],v:"0",r:n.toString(),t:"s"});for(var o=0;o<xlresult[n].length;o++)i="undefined"!=typeof xlresult[n][o]?xlresult[n][o]:"",t=xlresult[0][o],""!=i&&(i=i.toString()),a.push({n:t,v:i,r:n.toString(),t:"s"})}e=e.slice(0,-1),l.push({n:"DC"+xlDcNo,v:xlDcNo,cr:e,t:"dc",hasdatarows:"yes"});var s=[];s=s.concat(l,r,a),callParentNew("AxActiveDc=",xlDcNo),callParentNew("gridDummyRowVal").length>0&&callParentNew("gridDummyRowVal").map(function(e){e.split("~")[0]==xlDcNo&&callParentNew("gridDummyRowVal").splice($.inArray(e,callParentNew("gridDummyRowVal")),1)}),parent.ExecData(s,"LoadData",!0),callParentNew("closeModalDialog()","function");var c=xlresult.length-1,d="";for(o=1;o<=c;o++){d=o<=9?"00"+o:o>9&&o<=99?"0"+o:o;for(var f=0;f<xlGridfieldNames.length;f++){var u=xlGridfieldNames[f]+d+"F"+xlDcNo;parent.EvaluateExpressions(u)}}})}),$j(document).ready(function(){$("#excelfile").bind({change:function change(e){var filename=$("#excelfile").val(),fName=filename.toString().split("\\");filename=fName[fName.length-1],$("#noFile").text(filename);var file=e.target.files[0],files=e.target.files,f=files[0],FR=new FileReader;FR.onload=function(e){var data=new Uint8Array(e.target.result),workbook=XLSX.read(data,{type:"array",cellDates:!0,dateNF:"dd/mm/yyyy;@"}),firstSheet=workbook.Sheets[workbook.SheetNames[0]],result=XLSX.utils.sheet_to_json(firstSheet,{header:1,raw:!1});if(0!=result.length){var dcNo=window.location.href.split("=")[1],gridFieldNames=callParentNew("GetGridFields("+dcNo+")","function"),check=gridFieldNames.some(function(e){return result[0].includes(e)});check?0!=result[1].length?(xlresult=result,xlGridfieldNames=gridFieldNames,xlDcNo=dcNo):showAlertDialog("error",eval(callParent("lcm[511]"))):showAlertDialog("error",eval(callParent("lcm[510]")))}else showAlertDialog("error",eval(callParent("lcm[509]")))},FR.readAsArrayBuffer(file)}})});