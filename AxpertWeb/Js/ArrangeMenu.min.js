/*http://demo.agile-labs.com/minZIP/*//*version=3.9.1*/function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var menuJSON;function validateFile(e,t){var n,r=t.get_fileName(),o=r.substring(r.lastIndexOf(".")+1),a=t._length;if(-1!=$("#hdnUserIconList").val().indexOf(r))throw(n=new Error).name="Duplicate File",n.message="Selected file alredy exists",n;if("jpg"!=o&&"jpeg"!=o&&"png"!=o&&"JPG"!=o&&"PNG"!=o)throw(n=new Error).name="File Format",n.message="Selected file is not supported, please select .jpg, .jpeg, .png file only",n;if(a>515785)throw(n=new Error).name="Max Size",n.message="Max. icon upload size is 500 KB",n}function uploadError(e,t){showAlertDialog("error",t.get_errorMessage()),$.each($("#uploadIcon input"),function(){$(this).val("")})}function SetNodeIcon(e,t){$("#hdnUserIconList").val($("#hdnUserIconList").val()+t.get_fileName()+","),$(".userIcons").append('<span><img src="'+$("#hdnIconPath").val()+t.get_fileName()+'"><a  href="javascript:void(0)" title="Delete" data-caption="'+t.get_fileName()+'" class="icon-arrows-remove DltIcnBtn"></a></span>'),$("#lblFileInf").text(t.get_fileName()),$.each($("#uploadIcon input"),function(){$(this).val("")})}function OBJtoXML(e){var t="";for(var n in e){if(t+=e[n]instanceof Array?"":"<"+n+">",e[n]instanceof Array)for(var r in e[n])t+="<"+n+">",t+=OBJtoXML(new Object(e[n][r])),t+="</"+n+">";else"object"==_typeof(e[n])?t+=OBJtoXML(new Object(e[n])):t+=e[n];t+=e[n]instanceof Array?"":"</"+n+">"}return t=t.replace(/<\/?[0-9]{1,}>/g,"")}function ShowDimmer(e){DimmerCalled=!0;var t=$("#waitDiv");if(t.length>0&&t!=undefined)if(1==e){var n=$("#middle1",parent.document);n&&t.width(n.width()),t.show(),document.onkeydown=function(){return!1}}else t.hide(),document.onkeydown=function(){if(1==DimmerCalled)return!0};else window.opener!=undefined&&(t=$("#waitDiv",window.opener.document)).length>0&&(1==e?t.show():t.hide());DimmerCalled=!1}$(document).ready(function(e){if(menuData){menuData=menuData.replace(/&apos;/g,"'");var t=parseXml(menuData);menuJSON=JSON.parse(xml2json(t,""))}createTheTreeView({menuJSON:menuJSON,treeContainer:"#arrangeMenu"}),$.ui.fancytree.getTree("#arrangeMenu").selectAll(!1),$("#arrangeMenu").fancytree("getRootNode").visit(function(e){e.setExpanded(!1)}),$("#btnDelete").on("click",function(){var e=$.ui.fancytree.getTree("#arrangeMenu");return selNodes=e.getSelectedNodes(),0==selNodes.length?(showAlertDialog("warning","Please select atleast one node."),!1):(selNodes.forEach(function(e){for(;e.hasChildren();)e.getFirstChild().moveTo(e.parent,"child");e.remove()}),!1)}),$("#btnAdd").on("click",function(){return $.ui.fancytree.getTree("#arrangeMenu").getRootNode().editCreateNode("child",{key:"H"+Date.now().toString(),title:"New Folder",folder:!0,level:"0"}),!1}),$("#btnSave").on("click",function(){var e=$.ui.fancytree.getTree("#arrangeMenu").toDict();menuJSON.root.parent=ParseTreeJsonToOrignalformat({TreeJSON:e});var t=OBJtoXML(menuJSON);ShowDimmer(!0),$.ajax({url:"ArrangeMenu.aspx/SaveTreeView",type:"POST",cache:!1,async:!0,data:JSON.stringify({key:t}),contentType:"application/json",success:function(e){var t=e.d;"success"==t.status?showAlertDialog("success","Data saved successfully"):"SESSION_TIMEOUT"==t.msg?parent.window.location.href="../aspx/sess.aspx":showAlertDialog("error",t.msg),ShowDimmer(!1)},failure:function(){showAlertDialog("error","Error while saving."),ShowDimmer(!1)},error:function(){showAlertDialog("error","Error while saving."),ShowDimmer(!1)}})}),$("#lnkChngIcon").on("click",function(){return $.ui.fancytree.getTree("#arrangeMenu").getSelectedNodes().length?(createIconPopup("uploadIcon","hdnUserIconList",$("#hdnIconPath").val()),!1):(showAlertDialog("warning","Please select atleast one node."),!1)}),$(document).off("click").on("click",".modal-content #iconWrapperData  span",function(e){if($(e.target).is($(".DltIcnBtn")))return!0;var t=$.ui.fancytree.getTree("#arrangeMenu").getSelectedNodes();if($(this).find("img").length)for(var n=$(this).find("img").attr("src"),r=0;r<t.length;r++)t[r].icon=n,t[r].renderTitle();else{icon=$(this).text();for(r=0;r<t.length;r++)t[r].icon={text:icon,addClass:"material-icons"},t[r].renderTitle()}}),$("body").on("keyup","#srchIcon",function(){var e=$(this).val().toLowerCase();$("#iconWrapperData span").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(e)>-1)})}),$(document).on("click",".DltIcnBtn",function(){var e=$(this).data("caption"),t=this;deleteCnfrmBx=$.confirm({theme:"modern",title:"Confirm!",onContentReady:function(){disableBackDrop("bind")},onOpen:function(){$(".cnfrmBxHotBtn").focus()},escapeKey:"buttonB",content:"Do you realy want to delete ?",buttons:{buttonA:{text:"Yes",btnClass:"btn btn-primary",action:function(){$.ajax({url:"ArrangeMenu.aspx/deleteIconImage",type:"POST",data:JSON.stringify({fileName:e}),dataType:"json",contentType:"application/json",success:function(n){if("Success"==n.d){$(t).parent("span").remove();var r=$("#hdnUserIconList").val().split(","),o=r.indexOf(e);r.splice(o,1),$("#hdnUserIconList").val(r.join()),showAlertDialog("success","Icon deleted successfully")}else showAlertDialog("error","Error while Deleting")},failure:function(){showAlertDialog("error","Error while Deleting")},error:function(){showAlertDialog("error","Error while Deleting")}}),deleteCnfrmBx=""}},buttonB:{text:"Cancel",btnClass:"coldbtn",action:function(){disableBackDrop("destroy"),deleteCnfrmBx=""}}}})})}),function(){window.createTheTreeView=function(e){var t=e.menuJSON,n=e.treeContainer;n=$(n);var r=function o(e){var t=[],n=e.parent;return n.length===undefined&&(n=[n]),n&&n.forEach(function(e,n){var r=e.child;if(r){var a=[];"undefined"==typeof r.length?a.push(o({parent:[r]})):r.forEach(function(e,t){a.push(o({parent:[e]}))}),delete e.child,Object.assign(e,{title:e.name,key:e.oname,folder:!0,children:a}),t.push(e)}else{var i=e.name,c=e.target,l=e.oname,s=e.icon,d=function(e){var t=e.target,n=e.icon,r="folder",o="folder";return t&&(0!==t.indexOf("tstruct.aspx")&&0!==t.indexOf("iview.aspx")&&0!==t.indexOf("iviewInteractive.aspx")||(r="item"),n==undefined)?(0===t.indexOf("tstruct.aspx")?o="assignment":0===t.indexOf("iview.aspx")||0===t.indexOf("iviewInteractive.aspx")?o="view_list":0==t.indexOf("page.aspx")&&(o="insert_drive_file"),{targetType:r,iconn:{text:o,addClass:"material-icons"}}):{targetType:r,iconn:n}}({target:c,icon:s}),u=d.targetType,f=d.iconn;folder="folder"===u,Object.assign(e,{title:i,key:l,folder:folder,icon:f}),t.push(e)}}),1===t.length?t[0]:t}(t.root);n.fancytree({checkbox:!0,selectMode:2,icon:!0,autoCollapse:!0,defaultKey:function(){return"Head"+Date.now().toString()},extensions:["dnd5","edit","glyph"],source:r,dnd5:{autoExpandMS:400,focusOnClick:!0,preventVoidMoves:!0,preventRecursion:!0,dragStart:function(e,t){return!0},dragEnter:function(e,t){return!!e.isFolder()||["before"]},dragDrop:function(e,t){t.otherNode.moveTo(e,t.hitMode)},dragEnd:function(e,t){e.data.level=(e.getLevel()-1).toString()}},edit:{adjustWidthOfs:null,triggerStart:["clickActive","dblclick","f2","mac+enter","shift+click","active","focus"],beforeEdit:function(e,t){if(!t.node.folder)return!1},edit:function(e,t){$(t.input).attr("maxlength","50")}},glyph:{preset:"material",map:{_addClass:"material-icons",checkbox:{text:"check_box_outline_blank"},checkboxSelected:{text:"check_box"},checkboxUnknown:{text:"indeterminate_check_box"},dragHelper:{text:"play_arrow"},dropMarker:{text:"arrow-forward"},error:{text:"warning"},expanderClosed:{text:"chevron_right"},expanderLazy:{text:"last_page"},expanderOpen:{text:"expand_more"},loading:{text:"autorenew",addClass:"fancytree-helper-spin"},nodata:{text:"info"},noExpander:{text:""},radio:{text:"radio_button_unchecked"},radioSelected:{text:"radio_button_checked"},doc:{text:"web_asset"},docOpen:{text:"web_asset"},folder:{text:"folder"},folderOpen:{text:"folder_open"}}},activate:function(e,t){},lazyLoad:function(e,t){t.result={FinalmenuJson:r}}}),$(".drag").draggable()},window.ParseTreeJsonToOrignalformat=function e(t){var n=t.TreeJSON,r=[];return n.forEach(function(t,n){var o=t.data,a=t.children,i=t.title,c=t.key;if(delete t.children,delete t.data,a){var l=[];"undefined"==typeof a.length?l.push(e({TreeJSON:[a]})):a.forEach(function(t,n){l.push(e({TreeJSON:[t]}))}),o?r.push(Object.assign(t,o,{name:i,oname:c},{child:l})):r.push(Object.assign(t,{name:i,oname:c},{child:l}))}else o?r.push(Object.assign(t,o,{name:i,oname:c})):r.push(Object.assign(t,{name:i,oname:c}))}),r}}();