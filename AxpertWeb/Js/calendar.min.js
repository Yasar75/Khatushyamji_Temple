/*www.agilecloud.biz/minZIP?v=3.3*/var isCalOpen,crossobj,crossMonthObj,crossYearObj,monthSelected,yearSelected,dateSelected,omonthSelected,oyearSelected,odateSelected,monthConstructed,yearConstructed,intervalID1,intervalID2,timeoutID1,timeoutID2,ctlToPlaceValue,ctlNow,dateFormat,nStartingYear,extraHgt,startAt=1,showWeekNumber=0,showToday=1,imgDir="../AxpImages/",styleAnchor="text-decoration:none;color:black;",monthName=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),bPageLoaded=!1,ie=document.all,dom=document.getElementById,today=new Date,dateNow=today.getDate(),monthNow=today.getMonth(),yearNow=today.getFullYear(),bShow=!1,HolidaysCounter=0,Holidays=new Array;function hideElement(e,t){if(ie)for(i=0;i<document.all.tags(e).length;i++)if(obj=document.all.tags(e)[i],obj&&obj.offsetParent){for(objLeft=obj.offsetLeft,objTop=obj.offsetTop,objParent=obj.offsetParent;"BODY"!=objParent.tagName.toUpperCase()&&"HTML"!=objParent.tagName.toUpperCase();)objLeft+=objParent.offsetLeft,objTop+=objParent.offsetTop,objParent=objParent.offsetParent;objHeight=obj.offsetHeight,objWidth=obj.offsetWidth,t.offsetLeft+t.offsetWidth<=objLeft||t.offsetTop+t.offsetHeight<=objTop||t.offsetTop>=objTop+objHeight+obj.height||t.offsetLeft>=objLeft+objWidth||objTop+2<=crossobj.top.substr(0,crossobj.top.length-2)||(obj.style.visibility="hidden")}}function showElement(e){if(ie)for(i=0;i<document.all.tags(e).length;i++)obj=document.all.tags(e)[i],obj&&obj.offsetParent&&(obj.style.visibility="")}function HolidayRec(e,t,o,a){this.d=e,this.m=t,this.y=o,this.desc=a}function init(){document.layers||(crossobj=dom?document.getElementById("calendar").style:ie?document.all.calendar:document.calendar,hideCalendarControl(),crossMonthObj=dom?document.getElementById("selectMonth").style:ie?document.all.selectMonth:document.selectMonth,crossYearObj=dom?document.getElementById("selectYear").style:ie?document.all.selectYear:document.selectYear,monthConstructed=!1,yearConstructed=!1,1==showToday&&(document.getElementById("lblToday").innerHTML="Today is <a onmousemove='window.status=\"Go To Current Month\"' onmouseout='window.status=\"\"' title='Go To Current Month' style='"+styleAnchor+"' href='javascript:monthSelected=monthNow;yearSelected=yearNow;constructCalendar();'>"+dayName[today.getDay()-startAt==-1?6:today.getDay()-startAt]+", "+dateNow+" "+monthName[monthNow].substring(0,3)+"\t"+yearNow+"</a>"),sHTML1="<span id='spanLeft' class='Headerbg' style='border-style:solid;border-width:1;cursor:pointer' onmouseover='this.style.borderColor=\"#EFF3FB\";window.status=\"Click to scroll to previous month. Hold mouse button to scroll automatically.\"' onclick='javascript:decMonth()' onmouseout='this.style.borderColor=\"\";clearInterval(intervalID1);window.status=\"\"' onmousedown='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"StartDecMonth()\",500)'\tonmouseup='clearTimeout(timeoutID1);clearInterval(intervalID1)'>&nbsp;<a id='changeLeft'>&lt;&lt;</a>&nbsp;</span>&nbsp;",sHTML1+="<span id='spanRight' class='Headerbg' style='border-style:solid;border-width:1;cursor:pointer'\tonmouseover='this.style.borderColor=\"#EFF3FB\";window.status=\"Click to scroll to next month. Hold mouse button to scroll automatically.\"' onmouseout='this.style.borderColor=\"\";clearInterval(intervalID1);window.status=\"\"' onclick='incMonth()' onmousedown='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"StartIncMonth()\",500)'\tonmouseup='clearTimeout(timeoutID1);clearInterval(intervalID1)'>&nbsp;<a id='changeRight'>&gt;&gt;</a>&nbsp;</span>&nbsp",sHTML1+="<span id='spanMonth' class='Headerbg' style='border-style:solid;border-width:1;cursor:pointer'\tonmouseover='this.style.borderColor=\"#EFF3FB\";window.status=\"Click to select a month.\"' onmouseout='this.style.borderColor=\"\";window.status=\"\"' onclick='popUpMonth()'></span>&nbsp;",sHTML1+="<span id='spanYear' class='Headerbg' style='border-style:solid;border-width:1;cursor:pointer' onmouseover='this.style.borderColor=\"#EFF3FB\";window.status=\"Click to select a year.\"'\tonmouseout='this.style.borderColor=\"\";window.status=\"\"'\tonclick='popUpYear()'></span>&nbsp;",document.getElementById("caption").innerHTML=sHTML1,bPageLoaded=!0)}function hideCalendarControl(){crossobj.visibility="hidden",null!=crossMonthObj&&(crossMonthObj.visibility="hidden"),null!=crossYearObj&&(crossYearObj.visibility="hidden"),showElement("SELECT"),showElement("APPLET"),SubCalHgtFrmIview(),AxDoBlur=!0}function padZero(e){return e<10?"0"+e:e}function constructDate(e,t,o){return sTmp=dtFormat,sTmp=sTmp.replace("ddd","<n>"),sTmp=sTmp.replace("dd","<e>"),sTmp=sTmp.replace("d","<d>"),sTmp=sTmp.replace("<e>",padZero(e)),sTmp=sTmp.replace("<d>",e),sTmp=sTmp.replace("mmm","<o>"),sTmp=sTmp.replace("mm","<n>"),sTmp=sTmp.replace("m","<m>"),sTmp=sTmp.replace("<m>",t+1),sTmp=sTmp.replace("<n>",padZero(t+1)),sTmp=sTmp.replace("<o>",monthName[t]),sTmp.replace("yyyy",o)}function closeCalendar(){if(ctlToPlaceValue.value=constructDate(dateSelected,monthSelected,yearSelected),"Users"==document.title){if(ctlToPlaceValue){var e=ctlToPlaceValue.id;-1!=e.toString().indexOf("txtUsStrDt")?celno=2:celno=3;var t=e.toString().indexOf("ctl"),o=e.toString().substring(t+3),a=o.toString().indexOf("_");Rindx=parseInt(o.toString().substring(0,a),10)-2}ValidateDate(Rindx,celno),hideCalendarControl()}}function StartDecMonth(){intervalID1=setInterval("decMonth()",8e4)}function StartIncMonth(){intervalID1=setInterval("incMonth()",8e4)}function incMonth(){++monthSelected>11&&(monthSelected=0,yearSelected++),constructCalendar()}function decMonth(){--monthSelected<0&&(monthSelected=11,yearSelected--),constructCalendar()}function constructMonth(){if(popDownYear(),!monthConstructed){for(sHTML="",i=0;i<12;i++)sName=monthName[i],i==monthSelected&&(sName="<B>"+sName+"</B>"),sHTML+="<tr><td id='m"+i+"' onmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='this.style.backgroundColor=\"\"' style='cursor:pointer' onclick='monthConstructed=false;monthSelected="+i+";constructCalendar();popDownMonth();event.cancelBubble=true'>&nbsp;"+sName+"&nbsp;</td></tr>";document.getElementById("selectMonth").innerHTML="<table width=70\tstyle='font-size:11px; border-width:1; border-style:solid; border-color:#a0a0a0;' cellspacing=0 onmouseover='clearTimeout(timeoutID1)'\tonmouseout='clearTimeout(timeoutID1);timeoutID1=setTimeout(\"popDownMonth()\",100);event.cancelBubble=true'>"+sHTML+"</table>",monthConstructed=!0}}function popUpMonth(){constructMonth(),navigator.appName,crossMonthObj.left=parseInt(crossobj.left,10)+56+"px",crossMonthObj.top=parseInt(crossobj.top,10)+26+"px",crossMonthObj.visibility=dom||ie?"visible":"show",hideElement("SELECT",document.getElementById("selectMonth")),hideElement("APPLET",document.getElementById("selectMonth"))}function popDownMonth(){crossMonthObj.visibility="hidden"}function incYear(){for(i=0;i<7;i++)newYear=i+nStartingYear+1,newYear==yearSelected?txtYear="&nbsp;<B>"+newYear+"</B>&nbsp;":txtYear="&nbsp;"+newYear+"&nbsp;",document.getElementById("y"+i).innerHTML=txtYear;nStartingYear++,bShow=!0}function decYear(){for(i=0;i<7;i++)newYear=i+nStartingYear-1,newYear==yearSelected?txtYear="&nbsp;<B>"+newYear+"</B>&nbsp;":txtYear="&nbsp;"+newYear+"&nbsp;",document.getElementById("y"+i).innerHTML=txtYear;nStartingYear--,bShow=!0}function selectYear(e){yearSelected=parseInt(e+nStartingYear),yearConstructed=!1,constructCalendar(),popDownYear()}function constructYear(){if(popDownMonth(),sHTML="",!yearConstructed){for(sHTML="<tr><td align='center'\tonmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='clearInterval(intervalID1);this.style.backgroundColor=\"\"' style='cursor:pointer'\tonmousedown='clearInterval(intervalID1);intervalID1=setInterval(\"decYear()\",30)' onmouseup='clearInterval(intervalID1)'>-</td></tr>",j=0,nStartingYear=yearSelected-3,i=yearSelected-3;i<=yearSelected+3;i++)sName=i,i==yearSelected&&(sName="<B>"+sName+"</B>"),sHTML+="<tr><td id='y"+j+"' onmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='this.style.backgroundColor=\"\"' style='cursor:pointer' onclick='selectYear("+j+");event.cancelBubble=true'>&nbsp;"+sName+"&nbsp;</td></tr>",j++;sHTML+="<tr><td align='center' onmouseover='this.style.backgroundColor=\"#FFCC99\"' onmouseout='clearInterval(intervalID2);this.style.backgroundColor=\"\"' style='cursor:pointer' onmousedown='clearInterval(intervalID2);intervalID2=setInterval(\"incYear()\",30)'\tonmouseup='clearInterval(intervalID2)'>+</td></tr>",document.getElementById("selectYear").innerHTML="<table width=44 style='font-size:11px; border-width:1; border-style:solid; border-color:#a0a0a0;'\tonmouseover='clearTimeout(timeoutID2)' onmouseout='clearTimeout(timeoutID2);timeoutID2=setTimeout(\"popDownYear()\",100)' cellspacing=0>"+sHTML+"</table>",yearConstructed=!0}}function popDownYear(){clearInterval(intervalID1),clearTimeout(timeoutID1),clearInterval(intervalID2),clearTimeout(timeoutID2),crossYearObj.visibility="hidden"}function popUpYear(){var e;constructYear(),e=parseInt(crossobj.left)+document.getElementById("spanYear").offsetLeft,ie&&(e+=6),"Microsoft Internet Explorer"!=navigator.appName?(e+=6,crossYearObj.left=e+"px",crossYearObj.top=parseInt(crossobj.top,10)+26+"px"):(crossYearObj.left=e+"px",crossYearObj.top=parseInt(crossobj.top,10)+26+"px"),crossYearObj.visibility=dom||ie?"visible":"show"}function WeekNbr(e){return year=e.getFullYear(),month=e.getMonth()+1,day=0==startAt?e.getDate()+1:e.getDate(),a=Math.floor((14-month)/12),y=year+4800-a,m=month+12*a-3,b=Math.floor(y/4)-Math.floor(y/100)+Math.floor(y/400),J=day+Math.floor((153*m+2)/5)+365*y+b-32045,d4=(J+31741-J%7)%146097%36524%1461,L=Math.floor(d4/1460),d1=(d4-L)%365+L,week=Math.floor(d1/7)+1,week}function constructCalendar(){var e,t,o=Array(31,0,31,30,31,30,31,31,30,31,30,31),a=new Date(yearSelected,monthSelected,1);for(1==monthSelected?(t=new Date(yearSelected,monthSelected+1,1),t=new Date(t-864e5),numDaysInMonth=t.getDate()):numDaysInMonth=o[monthSelected],datePointer=0,dayPointer=a.getDay()-startAt,dayPointer<0&&(dayPointer=6),sHTML="<table\t border=0 style='font-size:10px;'><tr>",1==showWeekNumber&&(sHTML+="<td width=27><b>Wk</b></td><td width=1 rowspan=7 bgcolor='#d0d0d0' style='padding:0px'><img src='"+imgDir+"divider.gif' width=1></td>"),n=0;n<7;n++)sHTML+="<td width='27' align='right'><B>"+dayName[n]+"</B></td>";sHTML+="</tr><tr>",1==showWeekNumber&&(sHTML+="<td align=right>"+WeekNbr(a)+"&nbsp;</td>");for(var n=1;n<=dayPointer;n++)sHTML+="<td>&nbsp;</td>";for(datePointer=1;datePointer<=numDaysInMonth;datePointer++){for(dayPointer++,sHTML+="<td align=right>",sStyle=styleAnchor,datePointer==odateSelected&&monthSelected==omonthSelected&&yearSelected==oyearSelected&&(sStyle+="border-style:solid;border-width:1px;border-color:#a0a0a0;"),sHint="",k=0;k<HolidaysCounter;k++)parseInt(Holidays[k].d)==datePointer&&parseInt(Holidays[k].m)==monthSelected+1&&(0==parseInt(Holidays[k].y)||parseInt(Holidays[k].y)==yearSelected&&0!=parseInt(Holidays[k].y))&&(sStyle+="background-color:#FFDDDD;",sHint+=""==sHint?Holidays[k].desc:"\n"+Holidays[k].desc);sHint=sHint.replace(/\"/g,"&quot;"),e="onmousemove='window.status=\""+"Select [date] as date.".replace("[date]",constructDate(datePointer,monthSelected,yearSelected))+"\"' onmouseout='window.status=\"\"' ",datePointer==dateNow&&monthSelected==monthNow&&yearSelected==yearNow?sHTML+="<b><a "+e+' title="'+sHint+"\" style='"+sStyle+"' href='javascript:dateSelected="+datePointer+";closeCalendar();'><font color=#ff0000>&nbsp;"+datePointer+"</font>&nbsp;</a></b>":dayPointer%7==-1*startAt+1?sHTML+="<a "+e+' title="'+sHint+"\" style='"+sStyle+"' href='javascript:dateSelected="+datePointer+";closeCalendar();'>&nbsp;<font color=#909090>"+datePointer+"</font>&nbsp;</a>":sHTML+="<a "+e+' title="'+sHint+"\" style='"+sStyle+"' href='javascript:dateSelected="+datePointer+";closeCalendar();'>&nbsp;"+datePointer+"&nbsp;</a>",sHTML+="",(dayPointer+startAt)%7==startAt&&(sHTML+="</tr><tr>",1==showWeekNumber&&datePointer<numDaysInMonth&&(sHTML+="<td align=right>"+WeekNbr(new Date(yearSelected,monthSelected,datePointer+1))+"&nbsp;</td>"))}document.getElementById("content").innerHTML=sHTML,document.getElementById("spanMonth").innerHTML="&nbsp;"+monthName[monthSelected]+"&nbsp;&nbsp;<a id='changeMonth'>v</a>&nbsp;",document.getElementById("spanYear").innerHTML="&nbsp;"+yearSelected+"&nbsp;&nbsp;<a id='changeYear'>v</a>&nbsp;"}function showCalendarControl(e){AxDoBlur=!1;var t=e,o=dtFormat,a=0,n=0;if(bPageLoaded){if("hidden"==crossobj.visibility){if(ctlToPlaceValue=t,dateFormat=o,formatChar=" ",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar="/",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar=".",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar="-",aFormat=dateFormat.split(formatChar),aFormat.length<3&&(formatChar="")))),tokensChanged=0,""!=formatChar)for(aData=t.value.split(formatChar),i=0;i<3;i++)if("d"==aFormat[i]||"dd"==aFormat[i])dateSelected=parseInt(aData[i],10),tokensChanged++;else if("m"==aFormat[i]||"mm"==aFormat[i])monthSelected=parseInt(aData[i],10)-1,tokensChanged++;else if("yyyy"==aFormat[i])yearSelected=parseInt(aData[i],10),tokensChanged++;else if("mmm"==aFormat[i])for(j=0;j<12;j++)aData[i]==monthName[j]&&(monthSelected=j,tokensChanged++);(3!=tokensChanged||isNaN(dateSelected)||isNaN(monthSelected)||isNaN(yearSelected))&&(dateSelected=dateNow,monthSelected=monthNow,yearSelected=yearNow),odateSelected=dateSelected,omonthSelected=monthSelected,oyearSelected=yearSelected,aTag=e;do{aTag=aTag.offsetParent,a+=aTag.offsetLeft,n+=aTag.offsetTop}while("BODY"!=aTag.tagName&&"HTML"!=aTag.tagName);aTag=e;var r=0;do{if(aTag=aTag.parentNode,"DIV"==aTag.tagName){aTag=aTag.parentNode,r=aTag.scrollTop;break}}while("BODY"!=aTag.tagName&&"HTML"!=aTag.tagName);var s=e.offsetLeft+a,l=e.offsetTop+n+e.offsetHeight+2-r;crossobj.left=s.toString()+"px",crossobj.top=l.toString()+"px",AdjustWidth(s),constructCalendar(1,monthSelected,yearSelected),crossobj.visibility=dom||ie?"visible":"show",hideElement("SELECT",document.getElementById("calendar")),hideElement("APPLET",document.getElementById("calendar")),bShow=!0,AddCalHgtToIview()}else hideCalendarControl(),ctlNow!=e&&showCalendarControl(e,o);ctlNow=e}}function AddCalHgtToIview(){if("Iview"==document.title||-1!=document.title.toLowerCase().indexOf("tstruct")||"Users"==document.title){var e=parent.document.getElementById("middle1");"Iview"==document.title&&window.opener!=undefined&&(e=$j("#middle1",window.opener.parent.document));var t=crossobj.top.replace("px",""),o=parseInt(e.clientHeight,10)-parseInt(t,10)-30;extraHgt=220-o,o<185&&(e.style.height=parseInt(e.clientHeight,10)+(400-o)),isCalOpen=!0}}function SubCalHgtFrmIview(){if("Iview"==document.title&&isCalOpen!=undefined&&1==isCalOpen){var e=parent.document.getElementById("middle1");"Microsoft Internet Explorer"!=navigator.appName&&(e.height=parseInt(e.height,10)-extraHgt),isCalOpen=!1}}function AdjustWidth(e){var t=parent.document.getElementById("middle1");if("Iview"==document.title&&window.opener!=undefined&&(t=window.opener.parent.document.getElementById("middle1")),t!=undefined){var o=parseInt(t.width,10);o-(e=parseInt(e,10))<250&&"Users"!=document.title&&(crossobj.left=o-250+"px")}}dom&&(document.write("<div onclick='bShow=true' class='header' id='calendar' style='z-index:99999;position:absolute;visibility:hidden;'><table width="+(1==showWeekNumber?250:220)+" style='font-size:12px;border-width:1;border-style:thin;border-color:#6190BA;font-size:11px}' bgcolor='#ffffff'><tr class='header'><td><table width='"+(1==showWeekNumber?248:218)+"'><tr class='header'><td style='padding:2px;font-size:11px;'><font color='#ffffff'><B><span id='caption'></span></B></font></td><td align=right><a href='javascript:hideCalendarControl()'><IMG SRC='"+imgDir+"close_btn.gif' WIDTH='15' HEIGHT='13' BORDER='0' ALT='Close the Calendar'></a></td></tr></table></td></tr><tr><td style='padding:5px' bgcolor=#ffffff><span id='content'></span></td></tr>"),1==showToday&&document.write("<tr class='header'><td style='padding:5px;"+styleAnchor+"' align=center><span id='lblToday'></span></td></tr>"),document.write("</table></div><div id='selectMonth' class='Pagebody' style='z-index:99999;position:absolute;visibility:hidden;'></div><div id='selectYear' class='Pagebody' style='z-index:99999;position:absolute;visibility:hidden;'></div>")),dayName=0==startAt?new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"):new Array("Mon","Tue","Wed","Thu","Fri","Sat","Sun"),document.onkeypress=function(){27==event.keyCode&&hideCalendarControl()},document.onclick=function(){bShow||hideCalendarControl(),bShow=!1},ie?init():window.onload=init();