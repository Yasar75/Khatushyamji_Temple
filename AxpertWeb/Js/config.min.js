/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/var applstJson="",handlerType="",redislstJson="";function OpenSignIn(){window.document.location.href="Signin.aspx"}function TestConnection(){var e=$("#ddldbtype").val();if(""==e)return $("#ddldbtype").focus(),showAlertDialog("error","Database name should not be left empty."),!1;var n=$("#ddldbversion").val();return"ms sql"==e.toLowerCase()&&""==n?($("#ddldbversion").focus(),showAlertDialog("error","Database verion should not be left empty."),!1):""==$("#txtccname").val()?($("#txtccname").focus(),showAlertDialog("error","Connection name should not be left empty."),!1):""==$("#txtusername").val()?($("#txtusername").focus(),showAlertDialog("error","User name should not be left empty."),!1):""==$("#txtPassword").val()?($("#txtPassword").focus(),showAlertDialog("error","Password should not be left empty."),!1):void TestConnectionWs()}function TestConnectionWs(){$.ajax({url:"Config.aspx/AppTestConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({ddldbtype:$("#ddldbtype").val(),ddldbversion:$("#ddldbversion").val(),ddldriver:$("#ddldriver").val(),txtccname:$("#txtccname").val(),txtusername:$("#txtusername").val(),txtPassword:$("#txtPassword").val()}),dataType:"json",contentType:"application/json",success:function(e){if(""!=e.d){var n=$.parseJSON(e.d);"true"==n.result[0].result?(showAlertDialog("success","Test Connection was Successful."),EnableApplyConnection()):showAlertDialog("error",n.result[0].error.msg)}else showAlertDialog("error",e.d)},error:function(e){showAlertDialog("error",e)}})}function EnableApplyConnection(){$("#btnApply").removeAttr("disabled").removeClass("btndisable"),$("#btnChangePassword").removeAttr("disabled").removeClass("btndisable")}function applyconnection(){var e=$("#txtNewConName").val();return""==e?($("#txtNewConName").focus(),showAlertDialog("error","Connection name should not be left empty."),!1):!!new RegExp("^[a-zA-Z0-9]+$").test(e)||($("#txtNewConName").focus(),showAlertDialog("error","Invalid Name - Special characters not allowed."),!1)}function applydbpwdconnection(){var e=$("#txtNewPassword").val();if(""==e)return $("#txtNewPassword").focus(),showAlertDialog("error","Password can not be empty."),!1;var n=$("#txtConfirmPassword").val();return""==n?($("#txtConfirmPassword").focus(),showAlertDialog("error","Confirm Password can not be empty."),!1):e==n||($("#txtNewPassword").focus(),showAlertDialog("error","The password you entered did not match."),!1)}function SuccApplyConnection(e,n){"success"==e?showAlertDialog("success","Connection is created successful."):showAlertDialog("error","Connection Name already exists.")}function SuccPasswordChange(e,n){"success"==e?showAlertDialog("success",n):showAlertDialog("error",n)}function setProjectImages(e){var n="../images/loginlogo.png",t="../AxpImages/login-img.png",o="../AxpImages/login-img.png",l=$(".file-upload[data-type=logo]").parent().parent().find(".profile-pic"),a=$(".file-upload[data-type=webbg]").parent().parent().find(".profile-pic"),s=$(".file-upload[data-type=mobbg]").parent().parent().find(".profile-pic");e?getProjectAppLogo(e,async=!0,function(e){if(null!=e&&e.d){var r=JSON.parse(e.d),i=r.logo,d=r.webbg,c=r.mobbg,p=!1;d&&!c&&(c=d,p=!0),l.prop("src",i?"".concat(i,"?v=").concat((new Date).getTime()):n),a.prop("src",d||t),s.prop("src",c||o),i?l.parent().find(".delete-button").removeClass("d-none"):l.parent().find(".delete-button").addClass("d-none"),d?a.parent().find(".delete-button").removeClass("d-none"):a.parent().find(".delete-button").addClass("d-none"),c&&!p?s.parent().find(".delete-button").removeClass("d-none"):s.parent().find(".delete-button").addClass("d-none")}else l.prop("src",n),a.prop("src",t),s.prop("src",o),l.parent().find(".delete-button").addClass("d-none"),a.parent().find(".delete-button").addClass("d-none"),s.parent().find(".delete-button").addClass("d-none")},function(e){l.prop("src",n),a.prop("src",t),s.prop("src",o),l.parent().find(".delete-button").addClass("d-none"),a.parent().find(".delete-button").addClass("d-none"),s.parent().find(".delete-button").addClass("d-none")}):(l.prop("src",n),a.prop("src",t),s.prop("src",o),l.nextAll(".delete-button").addClass("hide"),a.nextAll(".delete-button").addClass("hide"),s.nextAll(".delete-button").addClass("hide"))}function licActivateCheck(){$("#btnActivate").hasClass("disabledButton")||(""==$("#txtlicappkey").val()?($("#txtlicappkey").focus(),showAlertDialog("error","Please enter license key provided by Agile Labs...")):$("#btnActivateasp").trigger("click"))}function licRefreshCheck(){$("#btnRefresh").hasClass("disabledButton")||$("#btnRefreshasp").trigger("click")}function licTrialCheck(){$("#btnTrial").hasClass("disabledButton")||$("#btnTrialasp").trigger("click")}function offlinelicDownload(){""==$("#txtlicofflinekey").val()?($("#txtlicofflinekey").focus(),showAlertDialog("error","Please enter license key provided by Agile Labs...")):$("#btnDownloadasp").trigger("click")}function LicActivationSucc(e,n){"success"==e?(showAlertDialog("success",n),setTimeout(function(){var e=window.document.location.href;window.document.location.href=e},300)):showAlertDialog("error",n)}function LicDownloadSucc(e,n){"success"==e?(showAlertDialog("success",n),$("#btndownloadfile").trigger("click")):showAlertDialog("error",n)}function closeUploadDialog(){$("#btnFileUpload").prop("disabled",!1),$("#filMyFile").val(""),$("#lblnofilename").text(""),$("#myModalLicUpload").hide()}function uploadLogo(e){for(var n=e.target,t=n.files,o=new FormData,l=0;l<t.length;l++)o.append(t[l].name,t[l]);var a,s=location.origin+location.pathname.substr(0,location.pathname.indexOf("aspx"));$("#axSelectProj").val()?$.ajax({url:s+"ProjectImageUploadHandler.ashx?proj=".concat($("#axSelectProj").val(),"&type=").concat((null==n?void 0:null===(a=n.dataset)||void 0===a?void 0:a.type)||"","&handlertype=").concat(handlerType),type:"POST",data:o,contentType:!1,processData:!1,success:function(e){handlerType="upload",e.indexOf("success")>-1?(setProjectImages($("#axSelectProj").val()),showAlertDialog("success",e)):e.indexOf("size")>-1||e.indexOf("select")?showAlertDialog("warning",e):(e.indexOf("error"),showAlertDialog("error",e)),$(n).val("")},error:function(e){handlerType="upload",showAlertDialog("error",e.statusText),$(n).val("")}}):(handlerType="upload",showAlertDialog("error","Project Name should be selected"))}function AuthenticateUser(){return""==$("#txtAuthUsername").val()?($("#txtAuthUsername").focus(),showAlertDialog("error","User name should not be left empty."),!1):""==$("#txtAuthPwd").val()?($("#txtAuthPwd").focus(),showAlertDialog("error","Password should not be left empty."),!1):void $.ajax({url:"Config.aspx/UserAuthentication",type:"POST",cache:!1,async:!0,data:JSON.stringify({AuthUsername:$("#txtAuthUsername").val(),AuthPwd:$("#txtAuthPwd").val()}),dataType:"json",contentType:"application/json",success:function(e){if($("#configbody").removeClass("m-auto"),$("#main_body").removeAttr("style"),""!=e.d){var n=window.document.location.href;if(n.indexOf("?")>-1){var t=n.split("?")[1];if(t.indexOf("auth=")>-1){var o="";t.split("&").forEach(function(e){-1==e.indexOf("auth=")&&(o+=e+"&")}),window.document.location.href="config.aspx?"+o+"auth="+e.d}else window.document.location.href=n+"&auth="+e.d}else window.document.location.href="config.aspx?auth="+e.d}else showAlertDialog("error","Incorrect credentials. please try again!")},error:function(e){showAlertDialog("error",e)}})}function initUiPanel(){$("#axSelectProj").val(selProj),setProjectImages(selProj);$("#lstconnection option").toArray().map(function(e){return{label:e.value,value:e.value,link:""}});$("#axSelectProj").select2({data:applstJson})}function applyRedisconnection(){return""==$("#txtrhotname").val()?($("#txtrhotname").focus(),showAlertDialog("error","Host name should not be left empty."),!1):""==$("#txtrport").val()?($("#txtrport").focus(),showAlertDialog("error","Port should not be left empty."),!1):""==$("#txtrpwd").val()?($("#txtrpwd").focus(),showAlertDialog("error","Password should not be left empty."),!1):void TestRedisConnectionWs()}function EnableRedisApplyConnection(){$("#btnRedisApply").removeAttr("disabled").removeClass("btndisable")}function SuccRedisConnection(e){"success"==e?showAlertDialog("success","Connection is created successful."):showAlertDialog("error","Connection Name already exists.")}function TestRedisConnectionWs(){$.ajax({url:"Config.aspx/RedisTestConnection",type:"POST",cache:!1,async:!0,data:JSON.stringify({rHost:$("#txtrhotname").val(),rPort:$("#txtrport").val(),rPwd:$("#txtrpwd").val()}),dataType:"json",contentType:"application/json",success:function(e){""!=e.d&&"true"==e.d?(showAlertDialog("success","Test Connection was Successful."),EnableRedisApplyConnection()):(showAlertDialog("error","Test Connection failed."),$("#btnRedisApply").attr("disabled","true").addClass("btndisable"))},error:function(e){showAlertDialog("error",e)}})}function CreateRedisConnection(){var e=$("#txtRedisNewConn").val();return""==e?($("#txtRedisNewConn").focus(),showAlertDialog("error","Connection name should not be left empty."),!1):new RegExp("^[a-zA-Z0-9]+$").test(e)?void 0:($("#txtRedisNewConn").focus(),showAlertDialog("error","Invalid Name - Special characters not allowed."),!1)}$j(document).ready(function(){if($("#lstconnection").select2(),$("#lstRconnection").select2(),$("#ddldbtype").select2(),$("#ddldbversion").select2(),$("#lstconnection").val(selProj).trigger("change"),$("#btnaddcon").click(function(){$("#lstconnection").val("").trigger("change"),$("#ddldbtype").val("").trigger("change"),$("#ddldbversion").val("").trigger("change")}),"false"==IsLicExist?($("#dvlicmessage").show(),$("#btnRefresh").hide(),$("#btnActivate").show(),$("#btnTrial").show(),$(".licActOptions").show(),$("#dvdbConnection").addClass("disabledDiv")):($("#dvlicmessage").hide(),$(".licActOptions").hide(),$("#btnRefresh").show(),$("#btnActivate").hide(),$("#btnTrial").hide(),$("#dvdbConnection").removeClass("disabledDiv")),redislist=ReverseCheckSpecialChars(redislist),""!=redislist){var e=parseXml(redislist);if(""!=(redislstJson=JSON.parse(xml2json(e,"")))){var n=$("#lstRconnection option:first").val();if(void 0!==n){var t=redislstJson.axp_rconn[n].host,o=redislstJson.axp_rconn[n].port;redislstJson.axp_rconn[n].pwd;$("#txtrhotname").val(t),$("#txtrport").val(o),$("#txtrpwd").val(""),$("#lstRconnection").val(n),$("#lstRconnection").trigger("change")}}}if($("#ddldbversion").val(i).prop("disabled",!0),applist=ReverseCheckSpecialChars(applist),""!=applist){var l=parseXml(applist);if(applstJson=JSON.parse(xml2json(l,"")),""!=selProj&&""!=applstJson){$("#lstconnection").val(selProj).focus();var a=applstJson.connections[selProj].db,s=applstJson.connections[selProj].dbcon,r=applstJson.connections[selProj].dbuser,i=null==applstJson.connections[selProj].version?"":applstJson.connections[selProj].version,d=applstJson.connections[selProj].driver;$("#lblconname").text(selProj),$("#ddldbtype").val(a).trigger("change"),"MS SQL"!=a.toString()&&$(".databasever").addClass("d-none"),""!=i?$("#ddldbversion").val(i).prop("disabled",!1):$("#ddldbversion").val(i).prop("disabled",!0),$("#txtccname").val(s),$("#txtusername").val(r),$("#ddldriver").val(d)}else if(""!=applstJson){var c=$("#lstconnection option:first").val();if(void 0!==c){$("#lstconnection").val(c).focus();a=applstJson.connections[c].db,s=applstJson.connections[c].dbcon,r=applstJson.connections[c].dbuser,i=null==applstJson.connections[c].version?"":applstJson.connections[c].version,d=applstJson.connections[c].driver;$("#lblconname").text(c),$("#ddldbtype").val(a).trigger("change"),""!=i?$("#ddldbversion").val(i).prop("disabled",!1):$("#ddldbversion").val(i).prop("disabled",!0),$("#txtccname").val(s),$("#txtusername").val(r),$("#ddldriver").val(d)}}}$(document).on("click",".upload-button",function(e){try{if(""==$("#axSelectProj").val())return showAlertDialog("warning","Please Select UI Configuration Project"),$("#axSelectProj").focus(),e.preventDefault(),e.stopPropagation(),!1;handlerType="upload",$(e.currentTarget).nextAll(".file-upload").trigger("click")}catch(n){}}),$(document).on("click",".delete-button",function(e){try{if(""==$("#axSelectProj").val())return showAlertDialog("warning","Please Select UI Configuration Project"),$("#axSelectProj").focus(),e.preventDefault(),e.stopPropagation(),!1;handlerType="delete",$(e.currentTarget).parent().find(".file-upload").trigger("change")}catch(n){}}),$(document).on("change",".file-upload",function(e){uploadLogo(e)}),$("#ddlIsNewConnection").val("new"),$("#txtNewConName").val(""),$("#ddlIsRedisNewConnection").val("new"),$("#txtRedisNewConn").val(""),$("#demo").on("hide.bs.collapse",function(){$(".licInfoAccordion").html('<span class="material-icons">expand_more</span>')}),$("#demo").on("show.bs.collapse",function(){$(".licInfoAccordion").html('<span class="material-icons">expand_less</span>')}),"false"==IsLicExist&&($("#demo").addClass("in"),$(".licInfoAccordion").html('<span class="material-icons">expand_less</span>')),$("#filMyFile").bind({change:function(){var e=$("#filMyFile").val();/^\s*$/.test(e)?($(".file-upload").removeClass("active"),$("#lblfuerror").text("No file chosen...")):$(".file-upload").addClass("active");var n=e.split(".").pop().toLowerCase();-1==$.inArray(n,["lic"])?($("#btnFileUpload").prop("disabled",!0),$("#lblfuerror").text("Invalid file format.")):($("#btnFileUpload").prop("disabled",!1),$("#lblfuerror").text(""));var t=$("#filMyFile")[0].files;t.length>0&&$("#lblnofilename").text(t[0].name)}}),"true"==authPopup&&$("#myModalAuth").show(),initUiPanel()}),$j(document).on("click","#lstconnection option",function(e){var n=$(this).val();if(""!=applstJson){var t=applstJson.connections[n].db,o=applstJson.connections[n].dbcon,l=applstJson.connections[n].dbuser,a=null==applstJson.connections[n].version?"":applstJson.connections[n].version,s=applstJson.connections[n].driver;$("#lblconname").text(n),$("#ddldbtype").val(t),""!=t&&$("#ddldbtype").val(t).trigger("change"),""!=a?($("#ddldbversion").val(a).prop("disabled",!1),$("#ddldbversion").val(a).trigger("change")):$("#ddldbversion").val(a).prop("disabled",!0),$("#txtccname").val(o),$("#txtusername").val(l),$("#ddldriver").val(s)}}),$j(document).on("change","#lstconnection",function(e){var n=$(this).val();if(""!=applstJson){var t=applstJson.connections[n].db,o=applstJson.connections[n].dbcon,l=applstJson.connections[n].dbuser,a=null==applstJson.connections[n].version?"":applstJson.connections[n].version,s=applstJson.connections[n].driver;$("#lblconname").text(n),$("#ddldbtype").val(t),$("#ddldbtype").trigger("change"),""!=t&&$("#ddldbtype").val(t).trigger("change"),"ms sql"!=t.toString().toLowerCase()?($("#ddldbversion").val("").trigger("change"),$(".databasever").addClass("d-none")):$(".databasever").removeClass("d-none"),""!=a?($("#ddldbversion").val(a).prop("disabled",!1),$("#ddldbversion").val(a).trigger("change")):$("#ddldbversion").val(a).prop("disabled",!0),$("#txtccname").val(o),$("#txtusername").val(l),$("#ddldriver").val(s)}}),$j(document).on("click","#btnApply",function(e){null==$("#lstconnection").val()||""==$("#lstconnection").val()?($("#ddlIsNewConnection").val("new"),$("#myModal").modal("show")):($("#ddlIsNewConnection").val("old"),$("#txtNewConName").val($("#lstconnection").val()),$("#btnok").click())}),$j(document).on("click","#btnChangePassword",function(e){$("#myModaldbpassword").modal("show")}),$j(document).on("click","#btnCancel",function(e){window.document.location.href="signin.aspx"}),$j(document).on("click","#btnaddcon",function(e){$("#ddldbtype").prop("selectedIndex",0),$("#ddldbversion").prop("selectedIndex",0).prop("disabled",!0),$(".databasever").removeClass("d-none"),$("#ddldriver").prop("selectedIndex",0),$("#lblconname").text(""),$("#txtccname").val(""),$("#txtusername").val(""),$("#lstconnection").val(""),$("#txtPassword").val(""),$("#txtNewPassword").val(""),$("#txtConfirmPassword").val("")}),$j(document).on("click","#btncdelete",function(e){var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[512]")),buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){$j("#btndelete").click()}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}})}),$j(document).on("change","#ddldbtype",function(e){"MS SQL"==$(this).val()?($("#ddldbversion").prop("disabled",!1),$("#ddldriver").val("ado")):($("#ddldbversion").val("").prop("disabled",!0),$("#ddldriver").val("dbx"))}),$j(document).on("click","#btnlicactivation",function(e){window.document.location.href="licactivation.aspx"}),$j(document).on("click","#btnnewcancel,#myModalclose",function(e){$("#myModal").hide(),$("#btnApply").attr("disabled",!0).addClass("btndisable"),$("#btnChangePassword").attr("disabled",!0).addClass("btndisable")}),$j(document).on("click","#btndbpwdcancel,#myModaldbpasswordclose",function(e){$("#myModaldbpassword").hide(),$("#btnApply").attr("disabled",!0).addClass("btndisable"),$("#btnChangePassword").attr("disabled",!0).addClass("btndisable")}),$j(document).on("click","#btnUpload",function(e){$("#myModalLicUpload").show()}),$j(document).on("change","#rbllictype input",function(e){switch($(this).val()){case"offline":$("#dvOffline").show(),$("#dvOnline").hide();break;default:$("#dvOffline").hide(),$("#dvOnline").show()}}),$j(document).on("click","#btnAuthCancel,#myModalAuthClose",function(e){window.document.location.href="signin.aspx"}),$j(document).on("click","#btnRedisApply",function(e){null==$("#lstRconnection").val()||""==$("#lstRconnection").val()?($("#ddlIsRedisNewConnection").val("new"),$("#myModalRedis").modal("show")):($("#ddlIsRedisNewConnection").val("old"),$("#txtRedisNewConn").val($("#lstRconnection").val()),$("#btnRedisOk").click())}),$j(document).on("click","#lstRconnection option",function(e){var n=$(this).val();if(""!=redislstJson){var t=redislstJson.axp_rconn[n].host,o=redislstJson.axp_rconn[n].port;redislstJson.axp_rconn[n].pwd;$("#txtrhotname").val(t),$("#txtrport").val(o),$("#txtrpwd").val("")}}),$j(document).on("change","#lstRconnection",function(e){var n=$(this).val();if(""!=redislstJson&&null!=n){var t=redislstJson.axp_rconn[n].host,o=redislstJson.axp_rconn[n].port;redislstJson.axp_rconn[n].pwd;$("#txtrhotname").val(t),$("#txtrport").val(o),$("#txtrpwd").val("")}}),$j(document).on("click","#btnRedisAdd",function(e){$("#txtrhotname").val(""),$("#txtrport").val(""),$("#txtrpwd").val(""),$("#lstRconnection").val("").trigger("change")}),$j(document).on("click","#btnRcdelete",function(e){var conDelete=$.confirm({closeIcon:!1,title:"Confirm",escapeKey:"buttonB",theme:"modern",onContentReady:function(){disableBackDrop("bind")},content:eval(callParent("lcm[522]")),buttons:{buttonA:{text:eval(callParent("lcm[279]")),btnClass:"btn btn-primary",action:function(){$j("#btnRedisdelete").click()}},buttonB:{text:eval(callParent("lcm[280]")),btnClass:"btn btn-bg-light btn-color-danger btn-active-light-danger",action:function(){disableBackDrop("destroy")}}}})}),$j(document).on("click","#btnrnewcancel,#myModalRedisclose",function(e){$("#myModalRedis").modal("hide")});