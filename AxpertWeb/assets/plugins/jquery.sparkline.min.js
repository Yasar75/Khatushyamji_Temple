(function(b){typeof define=="function"&&define.amd?define(["jquery"],b):b(jQuery)})(function(ar){var aq={},ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,ac,aa,Y,W,U,S,Q,O,M,K,J,ab,Z,X,V,T,R,P,N,L=0;ap=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:undefined,normalRangeMax:undefined,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:undefined,chartRangeMax:undefined,chartRangeMinX:undefined,chartRangeMaxX:undefined,tooltipFormat:new an('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:undefined,nullColor:undefined,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:undefined,chartRangeMin:undefined,chartRangeClip:!1,colorMap:undefined,tooltipFormat:new an('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new an('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:undefined,thresholdValue:0,chartRangeMax:undefined,chartRangeMin:undefined,chartRangeClip:!1,tooltipFormat:new an("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:undefined,tooltipFormat:new an("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new an('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:undefined,targetColor:"#4a2",chartRangeMax:undefined,chartRangeMin:undefined,tooltipFormat:new an("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},Z='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',ao=function(){var a,d;return a=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(a.prototype=ar.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],arguments.length>2&&(d=Array.prototype.slice.call(arguments,1,-1),d.unshift(a.prototype),ar.extend.apply(ar,d))):a.prototype=arguments[0],a.prototype.cls=a,a},ar.SPFormatClass=an=ao({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(d,c){this.format=d,this.fclass=c},render:function(t,s,r){var q=this,p=t,o,n,m,l,k;return this.format.replace(this.fre,function(){var b;return n=arguments[1],m=arguments[3],o=q.precre.exec(n),o?(k=o[2],n=o[1]):k=!1,l=p[n],l===undefined?"":m&&s&&s[m]?(b=s[m],b.get?s[m].get(l)||l:s[m][l]||l):(ah(l)&&(r.get("numberFormatter")?l=r.get("numberFormatter")(l):l=ac(l,k,r.get("numberDigitGroupCount"),r.get("numberDigitGroupSep"),r.get("numberDecimalMark"))),l)})}}),ar.spformat=function(d,c){return new an(d,c)},am=function(e,d,f){return e<d?d:e>f?f:e},al=function(e,d){var f;return d===2?(f=Math.floor(e.length/2),e.length%2?e[f]:(e[f-1]+e[f])/2):e.length%2?(f=(e.length*d+d)/4,f%1?(e[Math.floor(f)]+e[Math.floor(f)-1])/2:e[f-1]):(f=(e.length*d+2)/4,f%1?(e[Math.floor(f)]+e[Math.floor(f)-1])/2:e[f-1])},ak=function(d){var c;switch(d){case"undefined":d=undefined;break;case"null":d=null;break;case"true":d=!0;break;case"false":d=!1;break;default:c=parseFloat(d),d==c&&(d=c)}return d},aj=function(e){var d,f=[];for(d=e.length;d--;){f[d]=ak(e[d])}return f},ai=function(g,f){var j,i,h=[];for(j=0,i=g.length;j<i;j++){g[j]!==f&&h.push(g[j])}return h},ah=function(b){return !isNaN(parseFloat(b))&&isFinite(b)},ac=function(a,n,m,l,k){var j,i;a=(n===!1?parseFloat(a).toString():a.toFixed(n)).split(""),j=(j=ar.inArray(".",a))<0?a.length:j,j<a.length&&(a[j]=k);for(i=j-m;i>0;i-=m){a.splice(i,0,l)}return a.join("")},ag=function(f,e,h){var g;for(g=e.length;g--;){if(h&&e[g]===null){continue}if(e[g]!==f){return !1}}return !0},af=function(e){var d=0,f;for(f=e.length;f--;){d+=typeof e[f]=="number"?e[f]:0}return d},ad=function(a){return ar.isArray(a)?a:[a]},ae=function(d){var c;document.createStyleSheet?document.createStyleSheet().cssText=d:(c=document.createElement("style"),c.type="text/css",document.getElementsByTagName("head")[0].appendChild(c),c[typeof document.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=d)},ar.fn.simpledraw=function(a,l,k,j){var i,h;if(k&&(i=this.data("_jqs_vcanvas"))){return i}a===undefined&&(a=ar(this).innerWidth()),l===undefined&&(l=ar(this).innerHeight());if(ar.fn.sparkline.hasCanvas){i=new R(a,l,this,j)}else{if(!ar.fn.sparkline.hasVML){return !1}i=new P(a,l,this)}return h=ar(this).data("_jqs_mhandler"),h&&h.registerCanvas(i),i},ar.fn.cleardraw=function(){var b=this.data("_jqs_vcanvas");b&&b.reset()},ar.RangeMapClass=aa=ao({init:function(f){var e,h,g=[];for(e in f){f.hasOwnProperty(e)&&typeof e=="string"&&e.indexOf(":")>-1&&(h=e.split(":"),h[0]=h[0].length===0?-Infinity:parseFloat(h[0]),h[1]=h[1].length===0?Infinity:parseFloat(h[1]),h[2]=f[e],g.push(h))}this.map=f,this.rangelist=g||!1},get:function(g){var f=this.rangelist,j,i,h;if((h=this.map[g])!==undefined){return h}if(f){for(j=f.length;j--;){i=f[j];if(i[0]<=g&&i[1]>=g){return i[2]}}}return undefined}}),ar.range_map=function(b){return new aa(b)},Y=ao({init:function(a,f){var e=ar(a);this.$el=e,this.options=f,this.currentPageX=0,this.currentPageY=0,this.el=a,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!f.get("disableTooltips"),this.highlightEnabled=!f.get("disableHighlight")},registerSparkline:function(b){this.splist.push(b),this.over&&this.updateDisplay()},registerCanvas:function(a){var d=ar(a.canvas);this.canvas=a,this.$canvas=d,d.mouseenter(ar.proxy(this.mouseenter,this)),d.mouseleave(ar.proxy(this.mouseleave,this)),d.click(ar.proxy(this.mouseclick,this))},reset:function(b){this.splist=[],this.tooltip&&b&&(this.tooltip.remove(),this.tooltip=undefined)},mouseclick:function(a){var d=ar.Event("sparklineClick");d.originalEvent=a,d.sparklines=this.splist,this.$el.trigger(d)},mouseenter:function(a){ar(document.body).unbind("mousemove.jqs"),ar(document.body).bind("mousemove.jqs",ar.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=a.pageX,this.currentPageY=a.pageY,this.currentEl=a.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new W(this.options),this.tooltip.updatePosition(a.pageX,a.pageY)),this.updateDisplay()},mouseleave:function(){ar(document.body).unbind("mousemove.jqs");var a=this.splist,j=a.length,i=!1,h,g;this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(g=0;g<j;g++){h=a[g],h.clearRegionHighlight()&&(i=!0)}i&&this.canvas.render()},mousemove:function(b){this.currentPageX=b.pageX,this.currentPageY=b.pageY,this.currentEl=b.target,this.tooltip&&this.tooltip.updatePosition(b.pageX,b.pageY),this.updateDisplay()},updateDisplay:function(){var v=this.splist,u=v.length,t=!1,s=this.$canvas.offset(),r=this.currentPageX-s.left,q=this.currentPageY-s.top,p,o,n,m,a;if(!this.over){return}for(n=0;n<u;n++){o=v[n],m=o.setRegionHighlight(this.currentEl,r,q),m&&(t=!0)}if(t){a=ar.Event("sparklineRegionChange"),a.sparklines=this.splist,this.$el.trigger(a);if(this.tooltip){p="";for(n=0;n<u;n++){o=v[n],p+=o.getCurrentRegionTooltip()}this.tooltip.setContent(p)}this.disableHighlight||this.canvas.render()}m===null&&this.mouseleave()}}),W=ao({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(a){var h=a.get("tooltipClassname","jqstooltip"),g=this.sizeStyle,f;this.container=a.get("tooltipContainer")||document.body,this.tooltipOffsetX=a.get("tooltipOffsetX",10),this.tooltipOffsetY=a.get("tooltipOffsetY",12),ar("#jqssizetip").remove(),ar("#jqstooltip").remove(),this.sizetip=ar("<div/>",{id:"jqssizetip",style:g,"class":h}),this.tooltip=ar("<div/>",{id:"jqstooltip","class":h}).appendTo(this.container),f=this.tooltip.offset(),this.offsetLeft=f.left,this.offsetTop=f.top,this.hidden=!0,ar(window).unbind("resize.jqs scroll.jqs"),ar(window).bind("resize.jqs scroll.jqs",ar.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=ar(window).scrollTop(),this.scrollLeft=ar(window).scrollLeft(),this.scrollRight=this.scrollLeft+ar(window).width(),this.updatePosition()},getSize:function(b){this.sizetip.html(b).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(b){if(!b){this.tooltip.css("visibility","hidden"),this.hidden=!0;return}this.getSize(b),this.tooltip.html(b).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(d,c){if(d===undefined){if(this.mousex===undefined){return}d=this.mousex-this.offsetLeft,c=this.mousey-this.offsetTop}else{this.mousex=d-=this.offsetLeft,this.mousey=c-=this.offsetTop}if(!this.height||!this.width||this.hidden){return}c-=this.height+this.tooltipOffsetY,d+=this.tooltipOffsetX,c<this.scrollTop&&(c=this.scrollTop),d<this.scrollLeft?d=this.scrollLeft:d+this.width>this.scrollRight&&(d=this.scrollRight-this.width),this.tooltip.css({left:d,top:c})},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=undefined,ar(window).unbind("resize.jqs scroll.jqs")}}),X=function(){ae(Z)},ar(X),N=[],ar.fn.sparkline=function(a,d){return this.each(function(){var i=new ar.fn.sparkline.options(this,d),h=ar(this),c,b;c=function(){var q,p,o,n,m,l,e;if(a==="html"||a===undefined){e=this.getAttribute(i.get("tagValuesAttribute"));if(e===undefined||e===null){e=h.html()}q=e.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{q=a}p=i.get("width")==="auto"?q.length*i.get("defaultPixelsPerValue"):i.get("width");if(i.get("height")==="auto"){if(!i.get("composite")||!ar.data(this,"_jqs_vcanvas")){n=document.createElement("span"),n.innerHTML="a",h.html(n),o=ar(n).innerHeight()||ar(n).height(),ar(n).remove(),n=null}}else{o=i.get("height")}i.get("disableInteraction")?m=!1:(m=ar.data(this,"_jqs_mhandler"),m?i.get("composite")||m.reset():(m=new Y(this,i),ar.data(this,"_jqs_mhandler",m)));if(i.get("composite")&&!ar.data(this,"_jqs_vcanvas")){ar.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),ar.data(this,"_jqs_errnotify",!0));return}l=new (ar.fn.sparkline[i.get("type")])(this,q,i,p,o),l.render(),m&&m.registerSparkline(l)};if(ar(this).html()&&!i.get("disableHiddenCheck")&&ar(this).is(":hidden")||ar.fn.jquery<"1.3.0"&&ar(this).parents().is(":hidden")||!ar(this).parents("body").length){if(!i.get("composite")&&ar.data(this,"_jqs_pending")){for(b=N.length;b;b--){N[b-1][0]==this&&N.splice(b-1,1)}}N.push([this,c]),ar.data(this,"_jqs_pending",!0)}else{c.call(this)}})},ar.fn.sparkline.defaults=ap(),ar.sparkline_display_visible=function(){var a,h,g,f=[];for(h=0,g=N.length;h<g;h++){a=N[h][0],ar(a).is(":visible")&&!ar(a).parents().is(":hidden")?(N[h][1].call(a),ar.data(N[h][0],"_jqs_pending",!1),f.push(h)):!ar(a).closest("html").length&&!ar.data(a,"_jqs_pending")&&(ar.data(N[h][0],"_jqs_pending",!1),f.push(h))}for(h=f.length;h;h--){N.splice(f[h-1],1)}},ar.fn.sparkline.options=ao({init:function(l,k){var j,i,b,a;this.userOptions=k=k||{},this.tag=l,this.tagValCache={},i=ar.fn.sparkline.defaults,b=i.common,this.tagOptionsPrefix=k.enableTagOptions&&(k.tagOptionsPrefix||b.tagOptionsPrefix),a=this.getTagSetting("type"),a===aq?j=i[k.type||b.type]:j=i[a],this.mergedOptions=ar.extend({},b,j,k)},getTagSetting:function(b){var l=this.tagOptionsPrefix,k,j,i,h;if(l===!1||l===undefined){return aq}if(this.tagValCache.hasOwnProperty(b)){k=this.tagValCache.key}else{k=this.tag.getAttribute(l+b);if(k===undefined||k===null){k=aq}else{if(k.substr(0,1)==="["){k=k.substr(1,k.length-2).split(",");for(j=k.length;j--;){k[j]=ak(k[j].replace(/(^\s*)|(\s*$)/g,""))}}else{if(k.substr(0,1)==="{"){i=k.substr(1,k.length-2).split(","),k={};for(j=i.length;j--;){h=i[j].split(":",2),k[h[0].replace(/(^\s*)|(\s*$)/g,"")]=ak(h[1].replace(/(^\s*)|(\s*$)/g,""))}}else{k=ak(k)}}}this.tagValCache.key=k}return k},get:function(b,h){var g=this.getTagSetting(b),f;return g!==aq?g:(f=this.mergedOptions[b])===undefined?h:f}}),ar.fn.sparkline._base=ao({disabled:!1,init:function(a,j,i,h,g){this.el=a,this.$el=ar(a),this.values=j,this.options=i,this.width=h,this.height=g,this.currentRegion=undefined},initTarget:function(){var b=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),b))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(d,c){},setRegionHighlight:function(h,g,l){var k=this.currentRegion,j=!this.options.get("disableHighlight"),i;return g>this.canvasWidth||l>this.canvasHeight||g<0||l<0?null:(i=this.getRegion(h,g,l),k!==i?(k!==undefined&&j&&this.removeHighlight(),this.currentRegion=i,i!==undefined&&j&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==undefined?(this.removeHighlight(),this.currentRegion=undefined,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(b){},getCurrentRegionTooltip:function(){var G=this.options,F="",E=[],D,C,B,A,z,y,x,w,v,u,t,e,a,H;if(this.currentRegion===undefined){return""}D=this.getCurrentRegionFields(),t=G.get("tooltipFormatter");if(t){return t(this,G,D)}G.get("tooltipChartTitle")&&(F+='<div class="jqs jqstitle">'+G.get("tooltipChartTitle")+"</div>\n"),C=this.options.get("tooltipFormat");if(!C){return""}ar.isArray(C)||(C=[C]),ar.isArray(D)||(D=[D]),x=this.options.get("tooltipFormatFieldlist"),w=this.options.get("tooltipFormatFieldlistKey");if(x&&w){v=[];for(y=D.length;y--;){u=D[y][w],(H=ar.inArray(u,x))!=-1&&(v[H]=D[y])}D=v}B=C.length,a=D.length;for(y=0;y<B;y++){e=C[y],typeof e=="string"&&(e=new an(e)),A=e.fclass||"jqsfield";for(H=0;H<a;H++){if(!D[H].isNull||!G.get("tooltipSkipNull")){ar.extend(D[H],{prefix:G.get("tooltipPrefix"),suffix:G.get("tooltipSuffix")}),z=e.render(D[H],G.get("tooltipValueLookups"),G),E.push('<div class="'+A+'">'+z+"</div>")}}}return E.length?F+E.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(j,f){var p=f.get("highlightColor"),o=f.get("highlightLighten"),n,m,l,k;if(p){return p}if(o){n=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(j)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(j);if(n){l=[],m=j.length===4?16:1;for(k=0;k<3;k++){l[k]=am(Math.round(parseInt(n[k+1],16)*m*o),0,255)}return"rgb("+l.join(",")+")"}}return j}}),U={changeHighlight:function(a){var j=this.currentRegion,i=this.target,h=this.regionShapes[j],g;h&&(g=this.renderRegion(j,a),ar.isArray(g)||ar.isArray(h)?(i.replaceWithShapes(h,g),this.regionShapes[j]=ar.map(g,function(b){return b.id})):(i.replaceWithShape(h,g),this.regionShapes[j]=g.id))},render:function(){var a=this.values,n=this.target,m=this.regionShapes,l,k,j,i;if(!this.cls._super.render.call(this)){return}for(j=a.length;j--;){l=this.renderRegion(j);if(l){if(ar.isArray(l)){k=[];for(i=l.length;i--;){l[i].append(),k.push(l[i].id)}m[j]=k}else{l.append(),m[j]=l.id}}else{m[j]=null}}n.render()}},ar.fn.sparkline.line=S=ao(ar.fn.sparkline._base,{type:"line",init:function(g,f,j,i,h){S._super.init.call(this,g,f,j,i,h),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(g,f,j){var i,h=this.regionMap;for(i=h.length;i--;){if(h[i]!==null&&f>=h[i][0]&&f<=h[i][1]){return h[i][2]}}return undefined},getCurrentRegionFields:function(){var b=this.currentRegion;return{isNull:this.yvalues[b]===null,x:this.xvalues[b],y:this.yvalues[b],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:b}},renderHighlight:function(){var r=this.currentRegion,q=this.target,p=this.vertices[r],o=this.options,n=o.get("spotRadius"),m=o.get("highlightSpotColor"),l=o.get("highlightLineColor"),k,j;if(!p){return}n&&m&&(k=q.drawCircle(p[0],p[1],n,undefined,m),this.highlightSpotId=k.id,q.insertAfterShape(this.lastShapeId,k)),l&&(j=q.drawLine(p[0],this.canvasTop,p[0],this.canvasTop+this.canvasHeight,l),this.highlightLineId=j.id,q.insertAfterShape(this.lastShapeId,j))},removeHighlight:function(){var b=this.target;this.highlightSpotId&&(b.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(b.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var t=this.values,s=t.length,r=this.xvalues,q=this.yvalues,p=this.yminmax,o,n,m,l,k;for(o=0;o<s;o++){n=t[o],m=typeof t[o]=="string",l=typeof t[o]=="object"&&t[o] instanceof Array,k=m&&t[o].split(":"),m&&k.length===2?(r.push(Number(k[0])),q.push(Number(k[1])),p.push(Number(k[1]))):l?(r.push(n[0]),q.push(n[1]),p.push(n[1])):(r.push(o),t[o]===null||t[o]==="null"?q.push(null):(q.push(Number(n)),p.push(Number(n))))}this.options.get("xvalues")&&(r=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,p),this.miny=this.minyorg=Math.min.apply(Math,p),this.maxx=Math.max.apply(Math,r),this.minx=Math.min.apply(Math,r),this.xvalues=r,this.yvalues=q,this.yminmax=p},processRangeOptions:function(){var e=this.options,d=e.get("normalRangeMin"),f=e.get("normalRangeMax");d!==undefined&&(d<this.miny&&(this.miny=d),f>this.maxy&&(this.maxy=f)),e.get("chartRangeMin")!==undefined&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),e.get("chartRangeMax")!==undefined&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),e.get("chartRangeMinX")!==undefined&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),e.get("chartRangeMaxX")!==undefined&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(r,q,p,o,n){var m=this.options.get("normalRangeMin"),l=this.options.get("normalRangeMax"),k=q+Math.round(p-p*((l-this.miny)/n)),j=Math.round(p*(l-m)/n);this.target.drawRect(r,k,o,j,undefined,this.options.get("normalRangeColor")).append()},render:function(){var aV=this.options,aU=this.target,aT=this.canvasWidth,aS=this.canvasHeight,aR=this.vertices,aQ=aV.get("spotRadius"),aP=this.regionMap,aO,aN,aM,aL,aK,aJ,aI,aH,aE,aC,aA,ax,av,at,q,a,aG,aF,aD,aB,az,ay,aw,au,u;if(!S._super.render.call(this)){return}this.scanValues(),this.processRangeOptions(),aw=this.xvalues,au=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}aL=aK=0,aO=this.maxx-this.minx===0?1:this.maxx-this.minx,aN=this.maxy-this.miny===0?1:this.maxy-this.miny,aM=this.yvalues.length-1,aQ&&(aT<aQ*4||aS<aQ*4)&&(aQ=0);if(aQ){az=aV.get("highlightSpotColor")&&!aV.get("disableInteraction");if(az||aV.get("minSpotColor")||aV.get("spotColor")&&au[aM]===this.miny){aS-=Math.ceil(aQ)}if(az||aV.get("maxSpotColor")||aV.get("spotColor")&&au[aM]===this.maxy){aS-=Math.ceil(aQ),aL+=Math.ceil(aQ)}if(az||(aV.get("minSpotColor")||aV.get("maxSpotColor"))&&(au[0]===this.miny||au[0]===this.maxy)){aK+=Math.ceil(aQ),aT-=Math.ceil(aQ)}if(az||aV.get("spotColor")||aV.get("minSpotColor")||aV.get("maxSpotColor")&&(au[aM]===this.miny||au[aM]===this.maxy)){aT-=Math.ceil(aQ)}}aS--,aV.get("normalRangeMin")!==undefined&&!aV.get("drawNormalOnTop")&&this.drawNormalRange(aK,aL,aS,aT,aN),aI=[],aH=[aI],at=q=null,a=au.length;for(u=0;u<a;u++){aE=aw[u],aA=aw[u+1],aC=au[u],ax=aK+Math.round((aE-this.minx)*(aT/aO)),av=u<a-1?aK+Math.round((aA-this.minx)*(aT/aO)):aT,q=ax+(av-ax)/2,aP[u]=[at||0,q,u],at=q,aC===null?u&&(au[u-1]!==null&&(aI=[],aH.push(aI)),aR.push(null)):(aC<this.miny&&(aC=this.miny),aC>this.maxy&&(aC=this.maxy),aI.length||aI.push([ax,aL+aS]),aJ=[ax,aL+Math.round(aS-aS*((aC-this.miny)/aN))],aI.push(aJ),aR.push(aJ))}aG=[],aF=[],aD=aH.length;for(u=0;u<aD;u++){aI=aH[u],aI.length&&(aV.get("fillColor")&&(aI.push([aI[aI.length-1][0],aL+aS]),aF.push(aI.slice(0)),aI.pop()),aI.length>2&&(aI[0]=[aI[0][0],aI[1][1]]),aG.push(aI))}aD=aF.length;for(u=0;u<aD;u++){aU.drawShape(aF[u],aV.get("fillColor"),aV.get("fillColor")).append()}aV.get("normalRangeMin")!==undefined&&aV.get("drawNormalOnTop")&&this.drawNormalRange(aK,aL,aS,aT,aN),aD=aG.length;for(u=0;u<aD;u++){aU.drawShape(aG[u],aV.get("lineColor"),undefined,aV.get("lineWidth")).append()}if(aQ&&aV.get("valueSpots")){aB=aV.get("valueSpots"),aB.get===undefined&&(aB=new aa(aB));for(u=0;u<a;u++){ay=aB.get(au[u]),ay&&aU.drawCircle(aK+Math.round((aw[u]-this.minx)*(aT/aO)),aL+Math.round(aS-aS*((au[u]-this.miny)/aN)),aQ,undefined,ay).append()}}aQ&&aV.get("spotColor")&&au[aM]!==null&&aU.drawCircle(aK+Math.round((aw[aw.length-1]-this.minx)*(aT/aO)),aL+Math.round(aS-aS*((au[aM]-this.miny)/aN)),aQ,undefined,aV.get("spotColor")).append(),this.maxy!==this.minyorg&&(aQ&&aV.get("minSpotColor")&&(aE=aw[ar.inArray(this.minyorg,au)],aU.drawCircle(aK+Math.round((aE-this.minx)*(aT/aO)),aL+Math.round(aS-aS*((this.minyorg-this.miny)/aN)),aQ,undefined,aV.get("minSpotColor")).append()),aQ&&aV.get("maxSpotColor")&&(aE=aw[ar.inArray(this.maxyorg,au)],aU.drawCircle(aK+Math.round((aE-this.minx)*(aT/aO)),aL+Math.round(aS-aS*((this.maxyorg-this.miny)/aN)),aQ,undefined,aV.get("maxSpotColor")).append())),this.lastShapeId=aU.getLastShapeId(),this.canvasTop=aL,aU.render()}}),ar.fn.sparkline.bar=Q=ao(ar.fn.sparkline._base,U,{type:"bar",init:function(aW,aV,aU,aT,aS){var aR=parseInt(aU.get("barWidth"),10),aQ=parseInt(aU.get("barSpacing"),10),aP=aU.get("chartRangeMin"),aO=aU.get("chartRangeMax"),aN=aU.get("chartRangeClip"),aM=Infinity,aL=-Infinity,aK,aJ,aI,aH,aG,aF,aE,aD,aC,aB,aA,az,ay,ax,aw,av,au,at,v,q,j,i,h;Q._super.init.call(this,aW,aV,aU,aT,aS);for(aF=0,aE=aV.length;aF<aE;aF++){q=aV[aF],aK=typeof q=="string"&&q.indexOf(":")>-1;if(aK||ar.isArray(q)){aw=!0,aK&&(q=aV[aF]=aj(q.split(":"))),q=ai(q,null),aJ=Math.min.apply(Math,q),aI=Math.max.apply(Math,q),aJ<aM&&(aM=aJ),aI>aL&&(aL=aI)}}this.stacked=aw,this.regionShapes={},this.barWidth=aR,this.barSpacing=aQ,this.totalBarWidth=aR+aQ,this.width=aT=aV.length*aR+(aV.length-1)*aQ,this.initTarget(),aN&&(ay=aP===undefined?-Infinity:aP,ax=aO===undefined?Infinity:aO),aG=[],aH=aw?[]:aG;var f=[],a=[];for(aF=0,aE=aV.length;aF<aE;aF++){if(aw){av=aV[aF],aV[aF]=v=[],f[aF]=0,aH[aF]=a[aF]=0;for(au=0,at=av.length;au<at;au++){q=v[au]=aN?am(av[au],ay,ax):av[au],q!==null&&(q>0&&(f[aF]+=q),aM<0&&aL>0?q<0?a[aF]+=Math.abs(q):aH[aF]+=q:aH[aF]+=Math.abs(q-(q<0?aL:aM)),aG.push(q))}}else{q=aN?am(aV[aF],ay,ax):aV[aF],q=aV[aF]=ak(q),q!==null&&aG.push(q)}}this.max=az=Math.max.apply(Math,aG),this.min=aA=Math.min.apply(Math,aG),this.stackMax=aL=aw?Math.max.apply(Math,f):az,this.stackMin=aM=aw?Math.min.apply(Math,aG):aA,aU.get("chartRangeMin")!==undefined&&(aU.get("chartRangeClip")||aU.get("chartRangeMin")<aA)&&(aA=aU.get("chartRangeMin")),aU.get("chartRangeMax")!==undefined&&(aU.get("chartRangeClip")||aU.get("chartRangeMax")>az)&&(az=aU.get("chartRangeMax")),this.zeroAxis=aC=aU.get("zeroAxis",!0),aA<=0&&az>=0&&aC?aB=0:aC==0?aB=aA:aA>0?aB=aA:aB=az,this.xaxisOffset=aB,aD=aw?Math.max.apply(Math,aH)+Math.max.apply(Math,a):az-aA,this.canvasHeightEf=aC&&aA<0?this.canvasHeight-2:this.canvasHeight-1,aA<aB?(i=aw&&az>=0?aL:az,j=(i-aB)/aD*this.canvasHeight,j!==Math.ceil(j)&&(this.canvasHeightEf-=2,j=Math.ceil(j))):j=this.canvasHeight,this.yoffset=j,ar.isArray(aU.get("colorMap"))?(this.colorMapByIndex=aU.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=aU.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===undefined&&(this.colorMapByValue=new aa(this.colorMapByValue))),this.range=aD},getRegion:function(f,e,h){var g=Math.floor(e/this.totalBarWidth);return g<0||g>=this.values.length?undefined:g},getCurrentRegionFields:function(){var g=this.currentRegion,f=ad(this.values[g]),j=[],i,h;for(h=f.length;h--;){i=f[h],j.push({isNull:i===null,value:i,color:this.calcColor(h,i,g),offset:g})}return j},calcColor:function(a,p,o){var n=this.colorMapByIndex,m=this.colorMapByValue,l=this.options,k,j;return this.stacked?k=l.get("stackedBarColor"):k=p<0?l.get("negBarColor"):l.get("barColor"),p===0&&l.get("zeroColor")!==undefined&&(k=l.get("zeroColor")),m&&(j=m.get(p))?k=j:n&&n.length>o&&(k=n[o]),ar.isArray(k)?k[a%k.length]:k},renderRegion:function(aB,aA){var az=this.values[aB],ay=this.options,ax=this.xaxisOffset,aw=[],av=this.range,au=this.stacked,at=this.target,I=aB*this.totalBarWidth,H=this.canvasHeightEf,G=this.yoffset,F,E,D,C,B,A,z,y,l,a;az=ar.isArray(az)?az:[az],z=az.length,y=az[0],C=ag(null,az),a=ag(ax,az,!0);if(C){return ay.get("nullColor")?(D=aA?ay.get("nullColor"):this.calcHighlightColor(ay.get("nullColor"),ay),F=G>0?G-1:G,at.drawRect(I,F,this.barWidth-1,0,D,D)):undefined}B=G;for(A=0;A<z;A++){y=az[A];if(au&&y===ax){if(!a||l){continue}l=!0}av>0?E=Math.floor(H*(Math.abs(y-ax)/av))+1:E=1,y<ax||y===ax&&G===0?(F=B,B+=E):(F=G-E,G-=E),D=this.calcColor(A,y,aB),aA&&(D=this.calcHighlightColor(D,ay)),aw.push(at.drawRect(I,F,this.barWidth-1,E-1,D,D))}return aw.length===1?aw[0]:aw}}),ar.fn.sparkline.tristate=O=ao(ar.fn.sparkline._base,U,{type:"tristate",init:function(a,n,m,l,k){var j=parseInt(m.get("barWidth"),10),i=parseInt(m.get("barSpacing"),10);O._super.init.call(this,a,n,m,l,k),this.regionShapes={},this.barWidth=j,this.barSpacing=i,this.totalBarWidth=j+i,this.values=ar.map(n,Number),this.width=l=n.length*j+(n.length-1)*i,ar.isArray(m.get("colorMap"))?(this.colorMapByIndex=m.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=m.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===undefined&&(this.colorMapByValue=new aa(this.colorMapByValue))),this.initTarget()},getRegion:function(e,d,f){return Math.floor(d/this.totalBarWidth)},getCurrentRegionFields:function(){var b=this.currentRegion;return{isNull:this.values[b]===undefined,value:this.values[b],color:this.calcColor(this.values[b],b),offset:b}},calcColor:function(j,i){var p=this.values,o=this.options,n=this.colorMapByIndex,m=this.colorMapByValue,l,k;return m&&(k=m.get(j))?l=k:n&&n.length>i?l=n[i]:p[i]<0?l=o.get("negBarColor"):p[i]>0?l=o.get("posBarColor"):l=o.get("zeroBarColor"),l},renderRegion:function(v,u){var t=this.values,s=this.options,r=this.target,q,p,o,n,m,l;q=r.pixelHeight,o=Math.round(q/2),n=v*this.totalBarWidth,t[v]<0?(m=o,p=o-1):t[v]>0?(m=0,p=o-1):(m=o-1,p=2),l=this.calcColor(t[v],v);if(l===null){return}return u&&(l=this.calcHighlightColor(l,s)),r.drawRect(n,m,this.barWidth-1,p-1,l,l)}}),ar.fn.sparkline.discrete=M=ao(ar.fn.sparkline._base,U,{type:"discrete",init:function(a,j,i,h,g){M._super.init.call(this,a,j,i,h,g),this.regionShapes={},this.values=j=ar.map(j,Number),this.min=Math.min.apply(Math,j),this.max=Math.max.apply(Math,j),this.range=this.max-this.min,this.width=h=i.get("width")==="auto"?j.length*2:this.width,this.interval=Math.floor(h/j.length),this.itemWidth=h/j.length,i.get("chartRangeMin")!==undefined&&(i.get("chartRangeClip")||i.get("chartRangeMin")<this.min)&&(this.min=i.get("chartRangeMin")),i.get("chartRangeMax")!==undefined&&(i.get("chartRangeClip")||i.get("chartRangeMax")>this.max)&&(this.max=i.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight=i.get("lineHeight")==="auto"?Math.round(this.canvasHeight*0.3):i.get("lineHeight"))},getRegion:function(e,d,f){return Math.floor(d/this.itemWidth)},getCurrentRegionFields:function(){var b=this.currentRegion;return{isNull:this.values[b]===undefined,value:this.values[b],offset:b}},renderRegion:function(F,E){var D=this.values,C=this.options,B=this.min,A=this.max,z=this.range,y=this.interval,x=this.target,w=this.canvasHeight,v=this.lineHeight,u=w-v,t,s,r,f;return s=am(D[F],B,A),f=F*y,t=Math.round(u-u*((s-B)/z)),r=C.get("thresholdColor")&&s<C.get("thresholdValue")?C.get("thresholdColor"):C.get("lineColor"),E&&(r=this.calcHighlightColor(r,C)),x.drawLine(f,t,f,t+v,r)}}),ar.fn.sparkline.bullet=K=ao(ar.fn.sparkline._base,{type:"bullet",init:function(j,i,p,o,n){var m,l,k;K._super.init.call(this,j,i,p,o,n),this.values=i=aj(i),k=i.slice(),k[0]=k[0]===null?k[2]:k[0],k[1]=i[1]===null?k[2]:k[1],m=Math.min.apply(Math,i),l=Math.max.apply(Math,i),p.get("base")===undefined?m=m<0?m:0:m=p.get("base"),this.min=m,this.max=l,this.range=l-m,this.shapes={},this.valueShapes={},this.regiondata={},this.width=o=p.get("width")==="auto"?"4.0em":o,this.target=this.$el.simpledraw(o,n,p.get("composite")),i.length||(this.disabled=!0),this.initTarget()},getRegion:function(f,e,h){var g=this.target.getShapeAt(f,e,h);return g!==undefined&&this.shapes[g]!==undefined?this.shapes[g]:undefined},getCurrentRegionFields:function(){var b=this.currentRegion;return{fieldkey:b.substr(0,1),value:this.values[b.substr(1)],region:b}},changeHighlight:function(f){var e=this.currentRegion,h=this.valueShapes[e],g;delete this.shapes[h];switch(e.substr(0,1)){case"r":g=this.renderRange(e.substr(1),f);break;case"p":g=this.renderPerformance(f);break;case"t":g=this.renderTarget(f)}this.valueShapes[e]=g.id,this.shapes[g.id]=e,this.target.replaceWithShape(h,g)},renderRange:function(g,f){var j=this.values[g],i=Math.round(this.canvasWidth*((j-this.min)/this.range)),h=this.options.get("rangeColors")[g-2];return f&&(h=this.calcHighlightColor(h,this.options)),this.target.drawRect(0,0,i-1,this.canvasHeight-1,h,h)},renderPerformance:function(f){var e=this.values[1],h=Math.round(this.canvasWidth*((e-this.min)/this.range)),g=this.options.get("performanceColor");return f&&(g=this.calcHighlightColor(g,this.options)),this.target.drawRect(0,Math.round(this.canvasHeight*0.3),h-1,Math.round(this.canvasHeight*0.4)-1,g,g)},renderTarget:function(h){var g=this.values[0],l=Math.round(this.canvasWidth*((g-this.min)/this.range)-this.options.get("targetWidth")/2),k=Math.round(this.canvasHeight*0.1),j=this.canvasHeight-k*2,i=this.options.get("targetColor");return h&&(i=this.calcHighlightColor(i,this.options)),this.target.drawRect(l,k,this.options.get("targetWidth")-1,j-1,i,i)},render:function(){var f=this.values.length,e=this.target,h,g;if(!K._super.render.call(this)){return}for(h=2;h<f;h++){g=this.renderRange(h).append(),this.shapes[g.id]="r"+h,this.valueShapes["r"+h]=g.id}this.values[1]!==null&&(g=this.renderPerformance().append(),this.shapes[g.id]="p1",this.valueShapes.p1=g.id),this.values[0]!==null&&(g=this.renderTarget().append(),this.shapes[g.id]="t0",this.valueShapes.t0=g.id),e.render()}}),ar.fn.sparkline.pie=J=ao(ar.fn.sparkline._base,{type:"pie",init:function(a,n,m,l,k){var j=0,i;J._super.init.call(this,a,n,m,l,k),this.shapes={},this.valueShapes={},this.values=n=ar.map(n,Number),m.get("width")==="auto"&&(this.width=this.height);if(n.length>0){for(i=n.length;i--;){j+=n[i]}}this.total=j,this.initTarget(),this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(f,e,h){var g=this.target.getShapeAt(f,e,h);return g!==undefined&&this.shapes[g]!==undefined?this.shapes[g]:undefined},getCurrentRegionFields:function(){var b=this.currentRegion;return{isNull:this.values[b]===undefined,value:this.values[b],percent:this.values[b]/this.total*100,color:this.options.get("sliceColors")[b%this.options.get("sliceColors").length],offset:b}},changeHighlight:function(f){var e=this.currentRegion,h=this.renderSlice(e,f),g=this.valueShapes[e];delete this.shapes[g],this.target.replaceWithShape(g,h),this.valueShapes[e]=h.id,this.shapes[h.id]=e},renderSlice:function(F,E){var D=this.target,C=this.options,B=this.radius,A=C.get("borderWidth"),z=C.get("offset"),y=2*Math.PI,x=this.values,w=this.total,v=z?2*Math.PI*(z/360):0,u,t,s,r,q;r=x.length;for(s=0;s<r;s++){u=v,t=v,w>0&&(t=v+y*(x[s]/w));if(F===s){return q=C.get("sliceColors")[s%C.get("sliceColors").length],E&&(q=this.calcHighlightColor(q,C)),D.drawPieSlice(B,B,B-A,u,t,undefined,q)}v=t}},render:function(){var i=this.target,h=this.values,n=this.options,m=this.radius,l=n.get("borderWidth"),k,j;if(!J._super.render.call(this)){return}l&&i.drawCircle(m,m,Math.floor(m-l/2),n.get("borderColor"),undefined,l).append();for(j=h.length;j--;){h[j]&&(k=this.renderSlice(j).append(),this.valueShapes[j]=k.id,this.shapes[k.id]=j)}i.render()}}),ar.fn.sparkline.box=ab=ao(ar.fn.sparkline._base,{type:"box",init:function(a,j,i,h,g){ab._super.init.call(this,a,j,i,h,g),this.values=ar.map(j,Number),this.width=i.get("width")==="auto"?"4.0em":h,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var b=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==undefined&&b.push({field:"lo",value:this.loutlier}),this.routlier!==undefined&&b.push({field:"ro",value:this.routlier}),this.lwhisker!==undefined&&b.push({field:"lw",value:this.lwhisker}),this.rwhisker!==undefined&&b.push({field:"rw",value:this.rwhisker}),b},render:function(){var ax=this.target,aw=this.values,av=aw.length,au=this.options,at=this.canvasWidth,I=this.canvasHeight,H=au.get("chartRangeMin")===undefined?Math.min.apply(Math,aw):au.get("chartRangeMin"),G=au.get("chartRangeMax")===undefined?Math.max.apply(Math,aw):au.get("chartRangeMax"),F=0,E,D,C,B,A,z,y,x,w,v,g;if(!ab._super.render.call(this)){return}if(au.get("raw")){au.get("showOutliers")&&aw.length>5?(D=aw[0],E=aw[1],B=aw[2],A=aw[3],z=aw[4],y=aw[5],x=aw[6]):(E=aw[0],B=aw[1],A=aw[2],z=aw[3],y=aw[4])}else{aw.sort(function(d,c){return d-c}),B=al(aw,1),A=al(aw,2),z=al(aw,3),C=z-B;if(au.get("showOutliers")){E=y=undefined;for(w=0;w<av;w++){E===undefined&&aw[w]>B-C*au.get("outlierIQR")&&(E=aw[w]),aw[w]<z+C*au.get("outlierIQR")&&(y=aw[w])}D=aw[0],x=aw[av-1]}else{E=aw[0],y=aw[av-1]}}this.quartiles=[B,A,z],this.lwhisker=E,this.rwhisker=y,this.loutlier=D,this.routlier=x,g=at/(G-H+1),au.get("showOutliers")&&(F=Math.ceil(au.get("spotRadius")),at-=2*Math.ceil(au.get("spotRadius")),g=at/(G-H+1),D<E&&ax.drawCircle((D-H)*g+F,I/2,au.get("spotRadius"),au.get("outlierLineColor"),au.get("outlierFillColor")).append(),x>y&&ax.drawCircle((x-H)*g+F,I/2,au.get("spotRadius"),au.get("outlierLineColor"),au.get("outlierFillColor")).append()),ax.drawRect(Math.round((B-H)*g+F),Math.round(I*0.1),Math.round((z-B)*g),Math.round(I*0.8),au.get("boxLineColor"),au.get("boxFillColor")).append(),ax.drawLine(Math.round((E-H)*g+F),Math.round(I/2),Math.round((B-H)*g+F),Math.round(I/2),au.get("lineColor")).append(),ax.drawLine(Math.round((E-H)*g+F),Math.round(I/4),Math.round((E-H)*g+F),Math.round(I-I/4),au.get("whiskerColor")).append(),ax.drawLine(Math.round((y-H)*g+F),Math.round(I/2),Math.round((z-H)*g+F),Math.round(I/2),au.get("lineColor")).append(),ax.drawLine(Math.round((y-H)*g+F),Math.round(I/4),Math.round((y-H)*g+F),Math.round(I-I/4),au.get("whiskerColor")).append(),ax.drawLine(Math.round((A-H)*g+F),Math.round(I*0.1),Math.round((A-H)*g+F),Math.round(I*0.9),au.get("medianColor")).append(),au.get("target")&&(v=Math.ceil(au.get("spotRadius")),ax.drawLine(Math.round((au.get("target")-H)*g+F),Math.round(I/2-v),Math.round((au.get("target")-H)*g+F),Math.round(I/2+v),au.get("targetColor")).append(),ax.drawLine(Math.round((au.get("target")-H)*g+F-v),Math.round(I/2),Math.round((au.get("target")-H)*g+F+v),Math.round(I/2),au.get("targetColor")).append()),ax.render()}}),function(){document.namespaces&&!document.namespaces.v?(ar.fn.sparkline.hasVML=!0,document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML")):ar.fn.sparkline.hasVML=!1;var a=document.createElement("canvas");ar.fn.sparkline.hasCanvas=!!a.getContext&&!!a.getContext("2d")}(),V=ao({init:function(f,e,h,g){this.target=f,this.id=e,this.type=h,this.args=g},append:function(){return this.target.appendShape(this),this}}),T=ao({_pxregex:/(\d+)(px)?\s*$/i,init:function(a,f,e){if(!a){return}this.width=a,this.height=f,this.target=e,this.lastShapeId=null,e[0]&&(e=e[0]),ar.data(e,"_jqs_vcanvas",this)},drawLine:function(h,g,l,k,j,i){return this.drawShape([[h,g],[l,k]],j,i)},drawShape:function(f,e,h,g){return this._genShape("Shape",[f,e,h,g])},drawCircle:function(h,g,l,k,j,i){return this._genShape("Circle",[h,g,l,k,j,i])},drawPieSlice:function(i,h,n,m,l,k,j){return this._genShape("PieSlice",[i,h,n,m,l,k,j])},drawRect:function(h,g,l,k,j,i){return this._genShape("Rect",[h,g,l,k,j,i])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(a,d){ar(d).html(a)},_calculatePixelDims:function(a,h,g){var f;f=this._pxregex.exec(h),f?this.pixelHeight=f[1]:this.pixelHeight=ar(g).height(),f=this._pxregex.exec(a),f?this.pixelWidth=f[1]:this.pixelWidth=ar(g).width()},_genShape:function(e,d){var f=L++;return d.unshift(f),new V(this,f,e,d)},appendShape:function(b){alert("appendShape not implemented")},replaceWithShape:function(d,c){alert("replaceWithShape not implemented")},insertAfterShape:function(d,c){alert("insertAfterShape not implemented")},removeShapeId:function(b){alert("removeShapeId not implemented")},getShapeAt:function(e,d,f){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),R=ao(T,{init:function(a,h,g,f){R._super.init.call(this,a,h,g),this.canvas=document.createElement("canvas"),g[0]&&(g=g[0]),ar.data(g,"_jqs_vcanvas",this),ar(this.canvas).css({display:"inline-block",width:a,height:h,verticalAlign:"top"}),this._insert(this.canvas,g),this._calculatePixelDims(a,h,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=f,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=undefined,ar(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(f,e,h){var g=this.canvas.getContext("2d");return f!==undefined&&(g.strokeStyle=f),g.lineWidth=h===undefined?1:h,e!==undefined&&(g.fillStyle=e),g},reset:function(){var b=this._getContext();b.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=undefined},_drawShape:function(j,i,p,o,n){var m=this._getContext(p,o,n),l,k;m.beginPath(),m.moveTo(i[0][0]+0.5,i[0][1]+0.5);for(l=1,k=i.length;l<k;l++){m.lineTo(i[l][0]+0.5,i[l][1]+0.5)}p!==undefined&&m.stroke(),o!==undefined&&m.fill(),this.targetX!==undefined&&this.targetY!==undefined&&m.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=j)},_drawCircle:function(j,i,p,o,n,m,l){var k=this._getContext(n,m,l);k.beginPath(),k.arc(i,p,o,0,2*Math.PI,!1),this.targetX!==undefined&&this.targetY!==undefined&&k.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=j),n!==undefined&&k.stroke(),m!==undefined&&k.fill()},_drawPieSlice:function(r,q,p,o,n,m,l,k){var j=this._getContext(l,k);j.beginPath(),j.moveTo(q,p),j.arc(q,p,o,n,m,!1),j.lineTo(q,p),j.closePath(),l!==undefined&&j.stroke(),k&&j.fill(),this.targetX!==undefined&&this.targetY!==undefined&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=r)},_drawRect:function(i,h,n,m,l,k,j){return this._drawShape(i,[[h,n],[h+m,n],[h+m,n+l],[h,n+l],[h,n]],k,j)},appendShape:function(b){return this.shapes[b.id]=b,this.shapeseq.push(b.id),this.lastShapeId=b.id,b.id},replaceWithShape:function(f,e){var h=this.shapeseq,g;this.shapes[e.id]=e;for(g=h.length;g--;){h[g]==f&&(h[g]=e.id)}delete this.shapes[f]},replaceWithShapes:function(i,h){var n=this.shapeseq,m={},l,k,j;for(k=i.length;k--;){m[i[k]]=!0}for(k=n.length;k--;){l=n[k],m[l]&&(n.splice(k,1),delete this.shapes[l],j=k)}for(k=h.length;k--;){n.splice(j,0,h[k].id),this.shapes[h[k].id]=h[k]}},insertAfterShape:function(f,e){var h=this.shapeseq,g;for(g=h.length;g--;){if(h[g]===f){h.splice(g+1,0,e.id),this.shapes[e.id]=e;return}}},removeShapeId:function(e){var d=this.shapeseq,f;for(f=d.length;f--;){if(d[f]===e){d.splice(f,1);break}}delete this.shapes[e]},getShapeAt:function(e,d,f){return this.targetX=d,this.targetY=f,this.render(),this.currentTargetShapeId},render:function(){var i=this.shapeseq,h=this.shapes,n=i.length,m=this._getContext(),l,k,j;m.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(j=0;j<n;j++){l=i[j],k=h[l],this["_draw"+k.type].apply(this,k.args)}this.interact||(this.shapes={},this.shapeseq=[])}}),P=ao(T,{init:function(a,h,g){var f;P._super.init.call(this,a,h,g),g[0]&&(g=g[0]),ar.data(g,"_jqs_vcanvas",this),this.canvas=document.createElement("span"),ar(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:a,height:h,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,g),this._calculatePixelDims(a,h,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,f='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",f),this.group=ar(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(z,y,x,w,v){var u=[],t,s,r,q,p,o,n;for(n=0,o=y.length;n<o;n++){u[n]=""+y[n][0]+","+y[n][1]}return t=u.splice(0,1),v=v===undefined?1:v,s=x===undefined?' stroked="false" ':' strokeWeight="'+v+'px" strokeColor="'+x+'" ',r=w===undefined?' filled="false"':' fillColor="'+w+'" filled="true" ',q=u[0]===u[u.length-1]?"x ":"",p='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+z+'" '+s+r+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+t+" l "+u.join(", ")+" "+q+'e"> </v:shape>',p},_drawCircle:function(t,s,r,q,p,o,n){var m,l,k;return s-=q,r-=q,m=p===undefined?' stroked="false" ':' strokeWeight="'+n+'px" strokeColor="'+p+'" ',l=o===undefined?' filled="false"':' fillColor="'+o+'" filled="true" ',k='<v:oval  id="jqsshape'+t+'" '+m+l+' style="position:absolute;top:'+r+"px; left:"+s+"px; width:"+q*2+"px; height:"+q*2+'px"></v:oval>',k},_drawPieSlice:function(F,E,D,C,B,A,z,y){var x,w,v,u,t,s,r,q;if(B===A){return""}A-B===2*Math.PI&&(B=0,A=2*Math.PI),w=E+Math.round(Math.cos(B)*C),v=D+Math.round(Math.sin(B)*C),u=E+Math.round(Math.cos(A)*C),t=D+Math.round(Math.sin(A)*C);if(w===u&&v===t){if(A-B<Math.PI){return""}w=u=E+C,v=t=D}return w===u&&v===t&&A-B<Math.PI?"":(x=[E-C,D-C,E+C,D+C,w,v,u,t],s=z===undefined?' stroked="false" ':' strokeWeight="1px" strokeColor="'+z+'" ',r=y===undefined?' filled="false"':' fillColor="'+y+'" filled="true" ',q='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+F+'" '+s+r+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+E+","+D+" wa "+x.join(", ")+' x e"> </v:shape>',q)},_drawRect:function(i,h,n,m,l,k,j){return this._drawShape(i,[[h,n],[h,n+l],[h+m,n+l],[h+m,n],[h,n]],k,j)},reset:function(){this.group.innerHTML=""},appendShape:function(d){var c=this["_draw"+d.type].apply(this,d.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",c):this.prerender+=c,this.lastShapeId=d.id,d.id},replaceWithShape:function(a,h){var g=ar("#jqsshape"+a),f=this["_draw"+h.type].apply(this,h.args);g[0].outerHTML=f},replaceWithShapes:function(a,l){var k=ar("#jqsshape"+a[0]),j="",i=l.length,h;for(h=0;h<i;h++){j+=this["_draw"+l[h].type].apply(this,l[h].args)}k[0].outerHTML=j;for(h=1;h<a.length;h++){ar("#jqsshape"+a[h]).remove()}},insertAfterShape:function(a,h){var g=ar("#jqsshape"+a),f=this["_draw"+h.type].apply(this,h.args);g[0].insertAdjacentHTML("afterEnd",f)},removeShapeId:function(a){var d=ar("#jqsshape"+a);this.group.removeChild(d[0])},getShapeAt:function(f,e,h){var g=f.id.substr(8);return g},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})});